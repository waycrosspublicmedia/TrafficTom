"use strict";window.famobi_gameID=window.famobi_gameID||"",window.famobi_gameJS=window.famobi_gameJS||[];var detection=function(){var e,t={is:{}},n=navigator.userAgent;for(e in t.detect={html5:function(){return void 0!==document.createElement("canvas").getContext},touch:function(){return!!("ontouchstart"in window||navigator.msMaxTouchPoints)},android:function(){return!!n.match(/Android/i)},ios:function(){return!!n.match(/iPhone|iPad|iPod/i)},ios7:function(){return t.detect.ios&&n.match(/version\/7\./i)},bb10:function(){return!!n.match(/BB10/i)},windows:function(){return!!n.match(/Windows/i)},webkitVersion:function(){var e=new RegExp(/AppleWebKit\/([\d.]+)/).exec(n);return null!==e&&parseFloat(e[1])},androidStockBrowser:function(){return!!(t.is.android&&t.is.webkitVersion&&t.is.webkitVersion<537)},standalone:function(){return!!window.navigator.standalone},smartphone:function(){return!!n.match(/Android.*Mobile|iPhone|IEMobile|WPDesktop|BB10/i)},tablet:function(){var e=t.is.android&&!t.is.smartphone,o=!!n.match(/iPad/i);return e||o},pc:function(){return!t.is.smartphone&&!t.is.tablet},phantom:function(){return!(!window.callPhantom&&!n.match(/PhantomJS/))},iframe:function(){try{return window.self!==window.top}catch(e){return!0}}},t.detect)"function"==typeof t.detect[e]&&(t.is[e]=t.detect[e]());return t}();if(function(){function e(e){return"function"==typeof e}function t(){return function(){setTimeout(n,1)}}function n(){for(var e=0;_>e;e+=2){(0,L[e])(L[e+1]),L[e]=void 0,L[e+1]=void 0}_=0}function o(){}function i(e){try{return e.then}catch(e){return j.error=e,j}}function r(t,n,o){n.constructor===t.constructor&&o===O&&constructor.resolve===P?function(e,t){t._state===I?l(e,t._result):t._state===M?c(e,t._result):d(t,void 0,function(t){a(e,t)},function(t){c(e,t)})}(t,n):o===j?c(t,j.error):void 0===o?l(t,n):e(o)?function(e,t,n){C(function(e){var o=!1,i=function(e,t,n,o){try{e.call(t,n,o)}catch(e){return e}}(n,t,function(n){o||(o=!0,t!==n?a(e,n):l(e,n))},function(t){o||(o=!0,c(e,t))},e._label);!o&&i&&(o=!0,c(e,i))},e)}(t,n,o):l(t,n)}function a(e,t){e===t?c(e,new TypeError("You cannot resolve a promise with itself")):function(e){return"function"==typeof e||"object"==typeof e&&null!==e}(t)?r(e,t,i(t)):l(e,t)}function s(e){e._onerror&&e._onerror(e._result),u(e)}function l(e,t){e._state===N&&(e._result=t,e._state=I,0!==e._subscribers.length&&C(u,e))}function c(e,t){e._state===N&&(e._state=M,e._result=t,C(s,e))}function d(e,t,n,o){var i=e._subscribers,r=i.length;e._onerror=null,i[r]=t,i[r+I]=n,i[r+M]=o,0===r&&e._state&&C(u,e)}function u(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var o,i,r=e._result,a=0;a<t.length;a+=3)o=t[a],i=t[a+n],o?p(n,o,i,r):i(r);e._subscribers.length=0}}function f(){this.error=null}function p(t,n,o,i){var r,s,d,u,f=e(o);if(f){if(r=function(e,t){try{return e(t)}catch(e){return D.error=e,D}}(o,i),r===D?(u=!0,s=r.error,r=null):d=!0,n===r)return void c(n,new TypeError("A promises callback cannot return that same promise."))}else r=i,d=!0;n._state!==N||(f&&d?a(n,r):u?c(n,s):t===I?l(n,r):t===M&&c(n,r))}function h(e){e[R]=U++,e._state=void 0,e._result=void 0,e._subscribers=[]}function g(e){this[R]=U++,this._result=this._state=void 0,this._subscribers=[],o!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof g?function(e,t){try{t(function(t){a(e,t)},function(t){c(e,t)})}catch(t){c(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}function m(e,t){this._instanceConstructor=e,this.promise=new e(o),this.promise[R]||h(this.promise),E(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?l(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&l(this.promise,this._result))):c(this.promise,new Error("Array Methods must be provided an Array"))}var v;v=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var y,b,w,E=v,_=0,C=function(e,t){L[_]=e,L[_+1]=t,2===(_+=2)&&(b?b(n):w())},A="undefined"!=typeof window?window:void 0,S=A||{},k=S.MutationObserver||S.WebKitMutationObserver,T="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),x="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,L=new Array(1e3);w=T?function(){process.nextTick(n)}:k?function(){var e=0,t=new k(n),o=document.createTextNode("");return t.observe(o,{characterData:!0}),function(){o.data=e=++e%2}}():x?function(){var e=new MessageChannel;return e.port1.onmessage=n,function(){e.port2.postMessage(0)}}():void 0===A&&"function"==typeof require?function(){try{var e=require("vertx");return y=e.runOnLoop||e.runOnContext,function(){y(n)}}catch(e){return t()}}():t();var O=function(e,t){var n=this,i=new this.constructor(o);void 0===i[R]&&h(i);var r=n._state;if(r){var a=arguments[r-1];C(function(){p(r,i,a,n._result)})}else d(n,i,e,t);return i},P=function(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(o);return a(t,e),t},R=Math.random().toString(36).substring(16),N=void 0,I=1,M=2,j=new f,D=new f,U=0,B=function(e){return new V(this,e).promise},q=function(e){var t=this;return new t(E(e)?function(n,o){for(var i=e.length,r=0;i>r;r++)t.resolve(e[r]).then(n,o)}:function(e,t){t(new TypeError("You must pass an array to race."))})},F=function(e){var t=new this(o);return c(t,e),t},H=g;g.all=B,g.race=q,g.resolve=P,g.reject=F,g._setScheduler=function(e){b=e},g._setAsap=function(e){C=e},g._asap=C,g.prototype={constructor:g,then:O,catch:function(e){return this.then(null,e)}};var V=m;m.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===N&&e>n;n++)this._eachEntry(t[n],n)},m.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,a=n.resolve;if(a===P){var s=i(e);if(s===O&&e._state!==N)this._settledAt(e._state,t,e._result);else if("function"!=typeof s)this._remaining--,this._result[t]=e;else if(n===H){var l=new n(o);r(l,e,s),this._willSettleAt(l,t)}else this._willSettleAt(new n(function(t){t(e)}),t)}else this._willSettleAt(a(e),t)},m.prototype._settledAt=function(e,t,n){var o=this.promise;o._state===N&&(this._remaining--,e===M?c(o,n):this._result[t]=n),0===this._remaining&&l(o,this._result)},m.prototype._willSettleAt=function(e,t){var n=this;d(e,void 0,function(e){n._settledAt(I,t,e)},function(e){n._settledAt(M,t,e)})};var Z=function(){var e;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;(!t||"[object Promise]"!==Object.prototype.toString.call(t.resolve())||t.cast)&&(e.Promise=H)},W={Promise:H,polyfill:Z};"function"==typeof define&&define.amd?define(function(){return W}):"undefined"!=typeof module&&module.exports?module.exports=W:void 0!==this&&(this.ES6Promise=W),Z()}.call(this),function(e,t){"function"==typeof define&&define.amd?define(function(){return t(e)}):t(e)}(this,function(e){var t=function(){function t(e){return null==e?String(e):G[z.call(e)]||"object"}function n(e){return"function"==t(e)}function o(e){return null!=e&&e==e.window}function i(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function r(e){return"object"==t(e)}function a(e){return r(e)&&!o(e)&&Object.getPrototypeOf(e)==Object.prototype}function s(e){var t=!!e&&"length"in e&&e.length,n=C.type(e);return"function"!=n&&!o(e)&&("array"==n||0===t||"number"==typeof t&&t>0&&t-1 in e)}function l(e){return e.length>0?C.fn.concat.apply([],e):e}function c(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function d(e){return e in N?N[e]:N[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function u(e,t){return"number"!=typeof t||I[c(e)]?t:t+"px"}function f(e){return"children"in e?O.call(e.children):C.map(e.childNodes,function(e){return 1==e.nodeType?e:void 0})}function p(e,t){var n,o=e?e.length:0;for(n=0;o>n;n++)this[n]=e[n];this.length=o,this.selector=t||""}function h(e,t,n){for(_ in t)n&&(a(t[_])||Y(t[_]))?(a(t[_])&&!a(e[_])&&(e[_]={}),Y(t[_])&&!Y(e[_])&&(e[_]=[]),h(e[_],t[_],n)):t[_]!==E&&(e[_]=t[_])}function g(e,t){return null==t?C(e):C(e).filter(t)}function m(e,t,o,i){return n(t)?t.call(e,o,i):t}function v(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function y(e,t){var n=e.className||"",o=n&&n.baseVal!==E;return t===E?o?n.baseVal:n:void(o?n.baseVal=t:e.className=t)}function b(e){try{return e?"true"==e||"false"!=e&&("null"==e?null:+e+""==e?+e:/^[\[\{]/.test(e)?C.parseJSON(e):e):e}catch(t){return e}}function w(e,t){t(e);for(var n=0,o=e.childNodes.length;o>n;n++)w(e.childNodes[n],t)}var E,_,C,A,S,k,T=[],x=T.concat,L=T.filter,O=T.slice,P=e.document,R={},N={},I={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},M=/^\s*<(\w+|!)[^>]*>/,j=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,D=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,U=/^(?:body|html)$/i,B=/([A-Z])/g,q=["val","css","html","text","data","width","height","offset"],F=P.createElement("table"),H=P.createElement("tr"),V={tr:P.createElement("tbody"),tbody:F,thead:F,tfoot:F,td:H,th:H,"*":P.createElement("div")},Z=/complete|loaded|interactive/,W=/^[\w-]*$/,G={},z=G.toString,J={},X=P.createElement("div"),$={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},Y=Array.isArray||function(e){return e instanceof Array};return J.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var n=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(n)return n.call(e,t);var o,i=e.parentNode,r=!i;return r&&(i=X).appendChild(e),o=~J.qsa(i,t).indexOf(e),r&&X.removeChild(e),o},S=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},k=function(e){return L.call(e,function(t,n){return e.indexOf(t)==n})},J.fragment=function(e,t,n){var o,i,r;return j.test(e)&&(o=C(P.createElement(RegExp.$1))),o||(e.replace&&(e=e.replace(D,"<$1></$2>")),t===E&&(t=M.test(e)&&RegExp.$1),t in V||(t="*"),(r=V[t]).innerHTML=""+e,o=C.each(O.call(r.childNodes),function(){r.removeChild(this)})),a(n)&&(i=C(o),C.each(n,function(e,t){q.indexOf(e)>-1?i[e](t):i.attr(e,t)})),o},J.Z=function(e,t){return new p(e,t)},J.isZ=function(e){return e instanceof J.Z},J.init=function(e,t){var o;if(!e)return J.Z();if("string"==typeof e)if("<"==(e=e.trim())[0]&&M.test(e))o=J.fragment(e,RegExp.$1,t),e=null;else{if(t!==E)return C(t).find(e);o=J.qsa(P,e)}else{if(n(e))return C(P).ready(e);if(J.isZ(e))return e;if(Y(e))o=function(e){return L.call(e,function(e){return null!=e})}(e);else if(r(e))o=[e],e=null;else if(M.test(e))o=J.fragment(e.trim(),RegExp.$1,t),e=null;else{if(t!==E)return C(t).find(e);o=J.qsa(P,e)}}return J.Z(o,e)},C=function(e,t){return J.init(e,t)},C.extend=function(e){var t,n=O.call(arguments,1);return"boolean"==typeof e&&(t=e,e=n.shift()),n.forEach(function(n){h(e,n,t)}),e},J.qsa=function(e,t){var n,o="#"==t[0],i=!o&&"."==t[0],r=o||i?t.slice(1):t,a=W.test(r);return e.getElementById&&a&&o?(n=e.getElementById(r))?[n]:[]:1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType?[]:O.call(a&&!o&&e.getElementsByClassName?i?e.getElementsByClassName(r):e.getElementsByTagName(t):e.querySelectorAll(t))},C.contains=P.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t&&(t=t.parentNode);)if(t===e)return!0;return!1},C.type=t,C.isFunction=n,C.isWindow=o,C.isArray=Y,C.isPlainObject=a,C.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},C.isNumeric=function(e){var t=Number(e),n=typeof e;return null!=e&&"boolean"!=n&&("string"!=n||e.length)&&!isNaN(t)&&isFinite(t)||!1},C.inArray=function(e,t,n){return T.indexOf.call(t,e,n)},C.camelCase=S,C.trim=function(e){return null==e?"":String.prototype.trim.call(e)},C.uuid=0,C.support={},C.expr={},C.noop=function(){},C.map=function(e,t){var n,o,i,r=[];if(s(e))for(o=0;o<e.length;o++)null!=(n=t(e[o],o))&&r.push(n);else for(i in e)null!=(n=t(e[i],i))&&r.push(n);return l(r)},C.each=function(e,t){var n,o;if(s(e)){for(n=0;n<e.length;n++)if(!1===t.call(e[n],n,e[n]))return e}else for(o in e)if(!1===t.call(e[o],o,e[o]))return e;return e},C.grep=function(e,t){return L.call(e,t)},e.JSON&&(C.parseJSON=JSON.parse),C.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){G["[object "+t+"]"]=t.toLowerCase()}),C.fn={constructor:J.Z,length:0,forEach:T.forEach,reduce:T.reduce,push:T.push,sort:T.sort,splice:T.splice,indexOf:T.indexOf,concat:function(){var e,t,n=[];for(e=0;e<arguments.length;e++)t=arguments[e],n[e]=J.isZ(t)?t.toArray():t;return x.apply(J.isZ(this)?this.toArray():this,n)},map:function(e){return C(C.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return C(O.apply(this,arguments))},ready:function(e){return Z.test(P.readyState)&&P.body?e(C):P.addEventListener("DOMContentLoaded",function(){e(C)},!1),this},get:function(e){return e===E?O.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(e){return T.every.call(this,function(t,n){return!1!==e.call(t,n,t)}),this},filter:function(e){return n(e)?this.not(this.not(e)):C(L.call(this,function(t){return J.matches(t,e)}))},add:function(e,t){return C(k(this.concat(C(e,t))))},is:function(e){return this.length>0&&J.matches(this[0],e)},not:function(e){var t=[];if(n(e)&&e.call!==E)this.each(function(n){e.call(this,n)||t.push(this)});else{var o="string"==typeof e?this.filter(e):s(e)&&n(e.item)?O.call(e):C(e);this.forEach(function(e){o.indexOf(e)<0&&t.push(e)})}return C(t)},has:function(e){return this.filter(function(){return r(e)?C.contains(this,e):C(this).find(e).size()})},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!r(e)?e:C(e)},last:function(){var e=this[this.length-1];return e&&!r(e)?e:C(e)},find:function(e){var t=this;return e?"object"==typeof e?C(e).filter(function(){var e=this;return T.some.call(t,function(t){return C.contains(t,e)})}):1==this.length?C(J.qsa(this[0],e)):this.map(function(){return J.qsa(this,e)}):C()},closest:function(e,t){var n=[],o="object"==typeof e&&C(e);return this.each(function(r,a){for(;a&&!(o?o.indexOf(a)>=0:J.matches(a,e));)a=a!==t&&!i(a)&&a.parentNode;a&&n.indexOf(a)<0&&n.push(a)}),C(n)},parents:function(e){for(var t=[],n=this;n.length>0;)n=C.map(n,function(e){return(e=e.parentNode)&&!i(e)&&t.indexOf(e)<0?(t.push(e),e):void 0});return g(t,e)},parent:function(e){return g(k(this.pluck("parentNode")),e)},children:function(e){return g(this.map(function(){return f(this)}),e)},contents:function(){return this.map(function(){return this.contentDocument||O.call(this.childNodes)})},siblings:function(e){return g(this.map(function(e,t){return L.call(f(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return C.map(this,function(t){return t[e]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=function(e){var t,n;return R[e]||(t=P.createElement(e),P.body.appendChild(t),n=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==n&&(n="block"),R[e]=n),R[e]}(this.nodeName))})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var t=n(e);if(this[0]&&!t)var o=C(e).get(0),i=o.parentNode||this.length>1;return this.each(function(n){C(this).wrapAll(t?e.call(this,n):i?o.cloneNode(!0):o)})},wrapAll:function(e){if(this[0]){C(this[0]).before(e=C(e));for(var t;(t=e.children()).length;)e=t.first();C(e).append(this)}return this},wrapInner:function(e){var t=n(e);return this.each(function(n){var o=C(this),i=o.contents(),r=t?e.call(this,n):e;i.length?i.wrapAll(r):o.append(r)})},unwrap:function(){return this.parent().each(function(){C(this).replaceWith(C(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var t=C(this);(e===E?"none"==t.css("display"):e)?t.show():t.hide()})},prev:function(e){return C(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return C(this.pluck("nextElementSibling")).filter(e||"*")},html:function(e){return 0 in arguments?this.each(function(t){var n=this.innerHTML;C(this).empty().append(m(this,e,t,n))}):0 in this?this[0].innerHTML:null},text:function(e){return 0 in arguments?this.each(function(t){var n=m(this,e,t,this.textContent);this.textContent=null==n?"":""+n}):0 in this?this.pluck("textContent").join(""):null},attr:function(e,t){var n;return"string"!=typeof e||1 in arguments?this.each(function(n){if(1===this.nodeType)if(r(e))for(_ in e)v(this,_,e[_]);else v(this,e,m(this,t,n,this.getAttribute(e)))}):0 in this&&1==this[0].nodeType&&null!=(n=this[0].getAttribute(e))?n:E},removeAttr:function(e){return this.each(function(){1===this.nodeType&&e.split(" ").forEach(function(e){v(this,e)},this)})},prop:function(e,t){return e=$[e]||e,1 in arguments?this.each(function(n){this[e]=m(this,t,n,this[e])}):this[0]&&this[0][e]},removeProp:function(e){return e=$[e]||e,this.each(function(){delete this[e]})},data:function(e,t){var n="data-"+e.replace(B,"-$1").toLowerCase(),o=1 in arguments?this.attr(n,t):this.attr(n);return null!==o?b(o):E},val:function(e){return 0 in arguments?(null==e&&(e=""),this.each(function(t){this.value=m(this,e,t,this.value)})):this[0]&&(this[0].multiple?C(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(t){if(t)return this.each(function(e){var n=C(this),o=m(this,t,e,n.offset()),i=n.offsetParent().offset(),r={top:o.top-i.top,left:o.left-i.left};"static"==n.css("position")&&(r.position="relative"),n.css(r)});if(!this.length)return null;if(P.documentElement!==this[0]&&!C.contains(P.documentElement,this[0]))return{top:0,left:0};var n=this[0].getBoundingClientRect();return{left:n.left+e.pageXOffset,top:n.top+e.pageYOffset,width:Math.round(n.width),height:Math.round(n.height)}},css:function(e,n){if(arguments.length<2){var o=this[0];if("string"==typeof e){if(!o)return;return o.style[S(e)]||getComputedStyle(o,"").getPropertyValue(e)}if(Y(e)){if(!o)return;var i={},r=getComputedStyle(o,"");return C.each(e,function(e,t){i[t]=o.style[S(t)]||r.getPropertyValue(t)}),i}}var a="";if("string"==t(e))n||0===n?a=c(e)+":"+u(e,n):this.each(function(){this.style.removeProperty(c(e))});else for(_ in e)e[_]||0===e[_]?a+=c(_)+":"+u(_,e[_])+";":this.each(function(){this.style.removeProperty(c(_))});return this.each(function(){this.style.cssText+=";"+a})},index:function(e){return e?this.indexOf(C(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return!!e&&T.some.call(this,function(e){return this.test(y(e))},d(e))},addClass:function(e){return e?this.each(function(t){if("className"in this){A=[];var n=y(this);m(this,e,t,n).split(/\s+/g).forEach(function(e){C(this).hasClass(e)||A.push(e)},this),A.length&&y(this,n+(n?" ":"")+A.join(" "))}}):this},removeClass:function(e){return this.each(function(t){if("className"in this){if(e===E)return y(this,"");A=y(this),m(this,e,t,A).split(/\s+/g).forEach(function(e){A=A.replace(d(e)," ")}),y(this,A.trim())}})},toggleClass:function(e,t){return e?this.each(function(n){var o=C(this);m(this,e,n,y(this)).split(/\s+/g).forEach(function(e){(t===E?!o.hasClass(e):t)?o.addClass(e):o.removeClass(e)})}):this},scrollTop:function(e){if(this.length){var t="scrollTop"in this[0];return e===E?t?this[0].scrollTop:this[0].pageYOffset:this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var t="scrollLeft"in this[0];return e===E?t?this[0].scrollLeft:this[0].pageXOffset:this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),n=this.offset(),o=U.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(C(e).css("margin-top"))||0,n.left-=parseFloat(C(e).css("margin-left"))||0,o.top+=parseFloat(C(t[0]).css("border-top-width"))||0,o.left+=parseFloat(C(t[0]).css("border-left-width"))||0,{top:n.top-o.top,left:n.left-o.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||P.body;e&&!U.test(e.nodeName)&&"static"==C(e).css("position");)e=e.offsetParent;return e})}},C.fn.detach=C.fn.remove,["width","height"].forEach(function(e){var t=e.replace(/./,function(e){return e[0].toUpperCase()});C.fn[e]=function(n){var r,a=this[0];return n===E?o(a)?a["inner"+t]:i(a)?a.documentElement["scroll"+t]:(r=this.offset())&&r[e]:this.each(function(t){(a=C(this)).css(e,m(this,n,t,a[e]()))})}}),["after","prepend","before","append"].forEach(function(n,o){var i=o%2;C.fn[n]=function(){var n,r,a=C.map(arguments,function(e){var o=[];return"array"==(n=t(e))?(e.forEach(function(e){return e.nodeType!==E?o.push(e):C.zepto.isZ(e)?o=o.concat(e.get()):void(o=o.concat(J.fragment(e)))}),o):"object"==n||null==e?e:J.fragment(e)}),s=this.length>1;return a.length<1?this:this.each(function(t,n){r=i?n:n.parentNode,n=0==o?n.nextSibling:1==o?n.firstChild:2==o?n:null;var l=C.contains(P.documentElement,r);a.forEach(function(t){if(s)t=t.cloneNode(!0);else if(!r)return C(t).remove();r.insertBefore(t,n),l&&w(t,function(t){if(!(null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src)){var n=t.ownerDocument?t.ownerDocument.defaultView:e;n.eval.call(n,t.innerHTML)}})})})},C.fn[i?n+"To":"insert"+(o?"Before":"After")]=function(e){return C(e)[n](this),this}}),J.Z.prototype=p.prototype=C.fn,J.uniq=k,J.deserializeValue=b,C.zepto=J,C}();return e.Zepto=t,void 0===e.$&&(e.$=t),function(t){function n(e){return e._zid||(e._zid=f++)}function o(e,t,o,r){if((t=i(t)).ns)var a=function(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}(t.ns);return(m[n(e)]||[]).filter(function(e){return e&&(!t.e||e.e==t.e)&&(!t.ns||a.test(e.ns))&&(!o||n(e.fn)===n(o))&&(!r||e.sel==r)})}function i(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function r(e,t){return e.del&&!y&&e.e in b||!!t}function a(e){return w[e]||y&&b[e]||e}function s(e,o,s,l,d,f,p){var h=n(e),g=m[h]||(m[h]=[]);o.split(/\s/).forEach(function(n){if("ready"==n)return t(document).ready(s);var o=i(n);o.fn=s,o.sel=d,o.e in w&&(s=function(e){var n=e.relatedTarget;return!n||n!==this&&!t.contains(this,n)?o.fn.apply(this,arguments):void 0}),o.del=f;var h=f||s;o.proxy=function(t){if(!(t=c(t)).isImmediatePropagationStopped()){t.data=l;var n=h.apply(e,t._args==u?[t]:[t].concat(t._args));return!1===n&&(t.preventDefault(),t.stopPropagation()),n}},o.i=g.length,g.push(o),"addEventListener"in e&&e.addEventListener(a(o.e),o.proxy,r(o,p))})}function l(e,t,i,s,l){var c=n(e);(t||"").split(/\s/).forEach(function(t){o(e,t,i,s).forEach(function(t){delete m[c][t.i],"removeEventListener"in e&&e.removeEventListener(a(t.e),t.proxy,r(t,l))})})}function c(e,n){return(n||!e.isDefaultPrevented)&&(n||(n=e),t.each(A,function(t,o){var i=n[t];e[t]=function(){return this[o]=E,i&&i.apply(n,arguments)},e[o]=_}),e.timeStamp||(e.timeStamp=Date.now()),(n.defaultPrevented!==u?n.defaultPrevented:"returnValue"in n?!1===n.returnValue:n.getPreventDefault&&n.getPreventDefault())&&(e.isDefaultPrevented=E)),e}function d(e){var t,n={originalEvent:e};for(t in e)C.test(t)||e[t]===u||(n[t]=e[t]);return c(n,e)}var u,f=1,p=Array.prototype.slice,h=t.isFunction,g=function(e){return"string"==typeof e},m={},v={},y="onfocusin"in e,b={focus:"focusin",blur:"focusout"},w={mouseenter:"mouseover",mouseleave:"mouseout"};v.click=v.mousedown=v.mouseup=v.mousemove="MouseEvents",t.event={add:s,remove:l},t.proxy=function(e,o){var i=2 in arguments&&p.call(arguments,2);if(h(e)){var r=function(){return e.apply(o,i?i.concat(p.call(arguments)):arguments)};return r._zid=n(e),r}if(g(o))return i?(i.unshift(e[o],e),t.proxy.apply(null,i)):t.proxy(e[o],e);throw new TypeError("expected function")},t.fn.bind=function(e,t,n){return this.on(e,t,n)},t.fn.unbind=function(e,t){return this.off(e,t)},t.fn.one=function(e,t,n,o){return this.on(e,t,n,o,1)};var E=function(){return!0},_=function(){return!1},C=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,A={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(e,t,n){return this.on(t,e,n)},t.fn.undelegate=function(e,t,n){return this.off(t,e,n)},t.fn.live=function(e,n){return t(document.body).delegate(this.selector,e,n),this},t.fn.die=function(e,n){return t(document.body).undelegate(this.selector,e,n),this},t.fn.on=function(e,n,o,i,r){var a,c,f=this;return e&&!g(e)?(t.each(e,function(e,t){f.on(e,n,o,t,r)}),f):(g(n)||h(i)||!1===i||(i=o,o=n,n=u),(i===u||!1===o)&&(i=o,o=u),!1===i&&(i=_),f.each(function(u,f){r&&(a=function(e){return l(f,e.type,i),i.apply(this,arguments)}),n&&(c=function(e){var o,r=t(e.target).closest(n,f).get(0);return r&&r!==f?(o=t.extend(d(e),{currentTarget:r,liveFired:f}),(a||i).apply(r,[o].concat(p.call(arguments,1)))):void 0}),s(f,e,i,o,n,c||a)}))},t.fn.off=function(e,n,o){var i=this;return e&&!g(e)?(t.each(e,function(e,t){i.off(e,n,t)}),i):(g(n)||h(o)||!1===o||(o=n,n=u),!1===o&&(o=_),i.each(function(){l(this,e,o,n)}))},t.fn.trigger=function(e,n){return(e=g(e)||t.isPlainObject(e)?t.Event(e):c(e))._args=n,this.each(function(){e.type in b&&"function"==typeof this[e.type]?this[e.type]():"dispatchEvent"in this?this.dispatchEvent(e):t(this).triggerHandler(e,n)})},t.fn.triggerHandler=function(e,n){var i,r;return this.each(function(a,s){(i=d(g(e)?t.Event(e):e))._args=n,i.target=s,t.each(o(s,e.type||e),function(e,t){return r=t.proxy(i),!i.isImmediatePropagationStopped()&&void 0})}),r},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return 0 in arguments?this.bind(e,t):this.trigger(e)}}),t.Event=function(e,t){g(e)||(e=(t=e).type);var n=document.createEvent(v[e]||"Events"),o=!0;if(t)for(var i in t)"bubbles"==i?o=!!t[i]:n[i]=t[i];return n.initEvent(e,o,!0),c(n)}}(t),function(t){function n(e,n,o){var i=t.Event(n);return t(e).trigger(i,o),!i.isDefaultPrevented()}function o(e,t,o,i){return e.global?n(t||y,o,i):void 0}function i(e){e.global&&0===t.active++&&o(e,null,"ajaxStart")}function r(e){e.global&&! --t.active&&o(e,null,"ajaxStop")}function a(e,t){var n=t.context;return!1!==t.beforeSend.call(n,e,t)&&!1!==o(t,n,"ajaxBeforeSend",[e,t])&&void o(t,n,"ajaxSend",[e,t])}function s(e,t,n,i){var r=n.context,a="success";n.success.call(r,e,a,t),i&&i.resolveWith(r,[e,a,t]),o(n,r,"ajaxSuccess",[t,n,e]),c(a,t,n)}function l(e,t,n,i,r){var a=i.context;i.error.call(a,n,t,e),r&&r.rejectWith(a,[n,t,e]),o(i,a,"ajaxError",[n,i,e||t]),c(t,n,i)}function c(e,t,n){var i=n.context;n.complete.call(i,t,e),o(n,i,"ajaxComplete",[t,n]),r(n)}function d(){}function u(e){return e&&(e=e.split(";",2)[0]),e&&(e==C?"html":e==_?"json":w.test(e)?"script":E.test(e)&&"xml")||"text"}function f(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function p(e,n,o,i){return t.isFunction(n)&&(i=o,o=n,n=void 0),t.isFunction(o)||(i=o,o=void 0),{url:e,data:n,success:o,dataType:i}}function h(e,n,o,i){var r,a=t.isArray(n),s=t.isPlainObject(n);t.each(n,function(n,l){r=t.type(l),i&&(n=o?i:i+"["+(s||"object"==r||"array"==r?n:"")+"]"),!i&&a?e.add(l.name,l.value):"array"==r||!o&&"object"==r?h(e,l,o,n):e.add(n,l)})}var g,m,v=+new Date,y=e.document,b=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,w=/^(?:text|application)\/javascript/i,E=/^(?:text|application)\/xml/i,_="application/json",C="text/html",A=/^\s*$/,S=y.createElement("a");S.href=e.location.href,t.active=0,t.ajaxJSONP=function(n,o){if(!("type"in n))return t.ajax(n);var i,r,c=n.jsonpCallback,d=(t.isFunction(c)?c():c)||"Zepto"+v++,u=y.createElement("script"),f=e[d],p=function(e){t(u).triggerHandler("error",e||"abort")},h={abort:p};return o&&o.promise(h),t(u).on("load error",function(a,c){clearTimeout(r),t(u).off().remove(),"error"!=a.type&&i?s(i[0],h,n,o):l(null,c||"error",h,n,o),e[d]=f,i&&t.isFunction(f)&&f(i[0]),f=i=void 0}),!1===a(h,n)?(p("abort"),h):(e[d]=function(){i=arguments},u.src=n.url.replace(/\?(.+)=\?/,"?$1="+d),y.head.appendChild(u),n.timeout>0&&(r=setTimeout(function(){p("timeout")},n.timeout)),h)},t.ajaxSettings={type:"GET",beforeSend:d,success:d,error:d,complete:d,context:null,global:!0,xhr:function(){return new e.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:_,xml:"application/xml, text/xml",html:C,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0,dataFilter:d},t.ajax=function(n){var o,r,c=t.extend({},n||{}),p=t.Deferred&&t.Deferred();for(g in t.ajaxSettings)void 0===c[g]&&(c[g]=t.ajaxSettings[g]);i(c),c.crossDomain||((o=y.createElement("a")).href=c.url,o.href=o.href,c.crossDomain=S.protocol+"//"+S.host!=o.protocol+"//"+o.host),c.url||(c.url=e.location.toString()),(r=c.url.indexOf("#"))>-1&&(c.url=c.url.slice(0,r)),function(e){e.processData&&e.data&&"string"!=t.type(e.data)&&(e.data=t.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()&&"jsonp"!=e.dataType||(e.url=f(e.url,e.data),e.data=void 0)}(c);var h=c.dataType,v=/\?.+=\?/.test(c.url);if(v&&(h="jsonp"),!1!==c.cache&&(n&&!0===n.cache||"script"!=h&&"jsonp"!=h)||(c.url=f(c.url,"_="+Date.now())),"jsonp"==h)return v||(c.url=f(c.url,c.jsonp?c.jsonp+"=?":!1===c.jsonp?"":"callback=?")),t.ajaxJSONP(c,p);var b,w=c.accepts[h],E={},_=function(e,t){E[e.toLowerCase()]=[e,t]},C=/^([\w-]+:)\/\//.test(c.url)?RegExp.$1:e.location.protocol,k=c.xhr(),T=k.setRequestHeader;if(p&&p.promise(k),c.crossDomain||_("X-Requested-With","XMLHttpRequest"),_("Accept",w||"*/*"),(w=c.mimeType||w)&&(w.indexOf(",")>-1&&(w=w.split(",",2)[0]),k.overrideMimeType&&k.overrideMimeType(w)),(c.contentType||!1!==c.contentType&&c.data&&"GET"!=c.type.toUpperCase())&&_("Content-Type",c.contentType||"application/x-www-form-urlencoded"),c.headers)for(m in c.headers)_(m,c.headers[m]);if(k.setRequestHeader=_,k.onreadystatechange=function(){if(4==k.readyState){k.onreadystatechange=d,clearTimeout(b);var e,n=!1;if(k.status>=200&&k.status<300||304==k.status||0==k.status&&"file:"==C){if(h=h||u(c.mimeType||k.getResponseHeader("content-type")),"arraybuffer"==k.responseType||"blob"==k.responseType)e=k.response;else{e=k.responseText;try{e=function(e,t,n){if(n.dataFilter==d)return e;var o=n.context;return n.dataFilter.call(o,e,t)}(e,h,c),"script"==h?(0,eval)(e):"xml"==h?e=k.responseXML:"json"==h&&(e=A.test(e)?null:t.parseJSON(e))}catch(e){n=e}if(n)return l(n,"parsererror",k,c,p)}s(e,k,c,p)}else l(k.statusText||null,k.status?"error":"abort",k,c,p)}},!1===a(k,c))return k.abort(),l(null,"abort",k,c,p),k;var x=!("async"in c)||c.async;if(k.open(c.type,c.url,x,c.username,c.password),c.xhrFields)for(m in c.xhrFields)k[m]=c.xhrFields[m];for(m in E)T.apply(k,E[m]);return c.timeout>0&&(b=setTimeout(function(){k.onreadystatechange=d,k.abort(),l(null,"timeout",k,c,p)},c.timeout)),k.send(c.data?c.data:null),k},t.get=function(){return t.ajax(p.apply(null,arguments))},t.post=function(){var e=p.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=p.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,n,o){if(!this.length)return this;var i,r=this,a=e.split(/\s/),s=p(e,n,o),l=s.success;return a.length>1&&(s.url=a[0],i=a[1]),s.success=function(e){r.html(i?t("<div>").html(e.replace(b,"")).find(i):e),l&&l.apply(r,arguments)},t.ajax(s),this};var k=encodeURIComponent;t.param=function(e,n){var o=[];return o.add=function(e,n){t.isFunction(n)&&(n=n()),null==n&&(n=""),this.push(k(e)+"="+k(n))},h(o,e,n),o.join("&").replace(/%20/g,"+")}}(t),function(e){e.fn.serializeArray=function(){var t,n,o=[],i=function(e){return e.forEach?e.forEach(i):void o.push({name:t,value:e})};return this[0]&&e.each(this[0].elements,function(o,r){n=r.type,(t=r.name)&&"fieldset"!=r.nodeName.toLowerCase()&&!r.disabled&&"submit"!=n&&"reset"!=n&&"button"!=n&&"file"!=n&&("radio"!=n&&"checkbox"!=n||r.checked)&&i(e(r).val())}),o},e.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},e.fn.submit=function(t){if(0 in arguments)this.bind("submit",t);else if(this.length){var n=e.Event("submit");this.eq(0).trigger(n),n.isDefaultPrevented()||this.get(0).submit()}return this}}(t),function(){try{getComputedStyle(void 0)}catch(n){var t=getComputedStyle;e.getComputedStyle=function(e,n){try{return t(e,n)}catch(e){return null}}}}(),t}),Zepto.getScript=function(e,t,n){var o=document.createElement("script");o.async="async",o.src=e,t&&(o.onload=t),n&&(o.onerror=n),document.getElementsByTagName("head")[0].appendChild(o)},function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.SockJS=e()}}(function(){return function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[a]={exports:{}};t[a][0].call(d.exports,function(e){var n=t[a][1][e];return i(n||e)},d,d.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t){(function(n){var o=e("./transport-list");t.exports=e("./main")(o),"_sockjs_onload"in n&&setTimeout(n._sockjs_onload,1)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./main":14,"./transport-list":16}],2:[function(e,t){function n(){i.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}var o=e("inherits"),i=e("./event");o(n,i),t.exports=n},{"./event":4,inherits:54}],3:[function(e,t){function n(){i.call(this)}var o=e("inherits"),i=e("./eventtarget");o(n,i),n.prototype.removeAllListeners=function(e){e?delete this._listeners[e]:this._listeners={}},n.prototype.once=function(e,t){var n=this,o=!1;this.on(e,function i(){n.removeListener(e,i),o||(o=!0,t.apply(this,arguments))})},n.prototype.emit=function(e){var t=this._listeners[e];if(t)for(var n=Array.prototype.slice.call(arguments,1),o=0;o<t.length;o++)t[o].apply(this,n)},n.prototype.on=n.prototype.addListener=i.prototype.addEventListener,n.prototype.removeListener=i.prototype.removeEventListener,t.exports.EventEmitter=n},{"./eventtarget":5,inherits:54}],4:[function(e,t){function n(e){this.type=e}n.prototype.initEvent=function(e,t,n){return this.type=e,this.bubbles=t,this.cancelable=n,this.timeStamp=+new Date,this},n.prototype.stopPropagation=function(){},n.prototype.preventDefault=function(){},n.CAPTURING_PHASE=1,n.AT_TARGET=2,n.BUBBLING_PHASE=3,t.exports=n},{}],5:[function(e,t){function n(){this._listeners={}}n.prototype.addEventListener=function(e,t){e in this._listeners||(this._listeners[e]=[]);var n=this._listeners[e];-1===n.indexOf(t)&&(n=n.concat([t])),this._listeners[e]=n},n.prototype.removeEventListener=function(e,t){var n=this._listeners[e];if(n){var o=n.indexOf(t);return-1!==o?void(n.length>1?this._listeners[e]=n.slice(0,o).concat(n.slice(o+1)):delete this._listeners[e]):void 0}},n.prototype.dispatchEvent=function(e){var t=e.type,n=Array.prototype.slice.call(arguments,0);if(this["on"+t]&&this["on"+t].apply(this,n),t in this._listeners)for(var o=this._listeners[t],i=0;i<o.length;i++)o[i].apply(this,n)},t.exports=n},{}],6:[function(e,t){function n(e){i.call(this),this.initEvent("message",!1,!1),this.data=e}var o=e("inherits"),i=e("./event");o(n,i),t.exports=n},{"./event":4,inherits:54}],7:[function(e,t){function n(e){this._transport=e,e.on("message",this._transportMessage.bind(this)),e.on("close",this._transportClose.bind(this))}var o=e("json3"),i=e("./utils/iframe");n.prototype._transportClose=function(e,t){i.postMessage("c",o.stringify([e,t]))},n.prototype._transportMessage=function(e){i.postMessage("t",e)},n.prototype._send=function(e){this._transport.send(e)},n.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},t.exports=n},{"./utils/iframe":47,json3:55}],8:[function(e,t){var n=e("./utils/url"),o=e("./utils/event"),i=e("json3"),r=e("./facade"),a=e("./info-iframe-receiver"),s=e("./utils/iframe"),l=e("./location");t.exports=function(e,t){var c,d={};t.forEach(function(e){e.facadeTransport&&(d[e.facadeTransport.transportName]=e.facadeTransport)}),d[a.transportName]=a,e.bootstrap_iframe=function(){var t;s.currentWindowId=l.hash.slice(1);o.attachEvent("message",function(o){if(o.source===parent&&(void 0===c&&(c=o.origin),o.origin===c)){var a;try{a=i.parse(o.data)}catch(e){return}if(a.windowId===s.currentWindowId)switch(a.type){case"s":var u;try{u=i.parse(a.data)}catch(e){break}var f=u[0],p=u[1],h=u[2],g=u[3];if(f!==e.version)throw new Error('Incompatibile SockJS! Main site uses: "'+f+'", the iframe: "'+e.version+'".');if(!n.isOriginEqual(h,l.href)||!n.isOriginEqual(g,l.href))throw new Error("Can't connect to different domain from within an iframe. ("+l.href+", "+h+", "+g+")");t=new r(new d[p](h,g));break;case"m":t._send(a.data);break;case"c":t&&t._close(),t=null}}}),s.postMessage("s")}}},{"./facade":7,"./info-iframe-receiver":10,"./location":13,"./utils/event":46,"./utils/iframe":47,"./utils/url":52,debug:void 0,json3:55}],9:[function(e,t){function n(e,t){o.call(this);var n=this,i=+new Date;this.xo=new t("GET",e),this.xo.once("finish",function(e,t){var o,s;if(200===e){if(s=+new Date-i,t)try{o=r.parse(t)}catch(e){}a.isObject(o)||(o={})}n.emit("finish",o,s),n.removeAllListeners()})}var o=e("events").EventEmitter,i=e("inherits"),r=e("json3"),a=e("./utils/object");i(n,o),n.prototype.close=function(){this.removeAllListeners(),this.xo.close()},t.exports=n},{"./utils/object":49,debug:void 0,events:3,inherits:54,json3:55}],10:[function(e,t){function n(e){var t=this;i.call(this),this.ir=new s(e,a),this.ir.once("finish",function(e,n){t.ir=null,t.emit("message",r.stringify([e,n]))})}var o=e("inherits"),i=e("events").EventEmitter,r=e("json3"),a=e("./transport/sender/xhr-local"),s=e("./info-ajax");o(n,i),n.transportName="iframe-info-receiver",n.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},t.exports=n},{"./info-ajax":9,"./transport/sender/xhr-local":37,events:3,inherits:54,json3:55}],11:[function(e,t){(function(n){function o(e,t){var o=this;i.call(this);var r=function(){var n=o.ifr=new l(c.transportName,t,e);n.once("message",function(e){if(e){var t;try{t=a.parse(e)}catch(e){return o.emit("finish"),void o.close()}var n=t[0],i=t[1];o.emit("finish",n,i)}o.close()}),n.once("close",function(){o.emit("finish"),o.close()})};n.document.body?r():s.attachEvent("load",r)}var i=e("events").EventEmitter,r=e("inherits"),a=e("json3"),s=e("./utils/event"),l=e("./transport/iframe"),c=e("./info-iframe-receiver");r(o,i),o.enabled=function(){return l.enabled()},o.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./info-iframe-receiver":10,"./transport/iframe":22,"./utils/event":46,debug:void 0,events:3,inherits:54,json3:55}],12:[function(e,t){function n(e,t){var n=this;o.call(this),setTimeout(function(){n.doXhr(e,t)},0)}var o=e("events").EventEmitter,i=e("inherits"),r=e("./utils/url"),a=e("./transport/sender/xdr"),s=e("./transport/sender/xhr-cors"),l=e("./transport/sender/xhr-local"),c=e("./transport/sender/xhr-fake"),d=e("./info-iframe"),u=e("./info-ajax");i(n,o),n._getReceiver=function(e,t,n){return n.sameOrigin?new u(t,l):s.enabled?new u(t,s):a.enabled&&n.sameScheme?new u(t,a):d.enabled()?new d(e,t):new u(t,c)},n.prototype.doXhr=function(e,t){var o=this,i=r.addPath(e,"/info");this.xo=n._getReceiver(e,i,t),this.timeoutRef=setTimeout(function(){o._cleanup(!1),o.emit("finish")},n.timeout),this.xo.once("finish",function(e,t){o._cleanup(!0),o.emit("finish",e,t)})},n.prototype._cleanup=function(e){clearTimeout(this.timeoutRef),this.timeoutRef=null,!e&&this.xo&&this.xo.close(),this.xo=null},n.prototype.close=function(){this.removeAllListeners(),this._cleanup(!1)},n.timeout=8e3,t.exports=n},{"./info-ajax":9,"./info-iframe":11,"./transport/sender/xdr":34,"./transport/sender/xhr-cors":35,"./transport/sender/xhr-fake":36,"./transport/sender/xhr-local":37,"./utils/url":52,debug:void 0,events:3,inherits:54}],13:[function(e,t){(function(e){t.exports=e.location||{origin:"http://localhost:80",protocol:"http",host:"localhost",port:80,href:"http://localhost/",hash:""}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],14:[function(e,t){(function(n){function o(e,t,n){if(!(this instanceof o))return new o(e,t,n);if(arguments.length<1)throw new TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");y.call(this),this.readyState=o.CONNECTING,this.extensions="",this.protocol="",(n=n||{}).protocols_whitelist&&m.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=n.transports;var i=n.sessionId||8;if("function"==typeof i)this._generateSessionId=i;else{if("number"!=typeof i)throw new TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._generateSessionId=function(){return c.string(i)}}this._server=n.server||c.numberString(1e3);var r=new a(e);if(!r.host||!r.protocol)throw new SyntaxError("The URL '"+e+"' is invalid");if(r.hash)throw new SyntaxError("The URL must not contain a fragment");if("http:"!==r.protocol&&"https:"!==r.protocol)throw new SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+r.protocol+"' is not allowed.");var s="https:"===r.protocol;if("https"===b.protocol&&!s)throw new Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");t?Array.isArray(t)||(t=[t]):t=[];var l=t.sort();l.forEach(function(e,t){if(!e)throw new SyntaxError("The protocols entry '"+e+"' is invalid.");if(t<l.length-1&&e===l[t+1])throw new SyntaxError("The protocols entry '"+e+"' is duplicated.")});var d=u.getOrigin(b.href);this._origin=d?d.toLowerCase():null,r.set("pathname",r.pathname.replace(/\/+$/,"")),this.url=r.href,this._urlInfo={nullOrigin:!g.hasDomain(),sameOrigin:u.isOriginEqual(this.url,b.href),sameScheme:u.isSchemeEqual(this.url,b.href)},this._ir=new _(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}function i(e){return 1e3===e||e>=3e3&&4999>=e}e("./shims");var r,a=e("url-parse"),s=e("inherits"),l=e("json3"),c=e("./utils/random"),d=e("./utils/escape"),u=e("./utils/url"),f=e("./utils/event"),p=e("./utils/transport"),h=e("./utils/object"),g=e("./utils/browser"),m=e("./utils/log"),v=e("./event/event"),y=e("./event/eventtarget"),b=e("./location"),w=e("./event/close"),E=e("./event/trans-message"),_=e("./info-receiver");s(o,y),o.prototype.close=function(e,t){if(e&&!i(e))throw new Error("InvalidAccessError: Invalid code");if(t&&t.length>123)throw new SyntaxError("reason argument has an invalid length");if(this.readyState!==o.CLOSING&&this.readyState!==o.CLOSED){this._close(e||1e3,t||"Normal closure",!0)}},o.prototype.send=function(e){if("string"!=typeof e&&(e=""+e),this.readyState===o.CONNECTING)throw new Error("InvalidStateError: The connection has not been established yet");this.readyState===o.OPEN&&this._transport.send(d.quote(e))},o.version=e("./version"),o.CONNECTING=0,o.OPEN=1,o.CLOSING=2,o.CLOSED=3,o.prototype._receiveInfo=function(e,t){if(this._ir=null,e){this._rto=this.countRTO(t),this._transUrl=e.base_url?e.base_url:this.url,e=h.extend(e,this._urlInfo);var n=r.filterToEnabled(this._transportsWhitelist,e);this._transports=n.main,this._connect()}else this._close(1002,"Cannot connect to server")},o.prototype._connect=function(){for(var e=this._transports.shift();e;e=this._transports.shift()){if(e.needBody&&(!n.document.body||void 0!==n.document.readyState&&"complete"!==n.document.readyState&&"interactive"!==n.document.readyState))return this._transports.unshift(e),void f.attachEvent("load",this._connect.bind(this));var t=this._rto*e.roundTrips||5e3;this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),t);var o=new e(u.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),this._transUrl);return o.on("message",this._transportMessage.bind(this)),o.once("close",this._transportClose.bind(this)),o.transportName=e.transportName,void(this._transport=o)}this._close(2e3,"All transports failed",!1)},o.prototype._transportTimeout=function(){this.readyState===o.CONNECTING&&this._transportClose(2007,"Transport timed out")},o.prototype._transportMessage=function(e){var t,n=this,o=e.slice(0,1),i=e.slice(1);switch(o){case"o":return void this._open();case"h":return void this.dispatchEvent(new v("heartbeat"))}if(i)try{t=l.parse(i)}catch(e){}if(void 0!==t)switch(o){case"a":Array.isArray(t)&&t.forEach(function(e){n.dispatchEvent(new E(e))});break;case"m":this.dispatchEvent(new E(t));break;case"c":Array.isArray(t)&&2===t.length&&this._close(t[0],t[1],!0)}},o.prototype._transportClose=function(e,t){return this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),i(e)||2e3===e||this.readyState!==o.CONNECTING?void this._close(e,t):void this._connect()},o.prototype._open=function(){this.readyState===o.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=o.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new v("open"))):this._close(1006,"Server lost session")},o.prototype._close=function(e,t,n){var i=!1;if(this._ir&&(i=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===o.CLOSED)throw new Error("InvalidStateError: SockJS has already been closed");this.readyState=o.CLOSING,setTimeout(function(){this.readyState=o.CLOSED,i&&this.dispatchEvent(new v("error"));var r=new w("close");r.wasClean=n||!1,r.code=e||1e3,r.reason=t,this.dispatchEvent(r),this.onmessage=this.onclose=this.onerror=null}.bind(this),0)},o.prototype.countRTO=function(e){return e>100?4*e:300+e},t.exports=function(t){return r=p(t),e("./iframe-bootstrap")(o,t),o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./event/close":2,"./event/event":4,"./event/eventtarget":5,"./event/trans-message":6,"./iframe-bootstrap":8,"./info-receiver":12,"./location":13,"./shims":15,"./utils/browser":44,"./utils/escape":45,"./utils/event":46,"./utils/log":48,"./utils/object":49,"./utils/random":50,"./utils/transport":51,"./utils/url":52,"./version":53,debug:void 0,inherits:54,json3:55,"url-parse":56}],15:[function(){function e(){}var t,n=Array.prototype,o=Object.prototype,i=Function.prototype,r=String.prototype,a=n.slice,s=o.toString,l=function(e){return"[object Function]"===o.toString.call(e)},c=function(e){return"[object String]"===s.call(e)},d=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}();t=d?function(e,t,n,o){!o&&t in e||Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:n})}:function(e,t,n,o){!o&&t in e||(e[t]=n)};var u=function(e,n,i){for(var r in n)o.hasOwnProperty.call(n,r)&&t(e,r,n[r],i)},f=function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return Object(e)};u(i,{bind:function(t){var n=this;if(!l(n))throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var o=a.call(arguments,1),i=Math.max(0,n.length-o.length),r=[],s=0;i>s;s++)r.push("$"+s);var c=Function("binder","return function ("+r.join(",")+"){ return binder.apply(this, arguments); }")(function(){if(this instanceof c){var e=n.apply(this,o.concat(a.call(arguments)));return Object(e)===e?e:this}return n.apply(t,o.concat(a.call(arguments)))});return n.prototype&&(e.prototype=n.prototype,c.prototype=new e,e.prototype=null),c}}),u(Array,{isArray:function(e){return"[object Array]"===s.call(e)}});var p=Object("a"),h="a"!==p[0]||!(0 in p);u(n,{forEach:function(e){var t=f(this),n=h&&c(this)?this.split(""):t,o=arguments[1],i=-1,r=n.length>>>0;if(!l(e))throw new TypeError;for(;++i<r;)i in n&&e.call(o,n[i],i,t)}},!function(e){var t=!0,n=!0;return e&&(e.call("foo",function(e,n,o){"object"!=typeof o&&(t=!1)}),e.call([1],function(){n="string"==typeof this},"x")),!!e&&t&&n}(n.forEach));var g=Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2);u(n,{indexOf:function(e){var t=h&&c(this)?this.split(""):f(this),n=t.length>>>0;if(!n)return-1;var o=0;for(arguments.length>1&&(o=function(e){var t=+e;return t!=t?t=0:0!==t&&t!==1/0&&t!==-1/0&&(t=(t>0||-1)*Math.floor(Math.abs(t))),t}(arguments[1])),o=o>=0?o:Math.max(0,n+o);n>o;o++)if(o in t&&t[o]===e)return o;return-1}},g);var m=r.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?function(){var e=void 0===/()??/.exec("")[1];r.split=function(t,o){var i=this;if(void 0===t&&0===o)return[];if("[object RegExp]"!==s.call(t))return m.call(this,t,o);var r,a,l,c,d=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.extended?"x":"")+(t.sticky?"y":""),f=0;for(t=new RegExp(t.source,u+"g"),i+="",e||(r=new RegExp("^"+t.source+"$(?!\\s)",u)),o=void 0===o?-1>>>0:function(e){return e>>>0}(o);(a=t.exec(i))&&!((l=a.index+a[0].length)>f&&(d.push(i.slice(f,a.index)),!e&&a.length>1&&a[0].replace(r,function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(a[e]=void 0)}),a.length>1&&a.index<i.length&&n.push.apply(d,a.slice(1)),c=a[0].length,f=l,d.length>=o));)t.lastIndex===a.index&&t.lastIndex++;return f===i.length?(c||!t.test(""))&&d.push(""):d.push(i.slice(f)),d.length>o?d.slice(0,o):d}}():"0".split(void 0,0).length&&(r.split=function(e,t){return void 0===e&&0===t?[]:m.call(this,e,t)});var v="\t\n\v\f\r  \u2028\u2029\ufeff",y="["+v+"]",b=new RegExp("^"+y+y+"*"),w=new RegExp(y+y+"*$"),E=r.trim&&(v.trim()||!"".trim());u(r,{trim:function(){if(null==this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(b,"").replace(w,"")}},E);var _=r.substr,C="".substr&&"b"!=="0b".substr(-1);u(r,{substr:function(e,t){return _.call(this,0>e&&(e=this.length+e)<0?0:e,t)}},C)},{}],16:[function(e,t){t.exports=[e("./transport/websocket"),e("./transport/xhr-streaming"),e("./transport/xdr-streaming"),e("./transport/eventsource"),e("./transport/lib/iframe-wrap")(e("./transport/eventsource")),e("./transport/htmlfile"),e("./transport/lib/iframe-wrap")(e("./transport/htmlfile")),e("./transport/xhr-polling"),e("./transport/xdr-polling"),e("./transport/lib/iframe-wrap")(e("./transport/xhr-polling")),e("./transport/jsonp-polling")]},{"./transport/eventsource":20,"./transport/htmlfile":21,"./transport/jsonp-polling":23,"./transport/lib/iframe-wrap":26,"./transport/websocket":38,"./transport/xdr-polling":39,"./transport/xdr-streaming":40,"./transport/xhr-polling":41,"./transport/xhr-streaming":42}],17:[function(e,t){(function(n){function o(e,t,n,o){var r=this;i.call(this),setTimeout(function(){r._start(e,t,n,o)},0)}var i=e("events").EventEmitter,r=e("inherits"),a=e("../../utils/event"),s=e("../../utils/url"),l=n.XMLHttpRequest;r(o,i),o.prototype._start=function(e,t,n,i){var r=this;try{this.xhr=new l}catch(e){}if(!this.xhr)return this.emit("finish",0,"no xhr support"),void this._cleanup();t=s.addQuery(t,"t="+ +new Date),this.unloadRef=a.unloadAdd(function(){r._cleanup(!0)});try{this.xhr.open(e,t,!0),this.timeout&&"timeout"in this.xhr&&(this.xhr.timeout=this.timeout,this.xhr.ontimeout=function(){r.emit("finish",0,""),r._cleanup(!1)})}catch(e){return this.emit("finish",0,""),void this._cleanup(!1)}if(i&&i.noCredentials||!o.supportsCORS||(this.xhr.withCredentials="true"),i&&i.headers)for(var c in i.headers)this.xhr.setRequestHeader(c,i.headers[c]);this.xhr.onreadystatechange=function(){if(r.xhr){var e,t,n=r.xhr;switch(n.readyState){case 3:try{t=n.status,e=n.responseText}catch(e){}1223===t&&(t=204),200===t&&e&&e.length>0&&r.emit("chunk",t,e);break;case 4:1223===(t=n.status)&&(t=204),(12005===t||12029===t)&&(t=0),r.emit("finish",t,n.responseText),r._cleanup(!1)}}};try{r.xhr.send(n)}catch(e){r.emit("finish",0,""),r._cleanup(!1)}},o.prototype._cleanup=function(e){if(this.xhr){if(this.removeAllListeners(),a.unloadDel(this.unloadRef),this.xhr.onreadystatechange=function(){},this.xhr.ontimeout&&(this.xhr.ontimeout=null),e)try{this.xhr.abort()}catch(e){}this.unloadRef=this.xhr=null}},o.prototype.close=function(){this._cleanup(!0)},o.enabled=!!l;var c=["Active"].concat("Object").join("X");!o.enabled&&c in n&&(l=function(){try{return new n[c]("Microsoft.XMLHTTP")}catch(e){return null}},o.enabled=!!new l);var d=!1;try{d="withCredentials"in new l}catch(e){}o.supportsCORS=d,t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/event":46,"../../utils/url":52,debug:void 0,events:3,inherits:54}],18:[function(e,t){(function(e){t.exports=e.EventSource}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],19:[function(e,t){(function(e){t.exports=e.WebSocket||e.MozWebSocket}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(e,t){function n(e){if(!n.enabled())throw new Error("Transport created when disabled");i.call(this,e,"/eventsource",r,a)}var o=e("inherits"),i=e("./lib/ajax-based"),r=e("./receiver/eventsource"),a=e("./sender/xhr-cors"),s=e("eventsource");o(n,i),n.enabled=function(){return!!s},n.transportName="eventsource",n.roundTrips=2,t.exports=n},{"./lib/ajax-based":24,"./receiver/eventsource":29,"./sender/xhr-cors":35,eventsource:18,inherits:54}],21:[function(e,t){function n(e){if(!i.enabled)throw new Error("Transport created when disabled");a.call(this,e,"/htmlfile",i,r)}var o=e("inherits"),i=e("./receiver/htmlfile"),r=e("./sender/xhr-local"),a=e("./lib/ajax-based");o(n,a),n.enabled=function(e){return i.enabled&&e.sameOrigin},n.transportName="htmlfile",n.roundTrips=2,t.exports=n},{"./lib/ajax-based":24,"./receiver/htmlfile":30,"./sender/xhr-local":37,inherits:54}],22:[function(e,t){function n(e,t,o){if(!n.enabled())throw new Error("Transport created when disabled");r.call(this);var i=this;this.origin=s.getOrigin(o),this.baseUrl=o,this.transUrl=t,this.transport=e,this.windowId=d.string(8);var a=s.addPath(o,"/iframe.html")+"#"+this.windowId;this.iframeObj=l.createIframe(a,function(e){i.emit("close",1006,"Unable to load an iframe ("+e+")"),i.close()}),this.onmessageCallback=this._message.bind(this),c.attachEvent("message",this.onmessageCallback)}var o=e("inherits"),i=e("json3"),r=e("events").EventEmitter,a=e("../version"),s=e("../utils/url"),l=e("../utils/iframe"),c=e("../utils/event"),d=e("../utils/random");o(n,r),n.prototype.close=function(){if(this.removeAllListeners(),this.iframeObj){c.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch(e){}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},n.prototype._message=function(e){if(s.isOriginEqual(e.origin,this.origin)){var t;try{t=i.parse(e.data)}catch(e){return}if(t.windowId===this.windowId)switch(t.type){case"s":this.iframeObj.loaded(),this.postMessage("s",i.stringify([a,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",t.data);break;case"c":var n;try{n=i.parse(t.data)}catch(e){return}this.emit("close",n[0],n[1]),this.close()}}},n.prototype.postMessage=function(e,t){this.iframeObj.post(i.stringify({windowId:this.windowId,type:e,data:t||""}),this.origin)},n.prototype.send=function(e){this.postMessage("m",e)},n.enabled=function(){return l.iframeEnabled},n.transportName="iframe",n.roundTrips=2,t.exports=n},{"../utils/event":46,"../utils/iframe":47,"../utils/random":50,"../utils/url":52,"../version":53,debug:void 0,events:3,inherits:54,json3:55}],23:[function(e,t){(function(n){function o(e){if(!o.enabled())throw new Error("Transport created when disabled");r.call(this,e,"/jsonp",s,a)}var i=e("inherits"),r=e("./lib/sender-receiver"),a=e("./receiver/jsonp"),s=e("./sender/jsonp");i(o,r),o.enabled=function(){return!!n.document},o.transportName="jsonp-polling",o.roundTrips=1,o.needBody=!0,t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/sender-receiver":28,"./receiver/jsonp":31,"./sender/jsonp":33,inherits:54}],24:[function(e,t){function n(e,t,n,o){r.call(this,e,t,function(e){return function(t,n,o){var r={};"string"==typeof n&&(r.headers={"Content-type":"text/plain"});var a=i.addPath(t,"/xhr_send"),s=new e("POST",a,n,r);return s.once("finish",function(e){return s=null,200!==e&&204!==e?o(new Error("http status "+e)):void o()}),function(){s.close(),s=null;var e=new Error("Aborted");e.code=1e3,o(e)}}}(o),n,o)}var o=e("inherits"),i=e("../../utils/url"),r=e("./sender-receiver");o(n,r),t.exports=n},{"../../utils/url":52,"./sender-receiver":28,debug:void 0,inherits:54}],25:[function(e,t){function n(e,t){i.call(this),this.sendBuffer=[],this.sender=t,this.url=e}var o=e("inherits"),i=e("events").EventEmitter;o(n,i),n.prototype.send=function(e){this.sendBuffer.push(e),this.sendStop||this.sendSchedule()},n.prototype.sendScheduleWait=function(){var e,t=this;this.sendStop=function(){t.sendStop=null,clearTimeout(e)},e=setTimeout(function(){t.sendStop=null,t.sendSchedule()},25)},n.prototype.sendSchedule=function(){var e=this;if(this.sendBuffer.length>0){var t="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,t,function(t){e.sendStop=null,t?(e.emit("close",t.code||1006,"Sending error: "+t),e._cleanup()):e.sendScheduleWait()}),this.sendBuffer=[]}},n.prototype._cleanup=function(){this.removeAllListeners()},n.prototype.stop=function(){this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)},t.exports=n},{debug:void 0,events:3,inherits:54}],26:[function(e,t){(function(n){var o=e("inherits"),i=e("../iframe"),r=e("../../utils/object");t.exports=function(e){function t(t,n){i.call(this,e.transportName,t,n)}return o(t,i),t.enabled=function(t,o){if(!n.document)return!1;var a=r.extend({},o);return a.sameOrigin=!0,e.enabled(a)&&i.enabled()},t.transportName="iframe-"+e.transportName,t.needBody=!0,t.roundTrips=i.roundTrips+e.roundTrips-1,t.facadeTransport=e,t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/object":49,"../iframe":22,inherits:54}],27:[function(e,t){function n(e,t,n){i.call(this),this.Receiver=e,this.receiveUrl=t,this.AjaxObject=n,this._scheduleReceiver()}var o=e("inherits"),i=e("events").EventEmitter;o(n,i),n.prototype._scheduleReceiver=function(){var e=this,t=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);t.on("message",function(t){e.emit("message",t)}),t.once("close",function(n,o){e.poll=t=null,e.pollIsClosing||("network"===o?e._scheduleReceiver():(e.emit("close",n||1006,o),e.removeAllListeners()))})},n.prototype.abort=function(){this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},t.exports=n},{debug:void 0,events:3,inherits:54}],28:[function(e,t){function n(e,t,n,o,s){var l=i.addPath(e,t),c=this;r.call(this,e,n),this.poll=new a(o,l,s),this.poll.on("message",function(e){c.emit("message",e)}),this.poll.once("close",function(e,t){c.poll=null,c.emit("close",e,t),c.close()})}var o=e("inherits"),i=e("../../utils/url"),r=e("./buffered-sender"),a=e("./polling");o(n,r),n.prototype.close=function(){this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null),this.stop()},t.exports=n},{"../../utils/url":52,"./buffered-sender":25,"./polling":27,debug:void 0,inherits:54}],29:[function(e,t){function n(e){i.call(this);var t=this,n=this.es=new r(e);n.onmessage=function(e){t.emit("message",decodeURI(e.data))},n.onerror=function(e){var o=2!==n.readyState?"network":"permanent";t._cleanup(),t._close(o)}}var o=e("inherits"),i=e("events").EventEmitter,r=e("eventsource");o(n,i),n.prototype.abort=function(){this._cleanup(),this._close("user")},n.prototype._cleanup=function(){var e=this.es;e&&(e.onmessage=e.onerror=null,e.close(),this.es=null)},n.prototype._close=function(e){var t=this;setTimeout(function(){t.emit("close",null,e),t.removeAllListeners()},200)},t.exports=n},{debug:void 0,events:3,eventsource:18,inherits:54}],30:[function(e,t){(function(n){function o(e){s.call(this);var t=this;r.polluteGlobalNamespace(),this.id="a"+l.string(6),e=a.addQuery(e,"c="+decodeURIComponent(r.WPrefix+"."+this.id));var i=o.htmlfileEnabled?r.createHtmlfile:r.createIframe;n[r.WPrefix][this.id]={start:function(){t.iframeObj.loaded()},message:function(e){t.emit("message",e)},stop:function(){t._cleanup(),t._close("network")}},this.iframeObj=i(e,function(){t._cleanup(),t._close("permanent")})}var i=e("inherits"),r=e("../../utils/iframe"),a=e("../../utils/url"),s=e("events").EventEmitter,l=e("../../utils/random");i(o,s),o.prototype.abort=function(){this._cleanup(),this._close("user")},o.prototype._cleanup=function(){this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete n[r.WPrefix][this.id]},o.prototype._close=function(e){this.emit("close",null,e),this.removeAllListeners()},o.htmlfileEnabled=!1;var c=["Active"].concat("Object").join("X");if(c in n)try{o.htmlfileEnabled=!!new n[c]("htmlfile")}catch(e){}o.enabled=o.htmlfileEnabled||r.iframeEnabled,t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:void 0,events:3,inherits:54}],31:[function(e,t){(function(n){function o(e){var t=this;c.call(this),i.polluteGlobalNamespace(),this.id="a"+r.string(6);var a=s.addQuery(e,"c="+encodeURIComponent(i.WPrefix+"."+this.id));n[i.WPrefix][this.id]=this._callback.bind(this),this._createScript(a),this.timeoutId=setTimeout(function(){t._abort(new Error("JSONP script loaded abnormally (timeout)"))},o.timeout)}var i=e("../../utils/iframe"),r=e("../../utils/random"),a=e("../../utils/browser"),s=e("../../utils/url"),l=e("inherits"),c=e("events").EventEmitter;l(o,c),o.prototype.abort=function(){if(n[i.WPrefix][this.id]){var e=new Error("JSONP user aborted read");e.code=1e3,this._abort(e)}},o.timeout=35e3,o.scriptErrorTimeout=1e3,o.prototype._callback=function(e){this._cleanup(),this.aborting||(e&&this.emit("message",e),this.emit("close",null,"network"),this.removeAllListeners())},o.prototype._abort=function(e){this._cleanup(),this.aborting=!0,this.emit("close",e.code,e.message),this.removeAllListeners()},o.prototype._cleanup=function(){if(clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var e=this.script;e.parentNode.removeChild(e),e.onreadystatechange=e.onerror=e.onload=e.onclick=null,this.script=null}delete n[i.WPrefix][this.id]},o.prototype._scriptError=function(){var e=this;this.errorTimer||(this.errorTimer=setTimeout(function(){e.loadedOkay||e._abort(new Error("JSONP script loaded abnormally (onerror)"))},o.scriptErrorTimeout))},o.prototype._createScript=function(e){var t,o=this,i=this.script=n.document.createElement("script");if(i.id="a"+r.string(8),i.src=e,i.type="text/javascript",i.charset="UTF-8",i.onerror=this._scriptError.bind(this),i.onload=function(){o._abort(new Error("JSONP script loaded abnormally (onload)"))},i.onreadystatechange=function(){if(/loaded|closed/.test(i.readyState)){if(i&&i.htmlFor&&i.onclick){o.loadedOkay=!0;try{i.onclick()}catch(e){}}i&&o._abort(new Error("JSONP script loaded abnormally (onreadystatechange)"))}},void 0===i.async&&n.document.attachEvent)if(a.isOpera())(t=this.script2=n.document.createElement("script")).text="try{var a = document.getElementById('"+i.id+"'); if(a)a.onerror();}catch(x){};",i.async=t.async=!1;else{try{i.htmlFor=i.id,i.event="onclick"}catch(e){}i.async=!0}void 0!==i.async&&(i.async=!0);var s=n.document.getElementsByTagName("head")[0];s.insertBefore(i,s.firstChild),t&&s.insertBefore(t,s.firstChild)},t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/browser":44,"../../utils/iframe":47,"../../utils/random":50,"../../utils/url":52,debug:void 0,events:3,inherits:54}],32:[function(e,t){function n(e,t){i.call(this);var n=this;this.bufferPosition=0,this.xo=new t("POST",e,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(e,t){n._chunkHandler(e,t),n.xo=null;var o=200===e?"network":"permanent";n.emit("close",null,o),n._cleanup()})}var o=e("inherits"),i=e("events").EventEmitter;o(n,i),n.prototype._chunkHandler=function(e,t){if(200===e&&t)for(var n=-1;;this.bufferPosition+=n+1){var o=t.slice(this.bufferPosition);if(-1===(n=o.indexOf("\n")))break;var i=o.slice(0,n);i&&this.emit("message",i)}},n.prototype._cleanup=function(){this.removeAllListeners()},n.prototype.abort=function(){this.xo&&(this.xo.close(),this.emit("close",null,"user"),this.xo=null),this._cleanup()},t.exports=n},{debug:void 0,events:3,inherits:54}],33:[function(e,t){(function(n){function o(e){try{return n.document.createElement('<iframe name="'+e+'">')}catch(o){var t=n.document.createElement("iframe");return t.name=e,t}}function i(){(r=n.document.createElement("form")).style.display="none",r.style.position="absolute",r.method="POST",r.enctype="application/x-www-form-urlencoded",r.acceptCharset="UTF-8",(a=n.document.createElement("textarea")).name="d",r.appendChild(a),n.document.body.appendChild(r)}var r,a,s=e("../../utils/random"),l=e("../../utils/url");t.exports=function(e,t,n){r||i();var c="a"+s.string(8);r.target=c,r.action=l.addQuery(l.addPath(e,"/jsonp_send"),"i="+c);var d=o(c);d.id=c,d.style.display="none",r.appendChild(d);try{a.value=t}catch(e){}r.submit();var u=function(e){d.onerror&&(d.onreadystatechange=d.onerror=d.onload=null,setTimeout(function(){d.parentNode.removeChild(d),d=null},500),a.value="",n(e))};return d.onerror=function(){u()},d.onload=function(){u()},d.onreadystatechange=function(e){"complete"===d.readyState&&u()},function(){u(new Error("Aborted"))}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/random":50,"../../utils/url":52,debug:void 0}],34:[function(e,t){(function(n){function o(e,t,n){var o=this;i.call(this),setTimeout(function(){o._start(e,t,n)},0)}var i=e("events").EventEmitter,r=e("inherits"),a=e("../../utils/event"),s=e("../../utils/browser"),l=e("../../utils/url");r(o,i),o.prototype._start=function(e,t,o){var i=this,r=new n.XDomainRequest;t=l.addQuery(t,"t="+ +new Date),r.onerror=function(){i._error()},r.ontimeout=function(){i._error()},r.onprogress=function(){i.emit("chunk",200,r.responseText)},r.onload=function(){i.emit("finish",200,r.responseText),i._cleanup(!1)},this.xdr=r,this.unloadRef=a.unloadAdd(function(){i._cleanup(!0)});try{this.xdr.open(e,t),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(o)}catch(e){this._error()}},o.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},o.prototype._cleanup=function(e){if(this.xdr){if(this.removeAllListeners(),a.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,e)try{this.xdr.abort()}catch(e){}this.unloadRef=this.xdr=null}},o.prototype.close=function(){this._cleanup(!0)},o.enabled=!(!n.XDomainRequest||!s.hasDomain()),t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../utils/browser":44,"../../utils/event":46,"../../utils/url":52,debug:void 0,events:3,inherits:54}],35:[function(e,t){function n(e,t,n,o){i.call(this,e,t,n,o)}var o=e("inherits"),i=e("../driver/xhr");o(n,i),n.enabled=i.enabled&&i.supportsCORS,t.exports=n},{"../driver/xhr":17,inherits:54}],36:[function(e,t){function n(){var e=this;o.call(this),this.to=setTimeout(function(){e.emit("finish",200,"{}")},n.timeout)}var o=e("events").EventEmitter;e("inherits")(n,o),n.prototype.close=function(){clearTimeout(this.to)},n.timeout=2e3,t.exports=n},{events:3,inherits:54}],37:[function(e,t){function n(e,t,n){i.call(this,e,t,n,{noCredentials:!0})}var o=e("inherits"),i=e("../driver/xhr");o(n,i),n.enabled=i.enabled,t.exports=n},{"../driver/xhr":17,inherits:54}],38:[function(e,t){function n(e){if(!n.enabled())throw new Error("Transport created when disabled");a.call(this);var t=this,r=i.addPath(e,"/websocket");r="https"===r.slice(0,5)?"wss"+r.slice(5):"ws"+r.slice(4),this.url=r,this.ws=new s(this.url),this.ws.onmessage=function(e){t.emit("message",e.data)},this.unloadRef=o.unloadAdd(function(){t.ws.close()}),this.ws.onclose=function(e){t.emit("close",e.code,e.reason),t._cleanup()},this.ws.onerror=function(e){t.emit("close",1006,"WebSocket connection broken"),t._cleanup()}}var o=e("../utils/event"),i=e("../utils/url"),r=e("inherits"),a=e("events").EventEmitter,s=e("./driver/websocket");r(n,a),n.prototype.send=function(e){var t="["+e+"]";this.ws.send(t)},n.prototype.close=function(){this.ws&&this.ws.close(),this._cleanup()},n.prototype._cleanup=function(){var e=this.ws;e&&(e.onmessage=e.onclose=e.onerror=null),o.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},n.enabled=function(){return!!s},n.transportName="websocket",n.roundTrips=2,t.exports=n},{"../utils/event":46,"../utils/url":52,"./driver/websocket":19,debug:void 0,events:3,inherits:54}],39:[function(e,t){function n(e){if(!s.enabled)throw new Error("Transport created when disabled");i.call(this,e,"/xhr",a,s)}var o=e("inherits"),i=e("./lib/ajax-based"),r=e("./xdr-streaming"),a=e("./receiver/xhr"),s=e("./sender/xdr");o(n,i),n.enabled=r.enabled,n.transportName="xdr-polling",n.roundTrips=2,t.exports=n},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,"./xdr-streaming":40,inherits:54}],40:[function(e,t){function n(e){if(!a.enabled)throw new Error("Transport created when disabled");i.call(this,e,"/xhr_streaming",r,a)}var o=e("inherits"),i=e("./lib/ajax-based"),r=e("./receiver/xhr"),a=e("./sender/xdr");o(n,i),n.enabled=function(e){return!e.cookie_needed&&!e.nullOrigin&&(a.enabled&&e.sameScheme)},n.transportName="xdr-streaming",n.roundTrips=2,t.exports=n},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xdr":34,inherits:54}],41:[function(e,t){function n(e){if(!s.enabled&&!a.enabled)throw new Error("Transport created when disabled");i.call(this,e,"/xhr",r,a)}var o=e("inherits"),i=e("./lib/ajax-based"),r=e("./receiver/xhr"),a=e("./sender/xhr-cors"),s=e("./sender/xhr-local");o(n,i),n.enabled=function(e){return!e.nullOrigin&&(!(!s.enabled||!e.sameOrigin)||a.enabled)},n.transportName="xhr-polling",n.roundTrips=2,t.exports=n},{"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:54}],42:[function(e,t){(function(n){function o(e){if(!l.enabled&&!s.enabled)throw new Error("Transport created when disabled");r.call(this,e,"/xhr_streaming",a,s)}var i=e("inherits"),r=e("./lib/ajax-based"),a=e("./receiver/xhr"),s=e("./sender/xhr-cors"),l=e("./sender/xhr-local"),c=e("../utils/browser");i(o,r),o.enabled=function(e){return!e.nullOrigin&&(!c.isOpera()&&s.enabled)},o.transportName="xhr-streaming",o.roundTrips=2,o.needBody=!!n.document,t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../utils/browser":44,"./lib/ajax-based":24,"./receiver/xhr":32,"./sender/xhr-cors":35,"./sender/xhr-local":37,inherits:54}],43:[function(e,t){(function(e){t.exports.randomBytes=e.crypto&&e.crypto.getRandomValues?function(t){var n=new Uint8Array(t);return e.crypto.getRandomValues(n),n}:function(e){for(var t=new Array(e),n=0;e>n;n++)t[n]=Math.floor(256*Math.random());return t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],44:[function(e,t){(function(e){t.exports={isOpera:function(){return e.navigator&&/opera/i.test(e.navigator.userAgent)},isKonqueror:function(){return e.navigator&&/konqueror/i.test(e.navigator.userAgent)},hasDomain:function(){if(!e.document)return!0;try{return!!e.document.domain}catch(e){return!1}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],45:[function(e,t){var n,o=e("json3"),i=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g;t.exports={quote:function(e){var t=o.stringify(e);return i.lastIndex=0,i.test(t)?(n||(n=function(e){var t,n={},o=[];for(t=0;65536>t;t++)o.push(String.fromCharCode(t));return e.lastIndex=0,o.join("").replace(e,function(e){return n[e]="\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4),""}),e.lastIndex=0,n}(i)),t.replace(i,function(e){return n[e]})):t}}},{json3:55}],46:[function(e,t){(function(n){var o=e("./random"),i={},r=!1,a=n.chrome&&n.chrome.app&&n.chrome.app.runtime;t.exports={attachEvent:function(e,t){void 0!==n.addEventListener?n.addEventListener(e,t,!1):n.document&&n.attachEvent&&(n.document.attachEvent("on"+e,t),n.attachEvent("on"+e,t))},detachEvent:function(e,t){void 0!==n.addEventListener?n.removeEventListener(e,t,!1):n.document&&n.detachEvent&&(n.document.detachEvent("on"+e,t),n.detachEvent("on"+e,t))},unloadAdd:function(e){if(a)return null;var t=o.string(8);return i[t]=e,r&&setTimeout(this.triggerUnloadCallbacks,0),t},unloadDel:function(e){e in i&&delete i[e]},triggerUnloadCallbacks:function(){for(var e in i)i[e](),delete i[e]}};a||t.exports.attachEvent("unload",function(){r||(r=!0,t.exports.triggerUnloadCallbacks())})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./random":50}],47:[function(e,t){(function(n){var o=e("./event"),i=e("json3"),r=e("./browser");t.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){t.exports.WPrefix in n||(n[t.exports.WPrefix]={})},postMessage:function(e,o){n.parent!==n&&n.parent.postMessage(i.stringify({windowId:t.exports.currentWindowId,type:e,data:o||""}),"*")},createIframe:function(e,t){var i,r,a=n.document.createElement("iframe"),s=function(){clearTimeout(i);try{a.onload=null}catch(e){}a.onerror=null},l=function(){a&&(s(),setTimeout(function(){a&&a.parentNode.removeChild(a),a=null},0),o.unloadDel(r))},c=function(e){a&&(l(),t(e))};return a.src=e,a.style.display="none",a.style.position="absolute",a.onerror=function(){c("onerror")},a.onload=function(){clearTimeout(i),i=setTimeout(function(){c("onload timeout")},2e3)},n.document.body.appendChild(a),i=setTimeout(function(){c("timeout")},15e3),r=o.unloadAdd(l),{post:function(e,t){try{setTimeout(function(){a&&a.contentWindow&&a.contentWindow.postMessage(e,t)},0)}catch(e){}},cleanup:l,loaded:s}},createHtmlfile:function(e,i){var r,a,s,l=["Active"].concat("Object").join("X"),c=new n[l]("htmlfile"),d=function(){clearTimeout(r),s.onerror=null},u=function(){c&&(d(),o.unloadDel(a),s.parentNode.removeChild(s),s=c=null,CollectGarbage())},f=function(e){c&&(u(),i(e))};c.open(),c.write('<html><script>document.domain="'+n.document.domain+'";<\/script></html>'),c.close(),c.parentWindow[t.exports.WPrefix]=n[t.exports.WPrefix];var p=c.createElement("div");return c.body.appendChild(p),s=c.createElement("iframe"),p.appendChild(s),s.src=e,s.onerror=function(){f("onerror")},r=setTimeout(function(){f("timeout")},15e3),a=o.unloadAdd(u),{post:function(e,t){try{setTimeout(function(){s&&s.contentWindow&&s.contentWindow.postMessage(e,t)},0)}catch(e){}},cleanup:u,loaded:d}}},t.exports.iframeEnabled=!1,n.document&&(t.exports.iframeEnabled=("function"==typeof n.postMessage||"object"==typeof n.postMessage)&&!r.isKonqueror())}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./browser":44,"./event":46,debug:void 0,json3:55}],48:[function(e,t){(function(e){var n={};["log","debug","warn"].forEach(function(t){var o=e.console&&e.console[t]&&e.console[t].apply;n[t]=o?function(){return e.console[t].apply(e.console,arguments)}:"log"===t?function(){}:n.log}),t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],49:[function(e,t){t.exports={isObject:function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},extend:function(e){if(!this.isObject(e))return e;for(var t,n,o=1,i=arguments.length;i>o;o++)for(n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}}},{}],50:[function(e,t){var n=e("crypto"),o="abcdefghijklmnopqrstuvwxyz012345";t.exports={string:function(e){for(var t=n.randomBytes(e),i=[],r=0;e>r;r++)i.push(o.substr(t[r]%32,1));return i.join("")},number:function(e){return Math.floor(Math.random()*e)},numberString:function(e){var t=(""+(e-1)).length;return(new Array(t+1).join("0")+this.number(e)).slice(-t)}}},{crypto:43}],51:[function(e,t){t.exports=function(e){return{filterToEnabled:function(t,n){var o={main:[],facade:[]};return t?"string"==typeof t&&(t=[t]):t=[],e.forEach(function(e){e&&("websocket"!==e.transportName||!1!==n.websocket)&&(t.length&&-1===t.indexOf(e.transportName)||e.enabled(n)&&(o.main.push(e),e.facadeTransport&&o.facade.push(e.facadeTransport)))}),o}}}},{debug:void 0}],52:[function(e,t){var n=e("url-parse");t.exports={getOrigin:function(e){if(!e)return null;var t=new n(e);if("file:"===t.protocol)return null;var o=t.port;return o||(o="https:"===t.protocol?"443":"80"),t.protocol+"//"+t.hostname+":"+o},isOriginEqual:function(e,t){return this.getOrigin(e)===this.getOrigin(t)},isSchemeEqual:function(e,t){return e.split(":")[0]===t.split(":")[0]},addPath:function(e,t){var n=e.split("?");return n[0]+t+(n[1]?"?"+n[1]:"")},addQuery:function(e,t){return e+(-1===e.indexOf("?")?"?"+t:"&"+t)}}},{debug:void 0,"url-parse":56}],53:[function(e,t){t.exports="1.0.3"},{}],54:[function(e,t){t.exports="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],55:[function(e,t,n){(function(e){(function(){function o(e,t){function n(e){if(n[e]!==m)return n[e];var o;if("bug-string-char-index"==e)o="a"!="a"[0];else if("json"==e)o=n("json-stringify")&&n("json-parse");else{var i,a='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var l=t.stringify,d="function"==typeof l&&b;if(d){(i=function(){return 1}).toJSON=i;try{d="0"===l(0)&&"0"===l(new r)&&'""'==l(new s)&&l(y)===m&&l(m)===m&&l()===m&&"1"===l(i)&&"[1]"==l([i])&&"[null]"==l([m])&&"null"==l(null)&&"[null,null,null]"==l([m,y,null])&&l({a:[i,!0,!1,null,"\0\b\n\f\r\t"]})==a&&"1"===l(null,i)&&"[\n 1,\n 2\n]"==l([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==l(new c(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==l(new c(864e13))&&'"-000001-01-01T00:00:00.000Z"'==l(new c(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==l(new c(-1))}catch(e){d=!1}}o=d}if("json-parse"==e){var u=t.parse;if("function"==typeof u)try{if(0===u("0")&&!u(!1)){var f=5==(i=u(a)).a.length&&1===i.a[0];if(f){try{f=!u('"\t"')}catch(e){}if(f)try{f=1!==u("01")}catch(e){}if(f)try{f=1!==u("1.")}catch(e){}}}}catch(e){f=!1}o=f}}return n[e]=!!o}e||(e=a.Object()),t||(t=a.Object());var r=e.Number||a.Number,s=e.String||a.String,l=e.Object||a.Object,c=e.Date||a.Date,d=e.SyntaxError||a.SyntaxError,u=e.TypeError||a.TypeError,f=e.Math||a.Math,p=e.JSON||a.JSON;"object"==typeof p&&p&&(t.stringify=p.stringify,t.parse=p.parse);var h,g,m,v=l.prototype,y=v.toString,b=new c(-0xc782b5b800cec);try{b=-109252==b.getUTCFullYear()&&0===b.getUTCMonth()&&1===b.getUTCDate()&&10==b.getUTCHours()&&37==b.getUTCMinutes()&&6==b.getUTCSeconds()&&708==b.getUTCMilliseconds()}catch(e){}if(!n("json")){var w="[object Function]",E="[object Number]",_="[object String]",C="[object Array]",A=n("bug-string-char-index");if(!b)var S=f.floor,k=[0,31,59,90,120,151,181,212,243,273,304,334],T=function(e,t){return k[t]+365*(e-1970)+S((e-1969+(t=+(t>1)))/4)-S((e-1901+t)/100)+S((e-1601+t)/400)};if((h=v.hasOwnProperty)||(h=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=y?h=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,h=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,h.call(this,e)}),g=function(e,t){var n,o,r,a=0;for(r in(n=function(){this.valueOf=0}).prototype.valueOf=0,o=new n)h.call(o,r)&&a++;return n=o=null,a?g=2==a?function(e,t){var n,o={},i=y.call(e)==w;for(n in e)i&&"prototype"==n||h.call(o,n)||!(o[n]=1)||!h.call(e,n)||t(n)}:function(e,t){var n,o,i=y.call(e)==w;for(n in e)i&&"prototype"==n||!h.call(e,n)||(o="constructor"===n)||t(n);(o||h.call(e,n="constructor"))&&t(n)}:(o=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],g=function(e,t){var n,r,a=y.call(e)==w,s=!a&&"function"!=typeof e.constructor&&i[typeof e.hasOwnProperty]&&e.hasOwnProperty||h;for(n in e)a&&"prototype"==n||!s.call(e,n)||t(n);for(r=o.length;n=o[--r];s.call(e,n)&&t(n));}),g(e,t)},!n("json-stringify")){var x={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},L=function(e,t){return("000000"+(t||0)).slice(-e)},O=function(e){for(var t='"',n=0,o=e.length,i=!A||o>10,r=i&&(A?e.split(""):e);o>n;n++){var a=e.charCodeAt(n);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=x[a];break;default:if(32>a){t+="\\u00"+L(2,a.toString(16));break}t+=i?r[n]:e.charAt(n)}}return t+'"'},P=function(e,t,n,o,i,r,a){var s,l,c,d,f,p,v,b,w,A,k,x,R,N,I,M;try{s=t[e]}catch(e){}if("object"==typeof s&&s)if("[object Date]"!=(l=y.call(s))||h.call(s,"toJSON"))"function"==typeof s.toJSON&&(l!=E&&l!=_&&l!=C||h.call(s,"toJSON"))&&(s=s.toJSON(e));else if(s>-1/0&&1/0>s){if(T){for(f=S(s/864e5),c=S(f/365.2425)+1970-1;T(c+1,0)<=f;c++);for(d=S((f-T(c,0))/30.42);T(c,d+1)<=f;d++);f=1+f-T(c,d),v=S((p=(s%864e5+864e5)%864e5)/36e5)%24,b=S(p/6e4)%60,w=S(p/1e3)%60,A=p%1e3}else c=s.getUTCFullYear(),d=s.getUTCMonth(),f=s.getUTCDate(),v=s.getUTCHours(),b=s.getUTCMinutes(),w=s.getUTCSeconds(),A=s.getUTCMilliseconds();s=(0>=c||c>=1e4?(0>c?"-":"+")+L(6,0>c?-c:c):L(4,c))+"-"+L(2,d+1)+"-"+L(2,f)+"T"+L(2,v)+":"+L(2,b)+":"+L(2,w)+"."+L(3,A)+"Z"}else s=null;if(n&&(s=n.call(t,e,s)),null===s)return"null";if("[object Boolean]"==(l=y.call(s)))return""+s;if(l==E)return s>-1/0&&1/0>s?""+s:"null";if(l==_)return O(""+s);if("object"==typeof s){for(N=a.length;N--;)if(a[N]===s)throw u();if(a.push(s),k=[],I=r,r+=i,l==C){for(R=0,N=s.length;N>R;R++)x=P(R,s,n,o,i,r,a),k.push(x===m?"null":x);M=k.length?i?"[\n"+r+k.join(",\n"+r)+"\n"+I+"]":"["+k.join(",")+"]":"[]"}else g(o||s,function(e){var t=P(e,s,n,o,i,r,a);t!==m&&k.push(O(e)+":"+(i?" ":"")+t)}),M=k.length?i?"{\n"+r+k.join(",\n"+r)+"\n"+I+"}":"{"+k.join(",")+"}":"{}";return a.pop(),M}};t.stringify=function(e,t,n){var o,r,a,s;if(i[typeof t]&&t)if((s=y.call(t))==w)r=t;else if(s==C){a={};for(var l,c=0,d=t.length;d>c;l=t[c++],((s=y.call(l))==_||s==E)&&(a[l]=1));}if(n)if((s=y.call(n))==E){if((n-=n%1)>0)for(o="",n>10&&(n=10);o.length<n;o+=" ");}else s==_&&(o=n.length<=10?n:n.slice(0,10));return P("",((l={})[""]=e,l),r,a,o,"",[])}}if(!n("json-parse")){var R,N,I=s.fromCharCode,M={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},j=function(){throw R=N=null,d()},D=function(){for(var e,t,n,o,i,r=N,a=r.length;a>R;)switch(i=r.charCodeAt(R)){case 9:case 10:case 13:case 32:R++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=A?r.charAt(R):r[R],R++,e;case 34:for(e="@",R++;a>R;)if(32>(i=r.charCodeAt(R)))j();else if(92==i)switch(i=r.charCodeAt(++R)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=M[i],R++;break;case 117:for(t=++R,n=R+4;n>R;R++)(i=r.charCodeAt(R))>=48&&57>=i||i>=97&&102>=i||i>=65&&70>=i||j();e+=I("0x"+r.slice(t,R));break;default:j()}else{if(34==i)break;for(i=r.charCodeAt(R),t=R;i>=32&&92!=i&&34!=i;)i=r.charCodeAt(++R);e+=r.slice(t,R)}if(34==r.charCodeAt(R))return R++,e;j();default:if(t=R,45==i&&(o=!0,i=r.charCodeAt(++R)),i>=48&&57>=i){for(48==i&&((i=r.charCodeAt(R+1))>=48&&57>=i)&&j(),o=!1;a>R&&((i=r.charCodeAt(R))>=48&&57>=i);R++);if(46==r.charCodeAt(R)){for(n=++R;a>n&&((i=r.charCodeAt(n))>=48&&57>=i);n++);n==R&&j(),R=n}if(101==(i=r.charCodeAt(R))||69==i){for((43==(i=r.charCodeAt(++R))||45==i)&&R++,n=R;a>n&&((i=r.charCodeAt(n))>=48&&57>=i);n++);n==R&&j(),R=n}return+r.slice(t,R)}if(o&&j(),"true"==r.slice(R,R+4))return R+=4,!0;if("false"==r.slice(R,R+5))return R+=5,!1;if("null"==r.slice(R,R+4))return R+=4,null;j()}return"$"},U=function(e){var t,n;if("$"==e&&j(),"string"==typeof e){if("@"==(A?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];"]"!=(e=D());n||(n=!0))n&&(","==e?"]"==(e=D())&&j():j()),","==e&&j(),t.push(U(e));return t}if("{"==e){for(t={};"}"!=(e=D());n||(n=!0))n&&(","==e?"}"==(e=D())&&j():j()),(","==e||"string"!=typeof e||"@"!=(A?e.charAt(0):e[0])||":"!=D())&&j(),t[e.slice(1)]=U(D());return t}j()}return e},B=function(e,t,n){var o=q(e,t,n);o===m?delete e[t]:e[t]=o},q=function(e,t,n){var o,i=e[t];if("object"==typeof i&&i)if(y.call(i)==C)for(o=i.length;o--;)B(i,o,n);else g(i,function(e){B(i,e,n)});return n.call(e,t,i)};t.parse=function(e,t){var n,o;return R=0,N=""+e,n=U(D()),"$"!=D()&&j(),R=N=null,t&&y.call(t)==w?q(((o={})[""]=n,o),"",t):n}}}return t.runInContext=o,t}var i={function:!0,object:!0},r=i[typeof n]&&n&&!n.nodeType&&n,a=i[typeof window]&&window||this,s=r&&i[typeof t]&&t&&!t.nodeType&&"object"==typeof e&&e;if(!s||s.global!==s&&s.window!==s&&s.self!==s||(a=s),r)o(a,r);else{var l=a.JSON,c=a.JSON3,d=!1,u=o(a,a.JSON3={noConflict:function(){return d||(d=!0,a.JSON=l,a.JSON3=c,l=c=null),u}});a.JSON={parse:u.parse,stringify:u.stringify}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],56:[function(e,t){function n(e,t,l){if(!(this instanceof n))return new n(e,t,l);var c,d,u,f,p=a.test(e),h=typeof t,g=this,m=0;for("object"!==h&&"string"!==h&&(l=t,t=null),l&&"function"!=typeof l&&(l=r.parse),t=i(t);m<s.length;m++)c=(d=s[m])[0],f=d[1],c!=c?g[f]=e:"string"==typeof c?~(u=e.indexOf(c))&&("number"==typeof d[2]?(g[f]=e.slice(0,u),e=e.slice(u+d[2])):(g[f]=e.slice(u),e=e.slice(0,u))):(u=c.exec(e))&&(g[f]=u[1],e=e.slice(0,e.length-u[0].length)),g[f]=g[f]||(d[3]||"port"===f&&p)&&t[f]||"",d[4]&&(g[f]=g[f].toLowerCase());l&&(g.query=l(g.query)),o(g.port,g.protocol)||(g.host=g.hostname,g.port=""),g.username=g.password="",g.auth&&(d=g.auth.split(":"),g.username=d[0]||"",g.password=d[1]||""),g.href=g.toString()}var o=e("requires-port"),i=e("./lolcation"),r=e("querystringify"),a=/^\/(?!\/)/,s=[["#","hash"],["?","query"],["//","protocol",2,1,1],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/\:(\d+)$/,"port"],[NaN,"hostname",void 0,1,1]];n.prototype.set=function(e,t,n){var i=this;return"query"===e?("string"==typeof t&&(t=(n||r.parse)(t)),i[e]=t):"port"===e?(i[e]=t,o(t,i.protocol)?t&&(i.host=i.hostname+":"+t):(i.host=i.hostname,i[e]="")):"hostname"===e?(i[e]=t,i.port&&(t+=":"+i.port),i.host=t):"host"===e?(i[e]=t,/\:\d+/.test(t)&&(t=t.split(":"),i.hostname=t[0],i.port=t[1])):i[e]=t,i.href=i.toString(),i},n.prototype.toString=function(e){e&&"function"==typeof e||(e=r.stringify);var t,n=this,o=n.protocol+"//";return n.username&&(o+=n.username,n.password&&(o+=":"+n.password),o+="@"),o+=n.hostname,n.port&&(o+=":"+n.port),o+=n.pathname,n.query&&(o+=("?"===(t="object"==typeof n.query?e(n.query):n.query).charAt(0)?"":"?")+t),n.hash&&(o+=n.hash),o},n.qs=r,n.location=i,t.exports=n},{"./lolcation":57,querystringify:58,"requires-port":59}],57:[function(e,t){(function(n){var o,i={hash:1,query:1};t.exports=function(t){t=t||n.location||{},o=o||e("./");var r,a={},s=typeof t;if("blob:"===t.protocol)a=new o(unescape(t.pathname),{});else if("string"===s)for(r in a=new o(t,{}),i)delete a[r];else if("object"===s)for(r in t)r in i||(a[r]=t[r]);return a}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./":56}],58:[function(e,t,n){var o=Object.prototype.hasOwnProperty;n.stringify=function(e,t){t=t||"";var n=[];for(var i in"string"!=typeof t&&(t="?"),e)o.call(e,i)&&n.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return n.length?t+n.join("&"):""},n.parse=function(e){for(var t,n=/([^=?&]+)=([^&]*)/g,o={};t=n.exec(e);o[decodeURIComponent(t[1])]=decodeURIComponent(t[2]));return o}},{}],59:[function(e,t){t.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 22!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},{}]},{},[1])(1)}),function(e,t,n){var o=function(e,t){var o=this;this.el=e,this.options={},Object.keys(i).forEach(function(e){o.options[e]=i[e]}),Object.keys(t).forEach(function(e){o.options[e]=t[e]}),this.isInput="input"===this.el.tagName.toLowerCase(),this.attr=this.options.attr,this.showCursor=!this.isInput&&this.options.showCursor,this.elContent=this.attr?this.el.getAttribute(this.attr):this.el.textContent,this.contentType=this.options.contentType,this.typeSpeed=this.options.typeSpeed,this.startDelay=this.options.startDelay,this.backSpeed=this.options.backSpeed,this.backDelay=this.options.backDelay,this.fadeOut=this.options.fadeOut,this.fadeOutClass=this.options.fadeOutClass,this.fadeOutDelay=this.options.fadeOutDelay,n&&this.options.stringsElement instanceof n?this.stringsElement=this.options.stringsElement[0]:this.stringsElement=this.options.stringsElement,this.strings=this.options.strings,this.strPos=0,this.arrayPos=0,this.stopNum=0,this.loop=this.options.loop,this.loopCount=this.options.loopCount,this.curLoop=0,this.stop=!1,this.cursorChar=this.options.cursorChar,this.shuffle=this.options.shuffle,this.sequence=[],this.build()};o.prototype={constructor:o,init:function(){var e=this;e.timeout=setTimeout(function(){for(var t=0;t<e.strings.length;++t)e.sequence[t]=t;e.shuffle&&(e.sequence=e.shuffleArray(e.sequence)),e.typewrite(e.strings[e.sequence[e.arrayPos]],e.strPos)},e.startDelay)},build:function(){var e=this;(!0===this.showCursor&&(this.cursor=t.createElement("span"),this.cursor.className="typed-cursor",this.cursor.innerHTML=this.cursorChar,this.el.parentNode&&this.el.parentNode.insertBefore(this.cursor,this.el.nextSibling)),this.stringsElement)&&(this.strings=[],this.stringsElement.style.display="none",Array.prototype.slice.apply(this.stringsElement.children).forEach(function(t){e.strings.push(t.innerHTML)}));this.init()},typewrite:function(e,t){if(!0!==this.stop){this.fadeOut&&this.el.classList.contains(this.fadeOutClass)&&(this.el.classList.remove(this.fadeOutClass),this.cursor.classList.remove(this.fadeOutClass));var n=Math.round(70*Math.random())+this.typeSpeed,o=this;o.timeout=setTimeout(function(){var n=0,i=e.substr(t);if("^"===i.charAt(0)){var r=1;/^\^\d+/.test(i)&&(r+=(i=/\d+/.exec(i)[0]).length,n=parseInt(i)),e=e.substring(0,t)+e.substring(t+r)}if("html"===o.contentType){var a=e.substr(t).charAt(0);if("<"===a||"&"===a){var s;for(s="<"===a?">":";";e.substr(t+1).charAt(0)!==s&&(e.substr(t).charAt(0),!(++t+1>e.length)););t++}}o.timeout=setTimeout(function(){if(t===e.length){if(o.options.onStringTyped(o.arrayPos),o.arrayPos===o.strings.length-1&&(o.options.callback(),o.curLoop++,!1===o.loop||o.curLoop===o.loopCount))return;o.timeout=setTimeout(function(){o.backspace(e,t)},o.backDelay)}else{0===t&&o.options.preStringTyped(o.arrayPos);var n=e.substr(0,t+1);o.attr?o.el.setAttribute(o.attr,n):o.isInput?o.el.value=n:"html"===o.contentType?o.el.innerHTML=n:o.el.textContent=n,t++,o.typewrite(e,t)}},n)},n)}},backspace:function(e,t){var n=this;if(!0!==this.stop){if(this.fadeOut)return void this.initFadeOut();var o=Math.round(70*Math.random())+this.backSpeed;n.timeout=setTimeout(function(){if("html"===n.contentType&&">"===e.substr(t).charAt(0)){for(;"<"!==e.substr(t-1).charAt(0)&&(e.substr(t).charAt(0),!(--t<0)););t--}var o=e.substr(0,t);n.replaceText(o),t>n.stopNum?(t--,n.backspace(e,t)):t<=n.stopNum&&(n.arrayPos++,n.arrayPos===n.strings.length?(n.arrayPos=0,n.shuffle&&(n.sequence=n.shuffleArray(n.sequence)),n.init()):n.typewrite(n.strings[n.sequence[n.arrayPos]],t))},o)}},initFadeOut:function(){return self=this,this.el.className+=" "+this.fadeOutClass,this.cursor.className+=" "+this.fadeOutClass,setTimeout(function(){self.arrayPos++,self.replaceText(""),self.typewrite(self.strings[self.sequence[self.arrayPos]],0)},self.fadeOutDelay)},replaceText:function(e){this.attr?this.el.setAttribute(this.attr,e):this.isInput?this.el.value=e:"html"===this.contentType?this.el.innerHTML=e:this.el.textContent=e},shuffleArray:function(e){var t,n,o=e.length;if(o)for(;--o;)t=e[n=Math.floor(Math.random()*(o+1))],e[n]=e[o],e[o]=t;return e},reset:function(){clearInterval(this.timeout),this.el.getAttribute("id"),this.el.textContent="",void 0!==this.cursor&&void 0!==this.cursor.parentNode&&this.cursor.parentNode.removeChild(this.cursor),this.strPos=0,this.arrayPos=0,this.curLoop=0,this.options.resetCallback()}},o.new=function(e,n){Array.prototype.slice.apply(t.querySelectorAll(e)).forEach(function(e){var t=e._typed,i="object"==typeof n&&n;t&&t.reset(),e._typed=t=new o(e,i),"string"==typeof n&&t[n]()})},n&&(n.fn.typed=function(e){return this.each(function(){var t=n(this),i=t.data("typed"),r="object"==typeof e&&e;i&&i.reset(),t.data("typed",i=new o(this,r)),"string"==typeof e&&i[e]()})}),e.Typed=o;var i={strings:["These are the default values...","You know what you should do?","Use your own!","Have a great day!"],stringsElement:null,typeSpeed:0,startDelay:0,backSpeed:0,shuffle:!1,backDelay:500,fadeOut:!1,fadeOutClass:"typed-fade-out",fadeOutDelay:500,loop:!1,loopCount:!1,showCursor:!0,cursorChar:"|",attr:null,contentType:"html",callback:function(){},preStringTyped:function(){},onStringTyped:function(){},resetCallback:function(){}}}(window,document,window.jQuery),window.faZepto=Zepto,window.googletag={cmd:[]},detection.is.pc&&window.top!==window.self){var keydownFn=function(e){[32,37,38,39,40].indexOf(e.keyCode)>-1&&e.preventDefault()};window.removeEventListener("keydown",keydownFn,!1),window.addEventListener("keydown",keydownFn,!1)}function fg_api(e,t,n){e=e||{};var o=0,i=(t=t||[]).length,r=this;r.config=e,r.debug=!!n,r.log=function(){},r.error=function(){},r.debug&&window.console&&(Function.prototype.bind?(r.log=Function.prototype.bind.call(window.console.log,window.console),r.error=Function.prototype.bind.call(window.console.error,window.console)):(r.log=function(){Function.prototype.apply.call(window.console.log,window.console,arguments)},r.error=function(){Function.prototype.apply.call(window.console.error,window.console,arguments)})),faZepto(function(){for(r.init();o<i;)r.push(t[o++])})}fg_api.prototype.adsModule=function(){var e,t=this;function n(){this.closeCallback=function(){},this.adDidLoad=!1,this.adDidShow=!1,this.lastAdCall=+t.now(),this.defaultReturnValue={adType:"interstitial",adDidLoad:!1,adDidShow:!1,adCount:0}}return n.prototype.init=function(){switch(t.log("Famobi Ads Module Initializing"),t.config.ads=faZepto.extend({off:"vp"===window.famobi_env||"off"===t.config.gameParams.ad_type,show_initial:!1,show_video:!1},t.config.ads),e.isEnabled()?e.provider=t.config.ads.provider:e.provider="none",e.adcount=0,e.floodProtectionMap={},!1===t.config.gameParams.show_initial?(e.show_initial=!1,e.adcount=1):e.show_initial=t.config.ads.show_initial&&!t.config.ads.off,e.show_video=t.config.ads.show_video,e.provider){case"a4g":case"aerserv":case"redpm":case"dfp":t.game.setWaiting(e.show_initial),e.dfp_ad_unit_code="/37336410/InGameInterstitial//"+t.config.aid+"//d0",faZepto.getScript("js/null.js?https://imasdk.googleapis.com/js/sdkloader/ima3.js",n,function(){t.log("failed to load ima sdk"),n()});break;case"none":t.config.ads.off=!0;default:n()}function n(){"undefined"!=typeof google&&google.ima&&(google.ima.settings.setLocale(t.gametranslation.getNavigatorLanguage()),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setDisableFlashAds(!0));var n=function(){e.show_initial&&e.forceAd()},o=function(){n()};"dfp"===e.provider?t.lsg.ready().then(function(){o(t.lsg.getLocale())},function(){t.geo.getCountryCode().then(o,o)}):"sulvo"===e.provider?e.forceAd():n()}},n.prototype.getAdCount=function(){return+e.adcount},n.prototype.showClick2PlayOverlay=function(n,o){if(e.playBtnContainer)return!1;if(e.delayNextAdModal(o))return e.fireAdCallback(),!1;var i="",r=0==e.adcount;switch(window.famobi_gameID){case"embed-game":case"test-game":case"flash-game":break;default:i=t.config.name}e.playBtnContainer=t.createElement("div",{class:"fg-click2play"+(r?"":" fg-click2play-continue")+(detection.is.smartphone?" smartphone":""),style:"opacity: 0;transition: opacity 1s;"}),e.gameIcon=t.createElement("div",{class:"fg-gameicon",title:i}),e.branding=t.createElement("div",{class:"fg-branding"});var a=Promise.resolve();void 0!==t.config.thumb&&(a=new Promise(function(n,o){var i=document.createElement("img");i.onload=function(){e.gameIcon.innerHTML='<img src="'+t.config.thumb+'" alt>',n()},i.onerror=n,i.src=t.config.thumb}),r?(e.branding.style.background='#000 url("'+t.config.blurred_thumb+'") no-repeat center center',e.branding.style.backgroundSize="cover"):e.branding.style.background="#000"),e.playBtnStage=t.createElement("div",{class:"fg-click2play-stage"}),e.playBtn=t.createElement("div",{class:"btn-play",title:""}),e.playBtn.innerHTML='<div class="fg-click2play-loading"><span class="fg-click2play-loading-bounce1"></span><span class="fg-click2play-loading-bounce2"></span><span class="fg-click2play-loading-bounce3"></span></div>',e.privacyInfo=t.createElement("div",{class:"privacy-info"}),e.privacyInfo.innerHTML=t.translate("api.privacy_info")+t.translate("api.privacy_link"),e.stageHeader=t.createElement("div",{class:"fg-click2play-stage-header"}),e.gameDetails=t.createElement("div",{class:"fg-gameDetails"}),e.stageFooter=t.createElement("div",{class:"fg-click2play-stage-footer"}),e.playBtnContainer.appendChild(e.playBtnStage),e.playBtnStage.appendChild(e.stageHeader),e.playBtnStage.appendChild(e.gameDetails),e.gameDetails.appendChild(e.gameIcon),e.playBtnContainer.appendChild(e.branding),e.gameDetails.appendChild(e.playBtn),e.playBtnStage.appendChild(e.stageFooter),t.consent&&t.consent.isPlatformLoaded()||(e.stageFooter.appendChild(e.privacyInfo),t.adapters&&t.adapters.add("consent","platformLoaded",function(){e.stageFooter&&(faZepto(e.stageFooter).css({opacity:"0",transition:"opacity 1s"}),setTimeout(function(){e.stageFooter&&(e.stageFooter.style.visibility="hidden")},1e3))})),t.game.pause();var s=new Promise(function(e,t){"complete"!=document.readyState?document.addEventListener("readystatechange",function(){"complete"==document.readyState&&e()},!1):e()});function l(){faZepto(e.playBtn).addClass("loading"),r||t.spinner.show();try{e.show_initial&&t.fullscreen.start()}catch(e){t.log(e)}return e.showIMA(function(){try{t.orientation.lock()}catch(e){t.log(e)}e.fireAdCallback(),t.game.resume()},!0,!r),t.localStorage.setItem("privacy_policy_accepted","yes"),!1}r?Promise.race([t.wait(3e3),Promise.all([s,a])]).then(function(){return t.rootElement.appendChild(e.playBtnContainer),t.wait(33)}).then(function(){faZepto(e.playBtnContainer).css({opacity:"1"}),t.spinner.hide(),t.navigation.invisible(),t.handleClick(e.playBtn,l),faZepto(e.playBtn).css({cursor:"pointer"})}):t.wait(33).then(l)},n.prototype.showAd=function(n,o,i){if(t.adapters.run("ads","show",n,o))return!1;switch(e.closeCallback=n,e.provider){case"dfp":return i?e.showIMA(n,o):e.showClick2PlayOverlay(n,o);case"blocker":return e.showBlocker(n,o);default:return e.fireAdCallback()}},n.prototype.showInterstitialAd=function(n){return new Promise(function(o,i){n&&o(),t.adapters.run("ads","show",null,!0)&&i(),e.showAd(function(){o()})})},n.prototype.forceAd=function(n){return!t.adapters.run("ads","show",n,!0)&&e.showAd(n,!0)},n.prototype.showAlsoLikedApps=function(n,o){var i={force:!!o,iframeAllowed:!0,min_s_between:0,returnCallback:function(){},title:t.__("api.people_also_like_headline")};if(!e.isEnabled())return t.log("ads disabled"),e.fireAdCallback(),!1;if(e.delayNextAdModal(o))return e.fireAdCallback(),!1;var r=[{id:"famobi/fruita-crush",name:"Fruita Crush",thumb:"https://img.cdn.famobi.com/portal/html5games/images/tmp/180/FruitaCrushTeaser.jpg"},{id:"famobi/solitaire-classic",name:"Solitaire Classic",thumb:"https://img.cdn.famobi.com/portal/html5games/images/tmp/180/SolitaireClassicTeaser.jpg"},{id:"famobi/smarty-bubbles-xmas",name:"Smarty Bubbles X-MAS EDITION",thumb:"https://img.cdn.famobi.com/portal/html5games/images/tmp/180/SmartyBubblesXmasTeaser.jpg"},{id:"famobi/jewelish",name:"Jewelish",thumb:"https://img.cdn.famobi.com/portal/html5games/images/tmp/180/Jewelish_Teaser.jpg"},{id:"famobi/archery-world-tour",name:"Archery World Tour",thumb:"https://img.cdn.famobi.com/portal/html5games/images/tmp/180/ArcheryWorldTourTeaser.jpg"},{id:"famobi/penalty-shooters-2",name:"Penalty Shooters 2",thumb:"https://img.cdn.famobi.com/portal/html5games/images/tmp/180/PenaltyShooters2Teaser.jpg"},{id:"famobi/wedding-lily",name:"Wedding Lily",thumb:"https://img.cdn.famobi.com/portal/html5games/images/tmp/180/WeddingLilyTeaser.jpg"}];!function(e){(e=e||r).length||(e=r);var o=t.createElement("ul");e.slice(0,4).forEach(function(e){var n=t.createElement("li"),i=e.id.split("/")[1],r=t.createElement("a",{href:"javascript:;","data-xhref":"https://play.famobi.com/"+i+"/"+t.config.aid+"?original_ref="+encodeURIComponent(t.getShortLink()),title:e.name,target:"_blank"}),a=t.createElement("div",{class:"fg-notify-imgHolder"}),s=t.createElement("img",{src:e.thumb});a.appendChild(s),r.appendChild(a),n.appendChild(r),o.appendChild(n)}),t.notify.create(i),t.notify.setContent(o),t.notify.setCloseCallback(n)}(t.config.gameParams.related)},n.prototype.getPriceRuleName=function(){return e.priceRule&&e.priceRule.name?e.priceRule.name:""},n.prototype.setPriceRule=function(t,n){return"object"==typeof t&&(n=t.value,t=t.name),e.priceRule={name:""+t,value:+n}},n.prototype.showIMA=function(o,i,r){if(!e.initAdModal({returnCallback:function(){e.fireAdCallback()},force:i,iframeAllowed:t.config.ads.dfp_available}))return!1;t.modal.setCloseCallback(function(){e.adsManager&&e.adsManager.destroy()}),e.adContainerElement=document.createElement("div"),e.adContainerElement.className="fg-ad-container",e.adContainerElement.style.zIndex="9999990",e.adContainerElement.style.margin="0 auto 0",e.adContainerElement.setAttribute("playsinline","true"),t.rootElement.appendChild(e.adContainerElement),e.adWidth=parseInt(window.innerWidth,10),e.adHeight=parseInt(window.innerHeight,10),e.adContainerElement.setAttribute("width",e.adWidth),e.adContainerElement.setAttribute("height",e.adHeight),e.adContainerElement.style.width=e.adWidth+"px",e.adContainerElement.style.height=e.adHeight+"px";try{e.showAdModal({overlayStyle:{background:"transparent"},returnCallback:o,width:e.adWidth,height:e.adHeight},e.adContainerElement),e.adDisplayContainer=new google.ima.AdDisplayContainer(e.adContainerElement),e.adsLoader=new google.ima.AdsLoader(e.adDisplayContainer),e.adsLoader.getSettings().setDisableFlashAds(!0),e.adsLoader.getSettings().setDisableCustomPlaybackForIOS10Plus(!0),e.adDisplayContainer.initialize()}catch(n){return t.debug&&t.log(n),faZepto(e.playBtnContainer).remove(),t.modal.close(),t.game.isWaiting()&&(t.game.setWaiting(!1),t.game.init()),e.showAlsoLikedApps(o)}r&&t.spinner.show(),n.prototype.onAdsManagerLoaded=function(t){var n=new google.ima.AdsRenderingSettings;n.enablePreloading=!0,n.loadVideoTimeout=15e3,e.adsManager=t.getAdsManager(e.adContainerElement,n),faZepto.each(["LOADED","IMPRESSION","STARTED","SKIPPABLE_STATE_CHANGED","FIRST_QUARTILE","MIDPOINT","THIRD_QUARTILE","USER_CLOSE","SKIPPED","COMPLETE","ALL_ADS_COMPLETED","DURATION_CHANGE","CONTENT_RESUME_REQUESTED","CONTENT_PAUSE_REQUESTED","LOG"],function(t,n){e.adsManager.addEventListener(google.ima.AdEvent.Type[n],e.onAdEvent)}),e.adsManager.init(e.adWidth,e.adHeight,google.ima.ViewMode.NORMAL),e.adsManager.start()},n.prototype.onAdEvent=function(n){var o=n.getAd();switch(t.log(n),n.type){case google.ima.AdEvent.Type.LOADED:e.adDidLoad=!0,e.adcount++,t.adapters.run("adEvent","loaded",o),o.isLinear()&&e.adsManager.getRemainingTime()>0&&t.modal.setCloseBtnTimer(15),faZepto(t.modal.overlay).css("background","#000");break;case google.ima.AdEvent.Type.IMPRESSION:e.adDidShow=!0;break;case google.ima.AdEvent.Type.STARTED:e.adDidLoad=!0,o.isLinear()&&e.adsManager.getRemainingTime(),r&&t.spinner.hide(),t.modal.clearCloseBtnTimer(),t.modal.activateCloseBtn(!1);break;case google.ima.AdEvent.Type.DURATION_CHANGE:e.delayNextAdModal(!0);break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:faZepto(e.playBtnContainer).remove(),e.playBtnContainer=void 0;break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:faZepto(t.modal.overlay).css("background","transparent"),r&&t.spinner.hide(),t.modal.close()}switch(n.type){case google.ima.AdEvent.Type.STARTED:t.adapters.run("adEvent","displayed");break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:t.adapters.run("adEvent","completed",e.adcount);break;case google.ima.AdEvent.Type.SKIPPED:t.adapters.run("adEvent","skipped");break;case google.ima.AdEvent.Type.USER_CLOSE:t.adapters.run("adEvent","userClosed",e.adcount)}},n.prototype.onAdError=function(n){t.log(n.getError()),t.modal.close(),r&&t.spinner.hide(),t.adapters.run("adEvent","errored",n),e.adsManager&&e.adsManager.destroy()},e.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,e.onAdsManagerLoaded,!1),e.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,e.onAdError,!1);var a=new google.ima.AdsRequest;a.disableCompanionAds=!0,a.linearAdSlotWidth=parseInt(e.adWidth,10),a.linearAdSlotHeight=parseInt(e.adHeight,10),a.forceNonLinearFullSlot=!0,a.nonLinearAdSlotWidth=parseInt(e.adWidth,10),a.nonLinearAdSlotHeight=parseInt(e.adHeight,10),a.contentDuration=1200,a.contentTitle=document.title,a.vastLoadTimeout=1e4;var s=e.getAdTagUrl();a.adTagUrl=s,t.lsg.is_active?e.getAdVastXML(s).then(function(t){a.adsResponse=t,e.adsLoader.requestAds(a)},function(){e.adsLoader.requestAds(a)}):(a.adTagUrl=e.getAdTagUrl("",""),e.adsLoader.requestAds(a)),e.adDidLoad=!1,e.adDidShow=!1,e.show_initial=!1},n.prototype.getAdVastXML=function(){var n=t.config.adsVastXML,o=t.config.adTagXML,i=[];return new Promise(function(r,a){if("dfp"===e.provider){var s,l=function(){var e=t.lsg.exportRules(),n=[];n=t.lsg.isSamplingAllRules()?t.shuffleArray(e).slice(0,11):e.sort(function(e,t){return t[1]-e[1]});var o=[];return faZepto.each(n,function(e,t){o.push(t[0])}),o}(),c="a";return l=l.filter(function(e,t,n){return n.indexOf(e)==t}),t.log(l),s=t.sizeOf(l),faZepto.each(l,function(n,o){var r="lsg-o";e.setPriceRule(o),n===s-1&&(c="b"),t.lsg.isSamplingAllRules()&&(r=Math.random()<.5?"lsg-sf":"lsg-s"),i.push(e.getAdTagUrl(c,r,n))}),faZepto.each(i,function(e,i){o=(o=(o=(o=t.config.adTagXML).replace("[index]",e+1)).replace("[fallback_index]",e)).replace("[vast_ad_tag_url]",i),n+=o+"\n"}),r(n+="</VAST>")}return a("Provider not supported, only (DFP): "+e.provider)})},n.prototype.getAdTagUrl=function(n,o,i){n=n||"",o=o||"";var r="",a=t.gametranslation.getNavigatorLanguage(),s=t.lsg.locale,l=e.adcount>0?"midroll":"preroll",c=t.config.ads.description_url,d=t.config.referrer_origin;detection.is.iframe&&t.config.referrer_matched&&"string"==typeof d&&!d.endsWith("famobi.com")&&(c=d),e.dfp_custom_params={a:""+t.config.aid,game:""+window.famobi_gameID,gametype:"html5",uuid:""+t.config.uuid,video:e.show_video?"1":"0",adcount:e.adcount>20?"gt20":e.adcount>=10?""+e.adcount:"0"+e.adcount};var u=e.getPriceRuleName();return u&&(e.dfp_custom_params.pr=u),o&&(e.dfp_custom_params.pm=o),n&&(e.dfp_custom_params.ab=n),e.dfp_custom_params.wfid="number"==typeof i&&i>0?"01":"00",e.dfp_custom_params.host=window.location.host||"",e.dfp_custom_params.rhost=t.config.referrer_origin||"",e.dfp_custom_params.if=detection.is.iframe?"1":"0",e.dfp_custom_params.rm=t.config.referrer_matched?"1":"0",r=(r=(r="https://securepubads.g.doubleclick.net/gampad/ads?gdpr=[gdpr]&npa=[npa]&gdfp_req=1&env=vp&output=xml_vast4&overlay=0&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]&ciu_szs=").replace("[npa]",t.config.ads.npa?"1":"0")).replace("[gdpr]","0"),""!=e.dfp_ad_unit_code&&(r=r+"&iu="+e.dfp_ad_unit_code),e.adWidth>=728?r+="&sz=728x480|640x480|336x280|300x250|1x1":e.adWidth>=640||e.dfp_custom_params.video&&"1"===e.dfp_custom_params.video?r+="&sz=640x480|336x280|300x250|1x1":e.adWidth>=336?r+="&sz=336x280|300x250|1x1":r+="&sz=300x250|1x1",""!=c&&(r=r+"&description_url="+encodeURIComponent(c)),e.dfp_custom_params&&(r=r+"&cust_params="+encodeURIComponent(faZepto.param(e.dfp_custom_params))),""!=a&&(r=r+"&hl="+a),""!=s&&(r=r+"&cn="+s),""!=l&&(r=r+"&vpos="+l),r},n.prototype.getVastTagUrl=function(){return t.adapters.run("ads","vastUrl"),new Promise(function(n){var o=e.getAdTagUrl();t.config.ads.vast_url?n(o=(o=(o=(o=(o=t.config.ads.vast_url).replace(/\[UA\]/,encodeURIComponent(navigator.userAgent))).replace(/\[URL\]/,encodeURIComponent(t.config.ads.description_url))).replace(/\[DEVICECATEGORY\]/,detection.is.tablet?"tablet":"phone")).replace(/\[CACHEBUSTER\]/,t.rand(1e5,999999))):n(o)})},n.prototype.initAdModal=function(n){var o=faZepto.extend({iframeAllowed:!1,force:!1,returnCallback:function(){}},n);return!e.delayNextAdModal(o.force)||(t.modal.setCloseCallback(o.returnCallback),!1)},n.prototype.showAdModal=function(n,o){var i=faZepto.extend({mode:"seamless",closeBtnTimer:15,faketime:3,showCloseBtn:!1,returnCallback:function(){},returnCallback2:function(){var n=faZepto.extend({},e.defaultReturnValue,{adDidLoad:e.adDidLoad,adDidShow:e.adDidShow,adCount:e.adcount});t.adapters.run("ads","callback",n),e.delayNextAdModal(!0),faZepto(e.playBtnContainer).remove(),e.playBtnContainer=void 0,t.game.isWaiting()&&(t.game.setWaiting(!1),t.game.init()),t.lsg.is_active&&t.lsg.remix({lastRequestWas:e.adDidLoad?"fill":"nofill"})}},n);return e.delayNextAdModal(!0),t.modal.create(i),t.modal.updateCloseBtn(!0),t.modal.setCloseBtnTimer(i.closeBtnTimer,{faketime:i.faketime}),t.modal.setDimensions(i.width,i.height),t.modal.setContent(o),t.modal.setCloseCallback(i.returnCallback),t.modal.setCloseCallback(i.returnCallback2),t},n.prototype.delayNextAdModal=function(n){if(!e.isEnabled())return t.log("ads disabled"),!0;if(n)e.lastAdCall=t.now();else if(!e.hasCooledDown())return t.log("skipped ad"),!0;return!1},n.prototype.hasCooledDown=function(){var n=0===e.adcount&&+t.config.ads.min_s_before>0?+t.config.ads.min_s_before:+t.config.ads.min_s_between;return t.now()-1e3*n>e.lastAdCall},n.prototype.isAdvertisingActive=function(e){return!(!e.iframeAllowed&&window.top!==window.self)||(t.log("ads disabled in <iframe>"),!1)},n.prototype.isNthAdvertising=function(t){return+e.adcount%t===0},n.prototype.lastAdCallWasNsecondsAgo=function(n){return t.now()-1e3*n>=e.lastAdCall},n.prototype.fireAdCallback=function(){"function"==typeof e.closeCallback&&e.closeCallback.apply(e,arguments),e.closeCallback=function(){}},n.prototype.isEnabled=function(){return t.hasFeature("ads")&&!t.config.ads.off},n.prototype.floodProtect=function(t,n){return!!e.floodProtectionMap[t]||(e.floodProtectionMap[t]=setTimeout(function(){e.floodProtectionMap[t]=void 0},n),!1)},(e=new n).init(),e},fg_api.prototype.huaweiAdsModule=function(){var e,t=this;function n(){this.closeCallback=function(){},this.adDidLoad=!1,this.adDidShow=!1,this.lastAdCall=+t.now(),this.defaultReturnValue={adType:"interstitial",adDidLoad:!1,adDidShow:!1,adCount:0},this.click2play_triggered=!1}return n.prototype.init=function(){switch(t.log("Famobi Huawei Ads Module Initializing"),t.config.ads=faZepto.extend({off:"vp"===window.famobi_env||"off"===t.config.gameParams.ad_type,show_initial:!1,show_video:!1},t.config.ads),e.isEnabled()?e.provider=t.config.ads.provider:e.provider="none",e.adcount=0,e.floodProtectionMap={},!1===t.config.gameParams.show_initial?e.show_initial=!1:e.show_initial=t.config.ads.show_initial&&!t.config.ads.off,e.show_video=t.config.ads.show_video,e.provider){case"a4g":case"aerserv":case"redpm":case"dfp":t.game.setWaiting(!t.config.ads.off),e.dfp_ad_unit_code="/37336410/InGameInterstitial//"+t.config.aid+"//d0",faZepto.getScript("https://imasdk.googleapis.com/js/sdkloader/ima3_debug.js",n,function(){t.log("failed to load ima sdk"),n()});break;case"custom":t.game.setWaiting(!t.config.ads.off),n();break;case"none":t.config.ads.off=!0;default:n()}function n(){"undefined"!=typeof google&&google.ima&&(google.ima.settings.setLocale(t.gametranslation.getNavigatorLanguage()),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setDisableFlashAds(!0));var n=function(){t.config.ads.off||e.showClick2PlayOverlay(function(){function n(){faZepto(e.playBtnContainer).remove(),t.game.isWaiting()&&(t.game.setWaiting(!1),t.game.init())}if(e.show_initial){if(t.adapters.run("ads","show",n,!0))return;e.showVideoAd(n,!0)}else n()})},o=function(){n()};"dfp"===e.provider?t.lsg.ready().then(function(){o(t.lsg.getLocale())},function(){t.geo.getCountryCode().then(o,o)}):"sulvo"===e.provider?e.forceAd():n()}},n.prototype.getAdCount=function(){return+e.adcount},n.prototype.createClick2PlayOverlay=function(n){return new Promise(function(o,i){e.playBtnContainer&&o();var r=t.config.name;switch(window.famobi_gameID){case"embed-game":case"test-game":case"flash-game":r=""}e.playBtnContainer=t.createElement("div",{class:"fg-click2play"+(n?"":" fg-click2play-continue")+(detection.is.smartphone?" smartphone":""),style:"opacity: 0;transition: opacity 1s;"}),e.gameIcon=t.createElement("div",{class:"fg-gameicon",title:r}),e.branding=t.createElement("div",{class:"fg-branding"});var a=Promise.resolve();void 0!==t.config.thumb&&(a=new Promise(function(n,o){var i=document.createElement("img");i.onload=function(){e.gameIcon.innerHTML='<img src="'+t.config.thumb+'" alt>',n()},i.onerror=n,i.src=t.config.thumb}),n?(e.branding.style.background='#000 url("'+t.config.blurred_thumb+'") no-repeat center center',e.branding.style.backgroundSize="cover"):e.branding.style.background="#000"),e.playBtnStage=t.createElement("div",{class:"fg-click2play-stage"}),e.playBtn=t.createElement("div",{class:"btn-play",title:""}),e.playBtn.innerHTML='<div class="fg-click2play-loading"><span class="fg-click2play-loading-bounce1"></span><span class="fg-click2play-loading-bounce2"></span><span class="fg-click2play-loading-bounce3"></span></div>',e.privacyInfo=t.createElement("div",{class:"privacy-info"}),e.privacyInfo.innerHTML=t.translate("api.privacy_info")+t.translate("api.privacy_link"),e.stageHeader=t.createElement("div",{class:"fg-click2play-stage-header"}),e.gameDetails=t.createElement("div",{class:"fg-gameDetails"}),e.stageFooter=t.createElement("div",{class:"fg-click2play-stage-footer"}),e.playBtnContainer.appendChild(e.playBtnStage),e.playBtnStage.appendChild(e.stageHeader),e.playBtnStage.appendChild(e.gameDetails),e.gameDetails.appendChild(e.gameIcon),e.playBtnContainer.appendChild(e.branding),e.gameDetails.appendChild(e.playBtn),e.playBtnStage.appendChild(e.stageFooter),t.consent&&t.consent.isPlatformLoaded()||(e.stageFooter.appendChild(e.privacyInfo),t.adapters&&t.adapters.add("consent","platformLoaded",function(){e.stageFooter&&(faZepto(e.stageFooter).css({opacity:"0",transition:"opacity 1s"}),setTimeout(function(){e.stageFooter&&(e.stageFooter.style.visibility="hidden")},1e3))})),a.then(o,i)})},n.prototype.showVideoAd=function(n,o){if(e.delayNextAdModal(o))return"function"==typeof n&&n(),!1;var i=0==e.adcount;i||t.spinner.show();try{e.show_initial&&t.fullscreen.start()}catch(e){t.log(e)}switch(t.game.pause(),e.provider){case"a4g":case"aerserv":case"redpm":case"dfp":e.showIMA(function(){try{t.orientation.lock()}catch(e){t.log(e)}e.fireAdCallback(),t.game.resume()},o,!i);break;default:n()}},n.prototype.showClick2PlayOverlay=function(n){var o=e.createClick2PlayOverlay(!0),i=new Promise(function(e,t){"complete"!=document.readyState?document.addEventListener("readystatechange",function(){"complete"==document.readyState&&e()},!1):e()});function r(){faZepto(e.playBtn).addClass("loading"),t.localStorage.setItem("privacy_policy_accepted","yes"),"function"==typeof n&&n()}Promise.race([t.wait(3e3),Promise.all([i,o])]).then(function(){return t.rootElement.appendChild(e.playBtnContainer),t.wait(33)}).then(function(){faZepto(e.playBtnContainer).css({opacity:"1"}),t.spinner.hide(),t.navigation.invisible(),t.handleClick(e.playBtn,r),faZepto(e.playBtn).css({cursor:"pointer"})})},n.prototype.showAd=function(n,o,i){if(t.adapters.run("ads","show",n,o))return!1;switch(e.closeCallback=n,e.provider){case"dfp":return i?e.showIMA(n,o):e.showVideoAd(n,o);case"blocker":return e.showBlocker(n,o);default:return e.fireAdCallback()}},n.prototype.showInterstitialAd=function(n){return new Promise(function(o,i){n&&o(),t.adapters.run("ads","show",null,!0)&&i(),e.showAd(function(){o()})})},n.prototype.forceAd=function(n){return!t.adapters.run("ads","show",n,!0)&&e.showAd(n,!0)},n.prototype.showAlsoLikedApps=function(n,o){var i={force:!!o,iframeAllowed:!0,min_s_between:0,returnCallback:function(){},title:t.__("api.people_also_like_headline")};if(!e.isEnabled())return t.log("ads disabled"),e.fireAdCallback(),!1;if(e.delayNextAdModal(o))return e.fireAdCallback(),!1;var r=[{id:"famobi/fruita-crush",name:"Fruita Crush",thumb:"https://img.cdn.famobi.com/portal/html5games/images/tmp/180/FruitaCrushTeaser.jpg"},{id:"famobi/solitaire-classic",name:"Solitaire Classic",thumb:"https://img.cdn.famobi.com/portal/html5games/images/tmp/180/SolitaireClassicTeaser.jpg"},{id:"famobi/smarty-bubbles-xmas",name:"Smarty Bubbles X-MAS EDITION",thumb:"https://img.cdn.famobi.com/portal/html5games/images/tmp/180/SmartyBubblesXmasTeaser.jpg"},{id:"famobi/jewelish",name:"Jewelish",thumb:"https://img.cdn.famobi.com/portal/html5games/images/tmp/180/Jewelish_Teaser.jpg"},{id:"famobi/archery-world-tour",name:"Archery World Tour",thumb:"https://img.cdn.famobi.com/portal/html5games/images/tmp/180/ArcheryWorldTourTeaser.jpg"},{id:"famobi/penalty-shooters-2",name:"Penalty Shooters 2",thumb:"https://img.cdn.famobi.com/portal/html5games/images/tmp/180/PenaltyShooters2Teaser.jpg"},{id:"famobi/wedding-lily",name:"Wedding Lily",thumb:"https://img.cdn.famobi.com/portal/html5games/images/tmp/180/WeddingLilyTeaser.jpg"}];!function(e){(e=e||r).length||(e=r);var o=t.createElement("ul");e.slice(0,4).forEach(function(e){var n=t.createElement("li"),i=e.id.split("/")[1],r=t.createElement("a",{href:"javascript:;","data-xhref":"https://play.famobi.com/"+i+"/"+t.config.aid+"?original_ref="+encodeURIComponent(t.getShortLink()),title:e.name,target:"_blank"}),a=t.createElement("div",{class:"fg-notify-imgHolder"}),s=t.createElement("img",{src:e.thumb});a.appendChild(s),r.appendChild(a),n.appendChild(r),o.appendChild(n)}),t.notify.create(i),t.notify.setContent(o),t.notify.setCloseCallback(n)}(t.config.gameParams.related)},n.prototype.getPriceRuleName=function(){return e.priceRule&&e.priceRule.name?e.priceRule.name:""},n.prototype.setPriceRule=function(t,n){return"object"==typeof t&&(n=t.value,t=t.name),e.priceRule={name:""+t,value:+n}},n.prototype.showIMA=function(o,i,r){if(!e.initAdModal({returnCallback:function(){e.fireAdCallback()},force:i,iframeAllowed:t.config.ads.dfp_available}))return!1;t.modal.setCloseCallback(function(){e.adsManager&&e.adsManager.destroy()}),e.adContainerElement=document.createElement("div"),e.adContainerElement.className="fg-ad-container",e.adContainerElement.style.zIndex="9999990",e.adContainerElement.style.margin="0 auto 0",e.adContainerElement.setAttribute("playsinline","true"),t.rootElement.appendChild(e.adContainerElement),e.adWidth=parseInt(window.innerWidth,10),e.adHeight=parseInt(window.innerHeight,10),e.adContainerElement.setAttribute("width",e.adWidth),e.adContainerElement.setAttribute("height",e.adHeight),e.adContainerElement.style.width=e.adWidth+"px",e.adContainerElement.style.height=e.adHeight+"px";try{e.showAdModal({overlayStyle:{background:"transparent"},returnCallback:o,width:e.adWidth,height:e.adHeight},e.adContainerElement),e.adDisplayContainer=new google.ima.AdDisplayContainer(e.adContainerElement),e.adsLoader=new google.ima.AdsLoader(e.adDisplayContainer),e.adsLoader.getSettings().setDisableFlashAds(!0),e.adsLoader.getSettings().setDisableCustomPlaybackForIOS10Plus(!0),e.adDisplayContainer.initialize()}catch(n){return t.debug&&t.log(n),faZepto(e.playBtnContainer).remove(),t.modal.close(),t.game.isWaiting()&&(t.game.setWaiting(!1),t.game.init()),e.showAlsoLikedApps(o)}r&&t.spinner.show(),n.prototype.onAdsManagerLoaded=function(t){var n=new google.ima.AdsRenderingSettings;n.enablePreloading=!0,n.loadVideoTimeout=15e3,e.adsManager=t.getAdsManager(e.adContainerElement,n),faZepto.each(["LOADED","IMPRESSION","STARTED","SKIPPABLE_STATE_CHANGED","FIRST_QUARTILE","MIDPOINT","THIRD_QUARTILE","USER_CLOSE","SKIPPED","COMPLETE","ALL_ADS_COMPLETED","DURATION_CHANGE","CONTENT_RESUME_REQUESTED","CONTENT_PAUSE_REQUESTED","LOG"],function(t,n){e.adsManager.addEventListener(google.ima.AdEvent.Type[n],e.onAdEvent)}),e.adsManager.init(e.adWidth,e.adHeight,google.ima.ViewMode.NORMAL),e.adsManager.start()},n.prototype.onAdEvent=function(n){var o=n.getAd();switch(t.log(n),n.type){case google.ima.AdEvent.Type.LOADED:e.adDidLoad=!0,e.adcount++,t.adapters.run("adEvent","loaded",o),o.isLinear()&&e.adsManager.getRemainingTime()>0&&t.modal.setCloseBtnTimer(15),faZepto(t.modal.overlay).css("background","#000");break;case google.ima.AdEvent.Type.IMPRESSION:e.adDidShow=!0;break;case google.ima.AdEvent.Type.STARTED:e.adDidLoad=!0,o.isLinear()&&e.adsManager.getRemainingTime(),r&&t.spinner.hide(),t.modal.clearCloseBtnTimer(),t.modal.activateCloseBtn(!1);break;case google.ima.AdEvent.Type.DURATION_CHANGE:e.delayNextAdModal(!0);break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:faZepto(e.playBtnContainer).remove(),e.playBtnContainer=void 0;break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:faZepto(t.modal.overlay).css("background","transparent"),r&&t.spinner.hide(),t.modal.close()}switch(n.type){case google.ima.AdEvent.Type.STARTED:t.adapters.run("adEvent","displayed");break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:t.adapters.run("adEvent","completed",e.adcount);break;case google.ima.AdEvent.Type.SKIPPED:t.adapters.run("adEvent","skipped");break;case google.ima.AdEvent.Type.USER_CLOSE:t.adapters.run("adEvent","userClosed",e.adcount)}},n.prototype.onAdError=function(n){t.log(n.getError()),t.modal.close(),r&&t.spinner.hide(),t.adapters.run("adEvent","errored",n),e.adsManager&&e.adsManager.destroy()},e.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,e.onAdsManagerLoaded,!1),e.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,e.onAdError,!1);var a=new google.ima.AdsRequest;a.disableCompanionAds=!0,a.linearAdSlotWidth=parseInt(e.adWidth,10),a.linearAdSlotHeight=parseInt(e.adHeight,10),a.forceNonLinearFullSlot=!0,a.nonLinearAdSlotWidth=parseInt(e.adWidth,10),a.nonLinearAdSlotHeight=parseInt(e.adHeight,10),a.contentDuration=1200,a.contentTitle=document.title,a.vastLoadTimeout=1e4;var s=e.getAdTagUrl();a.adTagUrl=s,t.lsg.is_active?e.getAdVastXML(s).then(function(t){a.adsResponse=t,e.adsLoader.requestAds(a)},function(){e.adsLoader.requestAds(a)}):(a.adTagUrl=e.getAdTagUrl("",""),e.adsLoader.requestAds(a)),e.adDidLoad=!1,e.adDidShow=!1,e.show_initial=!1},n.prototype.getAdVastXML=function(){var n=t.config.adsVastXML,o=t.config.adTagXML,i=[];return new Promise(function(r,a){if("dfp"===e.provider){var s,l=function(){var e=t.lsg.exportRules(),n=[];n=t.lsg.isSamplingAllRules()?t.shuffleArray(e).slice(0,11):e.sort(function(e,t){return t[1]-e[1]});var o=[];return faZepto.each(n,function(e,t){o.push(t[0])}),o}(),c="a";return l=l.filter(function(e,t,n){return n.indexOf(e)==t}),t.log(l),s=t.sizeOf(l),faZepto.each(l,function(n,o){var r="lsg-o";e.setPriceRule(o),n===s-1&&(c="b"),t.lsg.isSamplingAllRules()&&(r=Math.random()<.5?"lsg-sf":"lsg-s"),i.push(e.getAdTagUrl(c,r,n))}),faZepto.each(i,function(e,i){o=(o=(o=(o=t.config.adTagXML).replace("[index]",e+1)).replace("[fallback_index]",e)).replace("[vast_ad_tag_url]",i),n+=o+"\n"}),r(n+="</VAST>")}return a("Provider not supported, only (DFP): "+e.provider)})},n.prototype.getAdTagUrl=function(n,o,i){n=n||"",o=o||"";var r="",a=t.gametranslation.getNavigatorLanguage(),s=t.lsg.locale,l=e.adcount>0?"midroll":"preroll",c=t.config.ads.description_url,d=t.config.referrer_origin;detection.is.iframe&&t.config.referrer_matched&&"string"==typeof d&&!d.endsWith("famobi.com")&&(c=d),e.dfp_custom_params={a:""+t.config.aid,game:""+window.famobi_gameID,gametype:"html5",uuid:""+t.config.uuid,video:e.show_video?"1":"0",adcount:e.adcount>20?"gt20":e.adcount>=10?""+e.adcount:"0"+e.adcount};var u=e.getPriceRuleName();return u&&(e.dfp_custom_params.pr=u),o&&(e.dfp_custom_params.pm=o),n&&(e.dfp_custom_params.ab=n),e.dfp_custom_params.wfid="number"==typeof i&&i>0?"01":"00",e.dfp_custom_params.host=window.location.host||"",e.dfp_custom_params.rhost=t.config.referrer_origin||"",e.dfp_custom_params.if=detection.is.iframe?"1":"0",e.dfp_custom_params.rm=t.config.referrer_matched?"1":"0",r=(r=(r="https://securepubads.g.doubleclick.net/gampad/ads?gdpr=[gdpr]&npa=[npa]&gdfp_req=1&env=vp&output=xml_vast4&overlay=0&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]&ciu_szs=").replace("[npa]",t.config.ads.npa?"1":"0")).replace("[gdpr]","0"),""!=e.dfp_ad_unit_code&&(r=r+"&iu="+e.dfp_ad_unit_code),e.adWidth>=728?r+="&sz=728x480|640x480|336x280|300x250|1x1":e.adWidth>=640||e.dfp_custom_params.video&&"1"===e.dfp_custom_params.video?r+="&sz=640x480|336x280|300x250|1x1":e.adWidth>=336?r+="&sz=336x280|300x250|1x1":r+="&sz=300x250|1x1",""!=c&&(r=r+"&description_url="+encodeURIComponent(c)),e.dfp_custom_params&&(r=r+"&cust_params="+encodeURIComponent(faZepto.param(e.dfp_custom_params))),""!=a&&(r=r+"&hl="+a),""!=s&&(r=r+"&cn="+s),""!=l&&(r=r+"&vpos="+l),r},n.prototype.getVastTagUrl=function(){return t.adapters.run("ads","vastUrl"),new Promise(function(n){var o=e.getAdTagUrl();t.config.ads.vast_url?n(o=(o=(o=(o=(o=t.config.ads.vast_url).replace(/\[UA\]/,encodeURIComponent(navigator.userAgent))).replace(/\[URL\]/,encodeURIComponent(t.config.ads.description_url))).replace(/\[DEVICECATEGORY\]/,detection.is.tablet?"tablet":"phone")).replace(/\[CACHEBUSTER\]/,t.rand(1e5,999999))):n(o)})},n.prototype.initAdModal=function(n){var o=faZepto.extend({iframeAllowed:!1,force:!1,returnCallback:function(){}},n);return!e.delayNextAdModal(o.force)||(t.modal.setCloseCallback(o.returnCallback),!1)},n.prototype.showAdModal=function(n,o){var i=faZepto.extend({mode:"seamless",closeBtnTimer:15,faketime:3,showCloseBtn:!1,returnCallback:function(){},returnCallback2:function(){var n=faZepto.extend({},e.defaultReturnValue,{adDidLoad:e.adDidLoad,adDidShow:e.adDidShow,adCount:e.adcount});t.adapters.run("ads","callback",n),e.delayNextAdModal(!0),faZepto(e.playBtnContainer).remove(),e.playBtnContainer=void 0,t.game.isWaiting()&&(t.game.setWaiting(!1),t.game.init()),t.lsg.is_active&&t.lsg.remix({lastRequestWas:e.adDidLoad?"fill":"nofill"})}},n);return e.delayNextAdModal(!0),t.modal.create(i),t.modal.updateCloseBtn(!0),t.modal.setCloseBtnTimer(i.closeBtnTimer,{faketime:i.faketime}),t.modal.setDimensions(i.width,i.height),t.modal.setContent(o),t.modal.setCloseCallback(i.returnCallback),t.modal.setCloseCallback(i.returnCallback2),t},n.prototype.delayNextAdModal=function(n){if(!e.isEnabled())return t.log("ads disabled"),!0;if(n)e.lastAdCall=t.now();else if(!e.hasCooledDown())return t.log("skipped ad"),!0;return!1},n.prototype.hasCooledDown=function(){var n=0===e.adcount&&+t.config.ads.min_s_before>0?+t.config.ads.min_s_before:+t.config.ads.min_s_between;return t.now()-1e3*n>e.lastAdCall},n.prototype.isAdvertisingActive=function(e){return!(!e.iframeAllowed&&window.top!==window.self)||(t.log("ads disabled in <iframe>"),!1)},n.prototype.isNthAdvertising=function(t){return+e.adcount%t===0},n.prototype.lastAdCallWasNsecondsAgo=function(n){return t.now()-1e3*n>=e.lastAdCall},n.prototype.fireAdCallback=function(){"function"==typeof e.closeCallback&&e.closeCallback.apply(e,arguments),e.closeCallback=function(){}},n.prototype.isEnabled=function(){return t.hasFeature("ads")&&!t.config.ads.off},n.prototype.floodProtect=function(t,n){return!!e.floodProtectionMap[t]||(e.floodProtectionMap[t]=setTimeout(function(){e.floodProtectionMap[t]=void 0},n),!1)},(e=new n).init(),e},fg_api.prototype.showAd=function(e,t,n){this.ads.floodProtect("Show Ad",1e3)?"function"==typeof e&&e(this.ads.defaultReturnValue):this.ads.showAd.apply(this,arguments)},fg_api.prototype.forceAd=function(e){this.ads.floodProtect("Force Ad",1e3)?"function"==typeof e&&e():this.ads.forceAd(e)},fg_api.prototype.showInterstitialAd=function(){return this.log("showInterstitialAd: This feature is experimental and will be included in a future version of this API"),Promise.resolve()},fg_api.prototype.showTeaser=function(e){this.ads.floodProtect("Teaser Ad",1e3)?"function"==typeof e&&e():this.ads.showAlsoLikedApps(e)},fg_api.prototype.rewardedadsModule=function(){var e,t=this;function n(){this.NUM_MAX_FAILED_PRELOADS=3,this.TIMEOUT_AFTER_FAILED_PRELOADS=6e4,this.TIMEOUT_BEFORE_PRELOAD_CANCELLED=5e3,this.TIMEOUT_GPT_CLOSING_EVENTS=500,this.TIMEOUT_NEXT_PRELOAD=1e3,this.TIMEOUT_FLOOD_PROTECTION=1e3,this.closeCallback=function(){},this.adDidLoad=!1,this.adDidShow=!1,this.lastAdCall=+t.now(),this.adCount=0,this.floodProtectionMap={},this.dfp_ad_unit_code="",this.gptInitialized=!1,this.rewardedAd={oldSlots:[],slot:void 0,event:void 0,state:void 0,rewardGranted:!1,preloadPromiseResolve:function(){},preloadPromiseReject:function(){},preloadPromise:void 0,playPromiseResolve:function(){},playPromiseReject:function(){},playPromise:void 0},this.defaultReturnValue={adType:"rewarded",adDidLoad:!1,adDidShow:!1,adCount:0,rewardGranted:!1},this.showAdActive=!1,this.preloadFailCount=0,this.preloadBlocked=!1}return n.prototype.states={PRELOADING:1,READY:2,PLAYING:3,CLOSING:4,FAILED:5},n.prototype.init=function(){var n=t.getUrlParams();!n.fg_env||"dev"!=n.fg_env&&"staging"!=n.fg_env?e.dfp_ad_unit_code="/37336410/InGameInterstitial//"+t.config.aid+"//d0":e.dfp_ad_unit_code="/6062/sanghan_rweb_ad_unit",t.hasFeature("rewarded")&&faZepto.getScript("//www.googletagservices.com/tag/js/gpt.js",function(){window.googletag=window.googletag||{},googletag.cmd=googletag.cmd||[],window.googletag.cmd.push(function(){e.gptInitialized=!0,window.googletag.pubads().setRequestNonPersonalizedAds(t.config.ads.npa?1:0),window.googletag.pubads().addEventListener("rewardedSlotReady",function(n){t.log("rewarded slot ready"),e.rewardedAd.event=n,e.rewardedAd.state=e.states.READY,e.adDidLoad=!0,e.rewardedAd.preloadPromiseResolve(n)}),window.googletag.pubads().addEventListener("rewardedSlotClosed",function(){t.log("rewarded slot closed")}),window.googletag.pubads().addEventListener("rewardedSlotCanceled",function(){t.log("rewarded slot canceled"),e.adDidShow=!0,e.initiateClosing()}),window.googletag.pubads().addEventListener("rewardedSlotGranted",function(){t.log("rewarded slot granted"),e.rewardedAd.rewardGranted=!0,e.adDidShow=!0,e.initiateClosing()}),window.googletag.pubads().addEventListener("rewardedSlotCompleted",function(){t.log("rewarded ad video completed")}),window.googletag.pubads().addEventListener("slotRenderEnded",function(n){t.log("rewarded slot render ended"),n.isEmpty&&(t.log("No ad returned."),e.rewardedAd.preloadPromiseReject())}),window.googletag.pubads().addEventListener("slotResponseReceived",function(e){t.log("slot responce received",e)}),window.googletag.pubads().addEventListener("slotRequested",function(e){t.log("slot requested",e)}),window.googletag.pubads().addEventListener("slotOnload",function(e){t.log("slot on load",e)}),window.googletag.pubads().addEventListener("slotAdded",function(e){t.log("slot added",e)}),e.preloadRewardedAd().catch(function(e){t.log("rewarded ads: initial preload failed.",e)})})},function(){t.log("failed to load google publisher tag library")})},n.prototype.initiateClosing=function(){t.log("initiateClosing called"),e.rewardedAd.state!=e.states.closing&&(e.rewardedAd.state=e.states.closing,t.wait(e.TIMEOUT_GPT_CLOSING_EVENTS).then(function(){e.rewardedAd.playPromiseResolve()}))},n.prototype.destroyOldSlots=function(){e.rewardedAd.oldSlots.length>0&&window.googletag.cmd.push(function(){window.googletag.destroySlots(e.rewardedAd.oldSlots)?t.log("destroyed rewarded ad slots"):t.log("failed to destroy rewarded ad slots"),e.rewardedAd.oldSlots=[]})},n.prototype.reset=function(){t.log("reset called"),e.closeCallback=function(){},e.adDidLoad=!1,e.adDidShow=!1,e.rewardedAd.slot=void 0,e.rewardedAd.event=void 0,e.rewardedAd.state=void 0,e.rewardedAd.rewardGranted=!1,e.rewardedAd.preloadPromiseResolve=function(){},e.rewardedAd.preloadPromiseReject=function(){},e.rewardedAd.preloadPromise=void 0,e.rewardedAd.playPromiseResolve=function(){},e.rewardedAd.playPromiseReject=function(){},e.rewardedAd.playPromise=void 0,e.showAdActive=!1},n.prototype.isEnabled=function(){return t.hasFeature("ads")&&t.hasFeature("rewarded")&&!t.config.ads.off},n.prototype.hasAd=function(){return e.isEnabled()&&e.rewardedAd.state==e.states.READY},n.prototype.showAd=function(n){return!t.adapters.run("ads","rewarded",n)&&(!e.showAdActive&&e.isEnabled()&&e.gptInitialized?(e.showAdActive=!0,e.closeCallback=n,t.spinner.show(),t.game.pause(),void e.preloadRewardedAd().then(function(){return t.log("rewarded ads: preload succeeded."),t.spinner.hide(),e.playRewardedAd()}).then(function(){return t.log("rewarded ads: ad shown."),Promise.resolve()}).catch(function(e){t.log("rewarded ad failed",e),t.spinner.hide()}).then(function(){e.rewardedAd.slot&&e.rewardedAd.oldSlots.push(e.rewardedAd.slot),e.showAdActive&&(e.fireAdCallback(),t.game.resume()),e.reset(),t.wait(e.TIMEOUT_NEXT_PRELOAD).then(function(){e.preloadRewardedAd().catch(function(e){t.log("rewarded ads: auto preload failed.",e)}),e.destroyOldSlots()})})):("function"==typeof n&&n(e.defaultReturnValue),!1))},n.prototype.playRewardedAd=function(){return e.rewardedAd.state==e.states.READY&&e.rewardedAd.event?(e.rewardedAd.playPromise=new Promise(function(t,n){e.rewardedAd.playPromiseResolve=t,e.rewardedAd.playPromiseReject=n,e.rewardedAd.state=e.states.PLAYING,e.adCount++,e.rewardedAd.event.makeRewardedVisible()}),e.rewardedAd.playPromise):Promise.reject(new Error("invalid state after preload"))},n.prototype.configureRewardedSlot=function(){window.googletag.cmd.push(function(){e.rewardedAd.slot=window.googletag.defineOutOfPageSlot(e.dfp_ad_unit_code,window.googletag.enums.OutOfPageFormat.REWARDED).addService(window.googletag.pubads()).setTargeting("a",""+t.config.aid).setTargeting("game",""+window.famobi_gameID).setTargeting("gametype","html5").setTargeting("video","1").setTargeting("uuid",""+t.config.uuid),window.googletag.pubadsReady||(window.googletag.pubads().enableAsyncRendering(),window.googletag.enableServices(),t.log("enabled & initialized gpt services"))})},n.prototype.preloadRewardedAd=function(){return e.gptInitialized?e.rewardedAd.state==e.states.PLAYING||e.rewardedAd.state==e.states.CLOSING?Promise.reject(new Error("preload cancelled: previous ad still active")):e.rewardedAd.state==e.states.PRELOADING||e.rewardedAd.state==e.states.READY?e.rewardedAd.preloadPromise instanceof Promise?e.rewardedAd.preloadPromise:Promise.reject(new Error("preload faulty: missing current preloader promise")):(e.preloadFailCount>e.NUM_MAX_FAILED_PRELOADS&&!e.preloadBlocked&&(e.preloadBlocked=!0,t.wait(e.TIMEOUT_AFTER_FAILED_PRELOADS).then(function(){e.preloadFailCount=0,e.preloadBlocked=!1})),e.preloadBlocked?Promise.reject(new Error("preload cancelled: too many failed attempts")):(e.rewardedAd.preloadPromise=new Promise(function(n,o){e.rewardedAd.preloadPromiseResolve=n,e.rewardedAd.preloadPromiseReject=o,e.rewardedAd.state=e.states.PRELOADING,window.googletag.cmd.push(function(){e.configureRewardedSlot(),window.googletag.display(e.rewardedAd.slot)}),t.wait(e.TIMEOUT_BEFORE_PRELOAD_CANCELLED).then(function(){o(new Error("preload cancelled: timeout while waiting for gpt events"))})}),e.rewardedAd.preloadPromise.catch(function(){e.rewardedAd.preloadPromise=void 0,e.rewardedAd.preloadPromiseResolve=function(){},e.rewardedAd.preloadPromiseReject=function(){},e.rewardedAd.oldSlots.push(e.rewardedAd.slot),e.rewardedAd.slot=void 0,e.rewardedAd.state=void 0,e.preloadFailCount+=1}),e.rewardedAd.preloadPromise)):Promise.reject(new Error("preload cancelled: gpt not initialized"))},n.prototype.hasCooledDown=function(){var n=0===e.adCount&&+t.config.ads.min_s_before>0?+t.config.ads.min_s_before:+t.config.ads.min_s_between;return t.now()-1e3*n>e.lastAdCall},n.prototype.fireAdCallback=function(){if("function"==typeof e.closeCallback){var n=faZepto.extend({},e.defaultReturnValue,{adDidLoad:e.adDidLoad,adDidShow:e.adDidShow,adCount:e.adCount,rewardGranted:e.rewardedAd.rewardGranted});t.adapters.run("ads","callback",n),e.closeCallback(n)}},n.prototype.floodProtect=function(t,n){return!!e.floodProtectionMap[t]||(e.floodProtectionMap[t]=setTimeout(function(){e.floodProtectionMap[t]=void 0},n),!1)},(e=new n).init(),e},fg_api.prototype.preloadRewardedAd=function(){return this.rewardedads.preloadRewardedAd()},fg_api.prototype.hasRewardedAd=function(){return this.rewardedads.hasAd()},fg_api.prototype.rewardedAd=function(e){return this.rewardedads.floodProtect("Rewarded Ad",this.rewardedads.TIMEOUT_FLOOD_PROTECTION)?("function"==typeof e&&e(this.rewardedads.defaultReturnValue),!1):this.rewardedads.showAd(e)},fg_api.prototype.notifyModule=function(){var e,t=this;function n(){this.element="",this.closing=!1,this.closeCallbacks=[]}return n.prototype.init=function(){t.onorientationchange(function(){e.element&&e.setScrollAreaHeight()})},n.prototype.create=function(n){var o=faZepto.extend({overlayColor:null,overlayStyle:{},showCloseBtn:!0,returnCallback:function(){},title:""},n);e.closing||e.close(),t.navigation.invisible(),t.game.pause();var i="";o.mode&&(i=o.mode+"-mode"),e.element&&e.element.parentNode&&e.element.parentNode.removeChild(e.element),e.element=t.createElement("div",{class:"fg-notify fg-fade fg-show "+i}),e.overlay&&e.overlay.parentNode&&e.overlay.parentNode.removeChild(e.overlay),e.blurredBg=t.createElement("div",{class:"fg-notify-blurred-bg",style:"background-image: url("+t.config.blurred_thumb+")"}),t.rootElement.appendChild(e.blurredBg),e.overlay=t.createElement("div",{class:"fg-notify-overlay"}),o.overlayColor&&(e.overlay.style.backgroundColor=o.overlayColor),o.overlayStyle&&faZepto(e.overlay).css(o.overlayStyle),t.rootElement.appendChild(e.overlay),e.body=t.createElement("div",{class:"fg-notify-body"}),e.element.appendChild(e.body),e.header=t.createElement("div",{class:"fg-notify-header"}),e.body.appendChild(e.header),""!==o.title&&(e.headline=t.createElement("strong",{class:"fg-notify-headline"}),e.headline.innerHTML=o.title,e.header.appendChild(e.headline)),e.scrollArea=t.createElement("div",{class:"fg-notify-scrollarea"}),e.body.appendChild(e.scrollArea),faZepto(e.scrollArea).on("touchmove",function(e){return e.stopPropagation(),!0}),t.rootElement.appendChild(e.element),faZepto([e.element,e.blurredBg]).css({opacity:"0",transition:"opacity 1s"}),!1!==o.showCloseBtn&&e.showCloseBtn(),e.closeCallbacks.push(o.returnCallback),e.closeCallbacks.push(function(){t.wait(500).then(function(){t.game.resume()}),t.navigation.visible()})},n.prototype.showCloseBtn=function(){if(e.closeBtn=t.createElement("div",{class:"fg-notify-close icon-cancel"}),!e.element)return!1;e.closeBtn.innerHTML="",e.header.appendChild(e.closeBtn),t.handleClick(e.closeBtn,function(){this.getAttribute("data-disable")||e.close()}),t.handleClick(e.overlay,function(){e.closeBtn.getAttribute("data-disable")||e.overlay.getAttribute("data-disable")||e.close()})},n.prototype.setCloseCallback=function(t){return e.element?(e.closeCallbacks.push(t),!0):(t(),!1)},n.prototype.activateCloseOverlay=function(t){if(!e.overlay)return!1;t?e.overlay.removeAttribute("data-disable"):e.overlay.setAttribute("data-disable","true")},n.prototype.setContent=function(n){n&&e.scrollArea.appendChild(n),e.setScrollAreaHeight(),t.spinner.show(),faZepto([e.element,e.blurredBg]).css({opacity:"1"}),t.wait(1e3).then(function(){t.spinner.hide(),e.setScrollAreaHeight(),faZepto(e.element).find("[data-xhref]").each(function(){this.setAttribute("href",this.getAttribute("data-xhref"))})})},n.prototype.setScrollAreaHeight=function(){var t=faZepto(e.scrollArea);t.css("height",""),t.css("overflow-y","");var n=t.height(),o=faZepto(e.header),i=Number(faZepto(e.body).css("padding").replace("px","")),r=o.height()+Number(o.css("margin-bottom").replace("px","")),a=faZepto(window).height()-5*i-r;n>a&&(t.css("height",a+"px"),t.css("overflow-y","scroll"))},n.prototype.setDimensions=function(t,n){t&&""!==t||(t=480),n&&""!==n||(n=500),e.element.style.maxHeight=parseInt(n,10)+60+"px",e.element.style.maxWidth=parseInt(t,10)+20+"px",e.element.style.display=""},n.prototype.close=function(){return e.closing=!0,!!e.element&&(e.element.style.display="none",e.element.parentNode&&e.element.parentNode.removeChild(e.element),!!e.overlay&&(e.overlay.style.display="none",e.overlay.parentNode&&e.overlay.parentNode.removeChild(e.overlay),e.blurredBg&&(e.blurredBg.style.display="none",e.blurredBg.parentNode&&e.blurredBg.parentNode.removeChild(e.blurredBg)),faZepto.each(e.closeCallbacks,function(e,t){"function"==typeof t&&t()}),e.closeCallbacks=[],void(e.closing=!1)))},(e=new n).init(),e},fg_api.prototype.adaptersModule=function(){var e,t=this;function n(){this.adapters={ads:{show:this.createAdapter(),rewarded:this.createAdapter(),callback:this.createAdapter(),vastUrl:this.createAdapter()},adEvent:{loaded:this.createAdapter(),displayed:this.createAdapter(),errored:this.createAdapter(),userClosed:this.createAdapter(),completed:this.createAdapter()},analytics:{trackEvent:this.createAdapter(),trackScreen:this.createAdapter(),trackStats:this.createAdapter()},api:{created:this.createAdapter({queueCalls:!0,runOnce:!0})},game:{loaded:this.createAdapter({queueCalls:!0,runOnce:!0}),gameOver:this.createAdapter(),levelUp:this.createAdapter(),preloadProgress:this.createAdapter(),preloadComplete:this.createAdapter({queueCalls:!0,runOnce:!0}),ready:this.createAdapter({queueCalls:!0,runOnce:!0})},player:{ready:this.createAdapter({queueCalls:!0,queueLength:1,runOnce:!1})},highscore:{show:this.createAdapter(),submit:this.createAdapter()},screenshot:{submit:this.createAdapter()},request:{startGame:this.createAdapter({queueCalls:!0,runOnce:!0}),pauseGameplay:this.createAdapter(),resumeGameplay:this.createAdapter(),enableAudio:this.createAdapter(),disableAudio:this.createAdapter(),enableMusic:this.createAdapter(),disableMusic:this.createAdapter(),changeVolume:this.createAdapter()},consent:{platformLoaded:this.createAdapter({queueCalls:!0,runOnce:!0})},tracking:{trackEvent:this.createAdapter()}},this.adapter_templates={ads:{show:[function(e,t){}],rewarded:[function(e){}],callback:[function(e){}],vastUrl:[function(){}]},adEvent:{loaded:[function(e){}],displayed:[function(){}],errored:[function(e){}],userClosed:[function(e){}],completed:[function(e){}]},analytics:{trackEvent:[function(e,t){}],trackScreen:[function(e,t){}],trackStats:[function(e,t){}]},api:{created:[function(e){}]},game:{loaded:[function(){}],gameOver:[function(){}],levelUp:[function(){}],preloadProgress:[function(){}],preloadComplete:[function(){}],ready:[function(){}]},player:{ready:[function(){}]},highscore:{show:[function(e){}],submit:[function(e,t){}]},screenshot:{submit:[function(e,t){}]},request:{startGame:[function(){}],pauseGameplay:[function(){}],resumeGameplay:[function(){}],enableAudio:[function(){}],disableAudio:[function(){}],enableMusic:[function(){}],disableMusic:[function(){}],changeVolume:[function(e){}]},consent:{platformLoaded:[function(){}]},tracking:{trackEvent:[function(e,t){}]}}}var o=n.prototype;return o.createAdapter=function(e){return{callbacks:[],queueCalls:!(!e||!e.queueCalls),queue:[],queueLength:e&&"number"==typeof e.queueLength?e.queueLength:void 0,runOnce:!(!e||!e.runOnce),numRuns:0}},o.init=function(){var e="",t="";if(void 0!==window.famobi_adapters)for(e in window.famobi_adapters)for(t in window.famobi_adapters[e])this.add(e,t,window.famobi_adapters[e][t])},o.list=function(){return this.adapters},o.add=function(e,n,o){if(!(e in this.adapters)||!(n in this.adapters[e]))return t.log("adapters.add: invalid (sub-)section"),this;if("function"!=typeof o)return t.log("adapters.add: invalid callback"),this;var i=this.adapters[e][n];return"object"==typeof i&&Array.isArray(i.callbacks)?(t.log("adapters.add: push callback for",e,n),i.callbacks.push(o),i.queueCalls&&i.queue.length>0&&i.queue.forEach(function(t){try{o.apply(this,t)}catch(t){console.warn("adapters.run: callback failed for",e+"."+n,"\n",t)}},this),this):(t.log("adapters.add: broken adapter object for",e,n),this)},o.has=function(e,t){return e in this.adapters&&t in this.adapters[e]&&"object"==typeof this.adapters[e][t]&&Array.isArray(this.adapters[e][t].callbacks)&&this.adapters[e][t].callbacks.length>0},o.run=function(e,t){var n=arguments?Array.prototype.slice.call(arguments,2):[];if(!(e in this.adapters)||!(t in this.adapters[e])||"object"!=typeof this.adapters[e][t])return!1;var o=this.adapters[e][t];return o.runOnce&&o.numRuns>0?(console.warn("adapters.run: one-time adapter called more than once for",e+"."+t,"\n"),!1):(o.numRuns+=1,o.queueCalls&&(o.queue.push(n),"number"==typeof o.queueLength&&o.queue.length>o.queueLength&&o.queue.shift()),o.callbacks.length>0&&(o.callbacks.forEach(function(o){try{o.apply(this,n)}catch(n){console.warn("adapters.run: callback failed for",e+"."+t,"\n",n)}},this),!0))},(e=new n).init(),e},fg_api.prototype.requestsModule=function(){var e,t=this;function n(){this.adapterSection="requests",this.legitActionIdentifiers=["startGame","pauseGameplay","resumeGameplay","enableAudio","enableMusic","disableAudio","disableMusic","changeVolume"]}var o=n.prototype;return o.init=function(){},o.isAction=function(t){return"string"==typeof t&&e.legitActionIdentifiers.indexOf(t)>-1},o.onRequest=function(n,o){t.adapters?e.isAction(n)?"function"==typeof o?t.adapters.add("request",n,o):console.warn("onRequest(): required param 'callback' has to be of type 'function'"):console.warn("onRequest(): required param 'action' has to be one of \""+e.legitActionIdentifiers.join('", "')+'"'):console.warn("onRequest(): adapters module required")},o.requestAction=function(n){t.adapters?e.isAction(n)?t.adapters.run.apply(t.adapters,["request"].concat(Array.from(arguments))):console.warn("requestAction(): required param 'action' has to be one of \""+e.legitActionIdentifiers.join('", "')+'"'):console.warn("onRequest(): adapters module required")},(e=new n).init(),e},fg_api.prototype.onRequest=function(e,t){this.requests?this.requests.onRequest(e,t):console.warn("onRequest(): requests module required")},fg_api.prototype.requestAction=function(){this.requests?this.requests.requestAction.apply(this,arguments):console.warn("onRequest(): requests module required")},fg_api.prototype.consentModule=function(){var e,t=this;function n(){this.cookieproScriptID="e63a91ad-15ec-4e2d-ae18-2a0b6143ecd8",t.debug&&(this.cookieproScriptID+="-test"),this.cookieproScriptURL="https://cookie-cdn.cookiepro.com/consent/[script_id]/otSDKStub.js",this.cmpLoaded=!1,this.hidePlatformUIRequested=!1}return n.prototype.init=function(){if(t.hasFeature("ads")&&"none"!=t.config.ads.provider)switch(t.config.cmp){case"cookiepro":case"default":e.initCookiePro()}},n.prototype.initCookiePro=function(){t.log("loading CookiePro script"),window.OptanonWrapper=window.OptanonWrapper||function(){t.log("CookiePro loaded"),e.cmpLoaded=!0,t.adapters&&(t.adapters.add("adEvent","loaded",e.hidePlatformUI),t.adapters.add("game","loaded",e.hidePlatformUI),t.adapters.run("consent","platformLoaded"))};document.getElementsByTagName("script")[0];var n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("charset","UTF-8"),n.setAttribute("data-domain-script",e.cookieproScriptID),n.src=e.cookieproScriptURL.replace("[script_id]",e.cookieproScriptID)},n.prototype.hidePlatformUI=function(){e.hidePlatformUIRequested||(e.hidePlatformUIRequested=!0,faZepto("#ot-sdk-btn-floating.ot-floating-button").css({display:"none"}))},n.prototype.isPlatformLoaded=function(){return e.cmpLoaded},(e=new n).init(),e},faZepto.fn.preventClick=function(){return this.each(function(){faZepto(this).on("click touchstart touchmove touchcancel touchend",function(e){return e.stopPropagation(),!1})}),this},fg_api.prototype.hasFeature=function(e){return e in this.config.features&&!!this.config.features[e]},fg_api.prototype.getFeatureProperties=function(e){return this.hasFeature(e)&&"object"==typeof this.config.features[e]?this.config.features[e]:{}},fg_api.prototype.createElement=function(e,t){var n=document.createElement(e);for(var o in t)t.hasOwnProperty(o)&&n.setAttribute(o,t[o]);return n},fg_api.prototype.eventTrap=function(e){e.preventDefault(),e.cancelBubble=!0,e.stopPropagation()},fg_api.prototype.handleClick=function(e,t){var n=function(e){return t.call(this,e),e.cancelBubble=!0,e.stopPropagation(),!1};return"function"==typeof t&&(window.navigator.msPointerEnabled?e.addEventListener("MSPointerDown",n,!1):window.PointerEvent?(e.addEventListener("pointerup",n,!1),e.addEventListener("pointermove",this.eventTrap,!0),e.addEventListener("pointerdown",this.eventTrap,!0)):detection.is.touch?(e.addEventListener("touchend",n,!1),e.addEventListener("touchmove",this.eventTrap,!0),e.addEventListener("touchstart",this.eventTrap,!0)):e.addEventListener("click",n,!1),e.style.cursor="pointer"),n},fg_api.prototype.removeClick=function(e,t){return"function"==typeof t&&(window.navigator.msPointerEnabled?e.removeEventListener("MSPointerDown",t,!1):window.PointerEvent?(e.removeEventListener("pointerup",t,!1),e.removeEventListener("pointermove",this.eventTrap,!0),e.removeEventListener("pointerdown",this.eventTrap,!0)):detection.is.touch?(e.removeEventListener("touchend",t,!1),e.removeEventListener("touchmove",this.eventTrap,!0),e.removeEventListener("touchstart",this.eventTrap,!0)):e.removeEventListener("click",t,!1)),e},fg_api.prototype.getUrlParams=function(e,t,n){e=/[?&]?([^=]+)=([^&]*)/g,t=document.location&&document.location.search?document.location.search.split("+").join(" "):"";for(var o={};n=e.exec(t);)o[decodeURIComponent(n[1])]=decodeURIComponent(n[2]);return o},fg_api.prototype.str=function(e){var t="";function n(e){return String.fromCharCode(e)}for(var o=0;o<e.length;o++)t+=n(Number(e[o]));return t},fg_api.prototype.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},window.console||(window.console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){}}),fg_api.prototype.sizeOf=function(e){var t,n=0;if(!e)return n;if(void 0!==e.length)return e.length;if(Object.keys)n=Object.keys(e).length;else for(t in e)e.hasOwnProperty(t)&&n++;return n},"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return 0===this.indexOf(e)}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e){return this.indexOf(e)==this.length-e.length}),fg_api.prototype.rand=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},fg_api.prototype.now=function(){return 1*new Date},fg_api.prototype.shuffleArray=function(e){for(var t,n,o=e.length;o>0;)t=Math.floor(Math.random()*o),n=e[o-=1],e[o]=e[t],e[t]=n;return e},fg_api.prototype.round=function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n},fg_api.prototype.find=function(e,t){var n="";if("object"==typeof e){for(n in e)if(e[n]===t)return n}else if(void 0!==e&&"function"==typeof e.indexOf)return e.indexOf(t);return-1},fg_api.prototype.wait=function(e){return new Promise(function(t){setTimeout(t,e)})},fg_api.prototype.vibrate=function(e){return void 0===e&&(e=20),!!navigator.vibrate&&navigator.vibrate(e)},fg_api.prototype.countdown=function(e,t,n,o){"function"!=typeof t&&(t=function(){}),"string"!=typeof n&&(n="data-cn"),"function"!=typeof o&&(o=this.seconds2time),faZepto(e).each(function(){var e=faZepto(this),i=setInterval(function(){var r=e.attr(n)-1;if(e.attr(n,r),e.text(o.apply(this,[r])),!r)return t(),clearInterval(i)},1e3)})},fg_api.prototype.seconds2time=function(e){var t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),o=Math.floor(e-3600*t-60*n),i="";return i+=(t=t>0?t<10?"0"+t:String(t):"00")+":",i+=(n=n>0?n<10?"0"+n:String(n):"00")+":",i+=o>0?o<10?"0"+o:String(o):"00"},void 0===Number.prototype.toLocaleString&&(Number.prototype.toLocaleString=function(){return""+this.valueOf()}),Object.entries=Object.entries?Object.entries:function(e){var t=Object.prototype.toString.call(e);if(null==e)throw new TypeError("Cannot convert undefined or null to object");if(~["[object String]","[object Object]","[object Array]","[object Function]"].indexOf(t)){if(Object.keys)return Object.keys(e).map(function(t){return[t,e[t]]});var n=[];for(var o in e)e.hasOwnProperty(o)&&n.push([o,e[o]]);return"[object Array]"===t?n:n.sort(function(e,t){return e[1]-t[1]})}return[]},Object.values=Object.values?Object.values:function(e){var t=Object.prototype.toString.call(e);if(null==e)throw new TypeError("Cannot convert undefined or null to object");if(~["[object String]","[object Object]","[object Array]","[object Function]"].indexOf(t)){if(Object.keys)return Object.keys(e).map(function(t){return e[t]});var n=[];for(var o in e)e.hasOwnProperty(o)&&n.push(e[o]);return n}return[]},Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=n.length;return function(i){if("object"!=typeof i&&("function"!=typeof i||null===i))throw new TypeError("Object.keys called on non-object");var r,a,s=[];for(r in i)e.call(i,r)&&s.push(r);if(t)for(a=0;a<o;a++)e.call(i,n[a])&&s.push(n[a]);return s}}()),fg_api.prototype.getMoreGamesButtonImage=function(e){var t=this.__("more_games_image")||"";return(e||-1===window.location.hostname.indexOf("cdn.famobi.com")&&-1===window.location.hostname.indexOf("dev.famobi.com"))&&(t=this.__("more_games_image_prefix")+t),t},fg_api.prototype.getBrandingButtonImage=function(e){return this.getMoreGamesButtonImage(e)},fg_api.prototype.getAbsolutePath=function(e){var t=document.location.protocol+"//"+document.location.pathname;return"file:"!==document.location.protocol?e:(e.startsWith("/")&&(e=e.substr(1)),t.substr(0,t.lastIndexOf("/")+1)+e)},fg_api.prototype.socketModule=function(){var e;function t(){this.socket=void 0,this._onConnectCallback=void 0}return t.prototype.init=function(){var e,t,n,o,i;e=document,t="script",n="socket-io",i=e.getElementsByTagName(t)[0],e.getElementById(n)||((o=e.createElement(t)).id=n,o.src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js",i.parentNode.insertBefore(o,i))},t.prototype.connect=function(t,n,o,i){console.log("connecting to socket...");let r={...o,hasBots:!1,botDifficulty:1,mission:{},assetId:o.assetId+famobi_gameID};e.socket=io(t,{query:{sessionId:i,isGameInstance:!0,player:JSON.stringify(n),config:JSON.stringify(r)}}),e.socket.on("connect",()=>{console.log("... connection established!",t,i?"Connecting normally":"Connecting to the lobby",n),e._onConnectCallback&&e._onConnectCallback()})},t.prototype.onConnect=function(t){e._onConnectCallback=t},t.prototype.emit=function(t,n){e.socket&&e.socket.emit(t,n)},t.prototype.on=function(t,n){e.socket&&e.socket.on(t,n)},(e=new t).init(),e},fg_api.prototype.storageModule=function(e){var t,n=this;function o(){}function i(e,t){return void 0===t&&(t=window.famobi_gameID),t.length&&(e=t+":"+e),e}return o.prototype.init=function(e){this.receivingData=!1,this.localStorage={},this.sessionStorage={},this.storage={},this.length=0,"localStorage"!=e&&"sessionStorage"!=e||(t.setStorageType(e),t.createStorage(e))},o.prototype.setStorageType=function(e){t.storageType=e},o.prototype.getStorageType=function(){return t.storageType},o.prototype.createStorage=function(e){!function(e){var t;try{return(t=window[e]).setItem("test",1),t.removeItem("test"),!0}catch(e){return!1}}(e)?t.storage={data:{},getItem:function(e,t){return e=i(e,t),this.data[e]},setItem:function(e,t,n){e=i(e,n),this.data[e]=t,this.updateLength()},removeItem:function(e,t){e=i(e,t);try{delete this.data[e]}catch(e){}this.updateLength()},clear:function(){for(var e in this.data)0===e.indexOf(window.famobi_gameID)&&this.removeItem(e,"")},key:function(e){var t=[];for(var n in this.data)0===n.indexOf(window.famobi_gameID)&&t.push(n);return void 0===t[e]?null:t[e]},updateLength:function(){t.length=n.sizeOf(this.data)},getKeys:function(){var e=[];for(var t in this.data)e.push(t);return e}}:t.storage=function(e){return{data:{},getItem:function(t,n){return t=i(t,n),window[e].getItem(t)},getProxyItem:function(e,t){return e=i(e,t),this.data[e]},setItem:function(t,n,o){t=i(t,o),this.data[t]=n,this.updateLength(),window[e].setItem(t,n)},removeItem:function(t,n){t=i(t,n);try{delete this.data[t]}catch(e){}this.updateLength(),window[e].removeItem(t)},clear:function(){for(var t in window[e])0===t.indexOf(window.famobi_gameID)&&this.removeItem(t,"")},key:function(t){var n=[];for(var o in window[e])0===o.indexOf(window.famobi_gameID)&&n.push(o);return void 0===n[t]?null:n[t]},updateLength:function(){t.length=n.sizeOf(this.data)},getKeys:function(){var t=[];for(var n in window[e])0===n.indexOf(window.famobi_gameID)&&t.push(n);return t}}}(e)},o.prototype.getStorage=function(){return t.storage},o.prototype.getItem=function(e,n){return t.getStorage().getItem(e,n)},o.prototype.setItem=function(e,n,o){return t.getStorage().setItem(e,n,o)},o.prototype.removeItem=function(e,o){return window.top!=window.self&&window.top.postMessage({scope:"famobi_sdk",method:"removeItem",package_id:window.famobi_gameID,aid:n.config.aid,data:{key:i(e,o)}},"*"),t.getStorage().removeItem(e,o)},o.prototype.clear=function(){return t.getStorage().clear()},o.prototype.key=function(e){return t.getStorage().key(e)},o.prototype.getKeys=function(){return t.getStorage().getKeys()},(t=new o).init(e),t},fg_api.prototype.highscoresModule=function(){var e,t=this;function n(){this.max=null,this.livescore=null}return n.prototype.init=function(){},n.prototype.getMaxScore=function(){return this.max},n.prototype.setMaxScore=function(e){this.max=Math.max(this.max,e)},n.prototype.setLiveScore=function(e){this.livescore=e},n.prototype.submitLiveScore=function(e){return e=Number(e),t},n.prototype.submit=function(n,o,i){if(n=void 0!==n&&(n.length||n>0)?n:"0",o=Number(o),i="function"!=typeof i?function(){}:i,!t.hasFeature("highscores"))return t.showAd(i),t;return t.showAd(function(){return i(),t.adapters.run("highscore","submit",n,o)?t:"undefined"==typeof html5games_api||"TOTAL"!==n||"A-MONKEY"!==t.config.aid&&"A-MONKEY-DEV"!==t.config.aid&&"A-NLYWA"!==t.config.aid?void 0:(e.setMaxScore(Math.max(e.getMaxScore(),o)),Promise.race([t.wait(3e3),html5games_api.submitScore({score:o})]).then(function(i){i&&(i.added<0||(i.ttl=Math.max(0,Number(i.ttl)),i.scores.length&&function(i){t.notify.create(i);var r=i.scores.pop()||[];r.name=r.name||"Guest",r.ranks=r.ranks?r.ranks.toLocaleString():1;var a=t.createElement("div",{class:"fg-leaderboard"}),s=t.createElement("div",{class:"fg-leaderboard-lastroundwinner"}),l=t.createElement("div",{class:"fg-leaderboard-currentscore"}),c=t.createElement("div",{class:"fg-leaderboard-headline"}),d=t.createElement("div",{class:"fg-leaderboard-countdown"}),u=t.createElement("div",{class:"fg-leaderboard-countdown-holder"}),f=t.createElement("div",{class:"fg-leaderboard-editnick"}),p=t.createElement("table"),h="",g=null,m=t.createElement("div",{class:"fg-leaderboard-you hide"}),v="",y="",b="",w="",E=1;i.winner.name=i.winner.name||"Guest",i.winner.score=i.winner.score||0,i.winner.score&&(s.innerHTML="<h2>Winner yesterday</h2><strong>"+i.winner.name+" <small>"+i.winner.score.toLocaleString()+'</small><span class="profileImageHolder"></span></strong>',faZepto(s).find(".profileImageHolder").html(e.getProfileBarCode(i.winner.hash))),c.innerHTML="<h2>Leaderboard today</h2>",f.innerHTML='<h2>Change your nick:</h2><input type="text"> <a href="javascript:;" class="saveNick">Save</a> <a href="javascript:;" class="cancelEditNick">Cancel</a>',m.innerHTML='<div class="rank"></div><div class="profileImage"><div class="profileImageHolder"></div></div><div class="player"><em></em> <a href="javascript:;" class="editNick">Edit</a></div><div class="score"></div>',faZepto(m).addClass("rank_"+r.rank),faZepto(m).find(".editNick").attr("data-nick",r.name),faZepto(m).find(".rank").text("#"+r.rank),faZepto(m).find(".profileImage .profileImageHolder").html(e.getProfileBarCode(r.hash)),faZepto(m).find(".player em").text(r.name+("Guest"!==r.name?"":" (You)")),faZepto(m).find(".score").text("number"==typeof r.score?0===r.score?"-":r.score.toLocaleString():r.score),d.innerHTML=r.ranks+" Players  <span data-cn='"+i.ttl+"'>"+t.seconds2time(i.ttl)+"</span> left",t.countdown(faZepto(d).find("span"),function(){t.notify.close(),t.wait(1e3).then(function(){e.submit(n,0)})});var _="Your score: ";function C(){var e=faZepto(".fg-notify-scrollarea");if(e.length){var t=faZepto(".fg-leaderboard table tr.you"),n=e.offset().top,o=n+e.height();if(t.length>0){var i=t.offset().top;i+t.height()<n||i>o?faZepto(m).removeClass("hide"):faZepto(m).addClass("hide")}else faZepto(m).removeClass("hide")}}i.added>=0&&(_="New high score: ",faZepto(l).addClass("newHighscore")),0!==o&&(l.innerHTML=_+("number"==typeof o?o.toLocaleString():o)),i.scores.forEach(function(t){v="",y="",b="",w="rank_"+E,t.name=t.name||"Guest",void 0!==t.me&&(v=" you",y="Guest"!==t.name?"":" (You)",b=' <a href="javascript:;" class="editNick">Edit</a>'),(g=faZepto('<tr><td class="rank"></td><td class="profileImage"><div class="profileImageHolder"></div></td><td class="player"><em></em>'+b+'</td><td class="score"></td></tr>')).find(".editNick").attr("data-nick",t.name),g.find(".rank").text("#"+t.rank||"-/-"),g.find(".profileImage .profileImageHolder").html(e.getProfileBarCode(t.hash)),g.find(".player em").text(t.name+y),g.find(".score").text("number"==typeof t.score?0===t.score?"-":t.score.toLocaleString():t.score.toString()),h+='<tr class="'+w+v+'">'+g.html()+"</tr>",E++}),p.innerHTML=h,""!==s.innerHTML&&a.appendChild(s),a.appendChild(c),u.appendChild(d),a.appendChild(u),a.appendChild(l),a.appendChild(f),a.appendChild(m),a.appendChild(p),t.notify.setContent(a),faZepto(a).find("a.editNick").each(function(){t.handleClick(this,function(){var e=faZepto(this).attr("data-nick"),t=faZepto(".fg-leaderboard-editnick input");faZepto(".fg-notify").addClass("editNick"),t.val(e),t.get(0).select()})}),faZepto(a).find("a.cancelEditNick").each(function(){t.handleClick(this,function(){faZepto(".fg-notify").removeClass("editNick"),t.notify.setScrollAreaHeight()})}),faZepto(a).find("a.saveNick").each(function(){t.handleClick(this,function(){var o=faZepto(".fg-leaderboard-editnick input").val();null!=o&&(html5games_api.updateProfile({nick:o||"Anonymous"}),t.notify.close(),t.wait(1e3).then(function(){e.submit(n,0)}))})}),faZepto(".fg-notify-scrollarea").on("scroll",C),t.onorientationchange(C),C()}(i)))}).catch(function(e){t.log(e),t.spinner.hide()}),t)}),t},n.prototype.show=function(e){return t.hasFeature("highscores")&&t.adapters.run("highscore","show",e),t},n.prototype.getProfileBarCode=function(e){var t="";if(e)for(;e.length>=6;){var n=e.substr(0,6);e=e.substr(6),t+='<span style="background-color:#'+n+';"></span>'}return t},n.prototype.get=function(){return t.sessionStorage.getItem("famobi:score")},n.prototype.del=function(){t.sessionStorage.delItem("famobi:score")},n.prototype.submitHighscoreCallback=function(){e.del(),faZepto(t.rootElement).trigger("fg_api.submitHighscore")},(e=new n).init(),e},fg_api.prototype.submitHighscore=function(e,t){var n=this;return new Promise(function(o){if(n.hasFeature("highscores"))return n.highscores.submit(e,t,o);o()})},fg_api.prototype.showHighscore=function(){this.highscores.show()},fg_api.prototype.getHighscore=function(){return this.highscores.get()},fg_api.prototype.submitHighscoreCallback=function(){this.highscores.submitHighscoreCallback()},fg_api.prototype.setLiveScore=function(){},fg_api.prototype.screenshotModule=function(){var e,t=this;function n(){this.clipClicked=!1,this.options={width:480,height:640},this.savingTryoutsNum=5,this.savingTryoutsInterval=3e3,this.savingLocked=!1,this.savingInterval=null,this.releaseSavingTimeout=null,this.releaseTimeout=2e4}function o(e){if(t.config.gameParams.screenshot[e])return t.config.gameParams.screenshot[e]}function i(){t.modal.close()}function r(n){return!e.savingLocked&&(e.fgSaveScreenshot.classList.add("fg-screenshot-btn-loading"),e.savingLocked=!0,faZepto.ajax({type:"POST",url:t.config.urlRoot+"/services/upload/images",data:{reference_id:t.config.uuid,pingback:"services/upload",file:n,type:"screenshot"},dataType:"json",success:function(e){a({url:e.data.public,txid:e.data.reference.id})}}),t)}function a(n){var o,i=0;if(!n.url||!n.txid)return!1;function r(o){clearInterval(e.savingInterval),clearTimeout(e.releaseSavingTimeout),e.savingLocked=!1,o?(t.modal.close(),e.fgSaveScreenshot.classList.add("fg-screenshot-btn-loading-complete"),t.showAd(function(){t.adapters.run("screenshot","submit",n.url,{width:e.options.width,height:e.options.height})})):(t.modal.shake(),e.fgSaveScreenshot.classList.add("fg-screenshot-btn-loading-fail"),setTimeout(function(){e.fgSaveScreenshot.classList.remove("fg-screenshot-btn-loading-fail"),e.fgSaveScreenshot.classList.remove("fg-screenshot-btn-loading")},1500))}e.txid=n.txid,(o=new Image).src=n.url,o.onload=function(){r(!0)},o.onerror=function(){++i>=e.savingTryoutsNum&&r(!1)}}function s(n,o){var i=function(n,o){var i=new Image;i.src=n.toDataURL("image/jpeg");var r=0,a=0,s={width:i.width/100*o.width,height:i.height/100*o.height,x:i.width/100*o.x,y:i.height/100*o.y};s.aspectRatio=s.width/s.height;var l=e.options.width/e.options.height;if(Math.floor(s.aspectRatio)!==Math.floor(l)){var c=e.options.height;e.options.height=e.options.width,e.options.width=c,l=e.options.width/e.options.height}function d(){r=e.options.height,a=e.options.height*s.aspectRatio}function u(){a=e.options.width,r=e.options.width/s.aspectRatio}s.aspectRatio>1?d():u(),a>e.options.width&&u(),r>e.options.height&&d();var f=(e.options.width-a)/2,p=(e.options.height-r)/2;return{element:i,slicing:s,positionX:parseInt(f),positionY:parseInt(p),targetWidth:parseInt(a),targetHeight:parseInt(r),createTemporaryCanvas:function(){return t.createElement("canvas",{width:e.options.width,height:e.options.height})}}}(n,o),r=i.createTemporaryCanvas(),a=function(e){return e.getContext("2d")}(r);return a.drawImage(i.element,i.slicing.x,i.slicing.y,i.slicing.width,i.slicing.height,i.positionX,i.positionY,i.targetWidth,i.targetHeight),i=null,r=null,a=null,n.toDataURL("image/jpeg",.7)}function l(n){if(t.clipClicked)return!1;if(t.clipClicked=!0,e.txid=null,o("areas")&&(n=n&&o("areas")[n]?o("areas")[n]:o("areas").default?o("areas").default:null),!n)throw Error("No areas defined");var a;!function(n){t.modal.create({showCloseBtn:!1,transparent:!0});var o=t.createElement("div",{class:"fg-screenshot"});e.fgSaveScreenshot=t.createElement("a",{class:"fg-screenshot-btn-upload"}),e.fgSaveScreenshot.innerHTML='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="512px" height="512px" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><polygon id="check-mark-icon" points="398.218,92.985 199.729,291.475 113.754,205.476 50,269.242 199.733,419.015 462,156.726 "/></svg>',t.handleClick(e.fgSaveScreenshot,function(){r(n)}),o.appendChild(e.fgSaveScreenshot);var a=t.createElement("a",{class:"fg-screenshot-btn-discard"});a.innerHTML='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="512px" height="512px" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><polygon id="x-mark-icon" points="438.393,374.595 319.757,255.977 438.378,137.348 374.595,73.607 255.995,192.225 137.375,73.622 73.607,137.352 192.246,255.983 73.622,374.625 137.352,438.393 256.002,319.734 374.652,438.378 "/></svg>',t.handleClick(a,i),o.appendChild(a);var s=t.createElement("img",{src:n});o.appendChild(s),t.modal.setContent(faZepto(o).get(0)),t.modal.setDimensions(e.options.width,e.options.height),t.modal.setCloseCallback(function(){t.clipClicked=!1})}(s((a=e.canvasID)?document.getElementById(a):document.getElementsByTagName("canvas")[0],n))}return n.prototype.init=function(){if(t.hasFeature("screenshot")){if(!t.config.gameParams.screenshot||!t.config.gameParams.screenshot.active||!t.sizeOf(t.config.gameParams.screenshot.areas))return!1;t.iframe.subscribePostMessageListener("screenshot","handleScreenshotSave",a),function(){var e=t.createElement("div",{id:"fg-fotoshoot-overlay"});if(t.config.gameParams.screenshot&&t.config.gameParams.screenshot.camera){e.style.top="auto",e.style.right="auto";var n=t.config.gameParams.screenshot.camera;for(var o in n.position)if(n.position[o]){var i=n.position[o];switch(i){case"top":case"bottom":e.style[i]=n.y+"%";break;case"right":case"left":e.style[i]=n.x+"%"}}}e.innerHTML='<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="30px" height="30px" viewBox="0 0 64 64" enable-background="new 0 0 64 64" xml:space="preserve"><g id="CAMERA_1_" enable-background="new    "><g id="CAMERA"><g><path d="M32,22c-6.627,0-12,5.372-12,12c0,6.627,5.373,12,12,12s12-5.373,12-12S38.627,22,32,22z M61,12H48.243l-5.095-5.094l-0.002,0.003C42.602,6.35,41.843,6,41,6H23c-0.976,0-1.835,0.474-2.383,1.196L15.813,12H3c-1.657,0-3,1.343-3,3v40c0,1.657,1.343,3,3,3h58c1.657,0,3-1.343,3-3V15C64,13.343,62.657,12,61,12z M32,52c-9.941,0-18-8.059-18-18c0-9.941,8.059-18,18-18c9.941,0,18,8.059,18,18C50,43.941,41.941,52,32,52z"/></g></g></g></svg>',t.rootElement.appendChild(e),t.handleClick(e,l)}()}},(e=new n).init(),e},fg_api.prototype.navigationModule=function(){var e,t=this;function n(){this.eventHandler=function(){}}return n.prototype.init=function(){if(t.fgNavigation=document.createElement("nav"),t.fgNavigation.style.position="relative",t.fgNavigation.setAttribute("id","fg-navigation"),faZepto(t.headElement).append(t.config.style),window.top!==window.self)return t;function n(n){return t.fgOverlay_visible?e.hideAll():e.show(),n.stopPropagation(),!1}return t.fgOverlay.innerHTML=t.config.headerHtml,t.fgOverlay.appendChild(t.fgNavigation),t.fgOverlay_visible=!1,t.fgHeader=document.getElementById("fg-header"),faZepto("#fg-clip, #fg-logo").each(function(){t.handleClick(this,n)}),(detection.is.android||detection.is.ios)&&faZepto(t.fgOverlay).addClass("isMobile"),t.hasFeature("menu")&&e.setHtml(t.config.menuHtml),t},n.prototype.bindEvents=function(){faZepto("[data-switch-lang]").each(function(){var n=faZepto(this),o=faZepto(this).attr("data-switch-lang");n.removeClass("fg-lang-selected"),o===t.gametranslation.curLangString&&(n.closest("ul").prepend(n),n.addClass("fg-lang-selected")),t.handleClick(this,function(){!0===n.hasClass("fg-lang-selected")?e.toggleLanguages():o.length&&e.switchLanguage(o)})}),faZepto("[data-famobi-href]").css("cursor","pointer").each(function(){t.handleClick(this,function(){var n=faZepto(this).attr("data-famobi-href");switch(e.hideAll(),n){case"moreGames":return t.moreGamesLink();case"back":return t.backLink();default:if(this.href)return window.open(this.href,""),!1}}.bind(this))}),faZepto("[data-famobi-fullscreen]").each(function(){t.handleClick(this,e.switchFullscreen)}),faZepto("[data-famobi-screenshot]").each(function(){t.handleClick(this,e.takeScreenshot)})},n.prototype.toggleLanguages=function(){var e=faZepto(t.fgOverlay);e.hasClass("fa-lang-shown")?e.removeClass("fa-lang-shown"):e.addClass("fa-lang-shown")},n.prototype.switchLanguage=function(n){var o,i=t.getUrlParams();e.hideAll(),i.locale=n,o=faZepto.param(i),document.location.replace(document.location.pathname+"?"+o+(document.location.hash?document.location.hash:""))},n.prototype.switchFullscreen=function(){return e.hideAll(),t.fullscreen.toggle(),!0},n.prototype.takeScreenshot=function(){t.screenshot.shoot()},n.prototype.show=function(){if(t.fgOverlay_visible)return t;var n=faZepto("#fg-overlay .fa-menu-button-fullscreen");return e.hideAll(),e.eventHandler=t.handleClick(faZepto("html").get(0),e.hideAll),faZepto("html").get(0).style.cursor="pointer",document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?n.removeClass("fa-fullscreen-disabled").addClass("fa-fullscreen-enabled"):n.removeClass("fa-fullscreen-enabled").addClass("fa-fullscreen-disabled"),t.fgOverlay_visible=!0,faZepto(t.fgOverlay).addClass("navigation-view"),t.fgNavigation.style.display="",t},n.prototype.hide=function(){return e.hideAll()},n.prototype.hideAll=function(){return t.fgOverlay_visible?(e.eventHandler&&t.removeClick(faZepto("html").get(0),e.eventHandler),faZepto(t.fgOverlay).removeClass("iframe-view navigation-view fa-lang-shown"),t.fgOverlay_visible=!1,t):t},n.prototype.invisible=function(){t.fgOverlay.style.display="none"},n.prototype.visible=function(){t.fgOverlay.style.display=""},n.prototype.getMoreGamesLink=function(){return t.debug?t.__("more_games_url"):"javascript:void(0);"},n.prototype._moreGamesLink=function(n){if(!t.debug)return!1;var o=e.getMoreGamesLink();if(!o||"http://"==o||"javascript:"==o)return!1;if(faZepto("#fg-root .fg-ad-container").height()>0||faZepto("#fg-root .fg-click2play").height()>0)return!1;if("undefined"!=typeof gremlins)return!1;if(void 0===n&&(n=!1),!n||!window.open(o,""))try{window.top.location.href=o}catch(e){window.location.href=o}return!0},n.prototype.moreGamesLink=function(t){return e._moreGamesLink(t)},n.prototype.setHtml=function(n){t.fgNavigation.innerHTML=n,e.bindEvents(),t.gametranslation.translateHtml(faZepto(t.fgNavigation))},n.prototype.getAlsoLikedApps=function(){},(e=new n).init(),e},fg_api.prototype.backLink=function(){if(history.length>2)window.history.go(-2);else{if(window.opener)try{window.close()}catch(e){}this.moreGamesLink(!1)}return!1},fg_api.prototype.moreGamesLink=function(e){return this.navigation.moreGamesLink(e)},fg_api.prototype.openBrandingLink=function(e){return this.navigation.moreGamesLink(e)},fg_api.prototype.getShortLink=function(){return this.config.short_url},fg_api.prototype.getAppLink=function(){return"https://play.famobi.com/"+window.famobi_gameID+".app/"+this.config.aid},fg_api.prototype.spinnerModule=function(){var e,t=this;function n(){this.spinner="",this.timeout=15e3,this.fadeoutTime=500,this.maxTimeout=null,this.stateTimeout=null}var o=n.prototype;return o.init=function(){e.spinner=t.createElement("div",{class:"fg-spinner"}),e.spinner.innerHTML='<div id="cssload-pgloading"><div class="cssload-loadingwrap"><ul class="cssload-bokeh"><li></li><li></li><li></li><li></li></ul></div></div>',t.rootElement.appendChild(e.spinner),faZepto(e.spinner).css({display:"none",visibility:"visible"}),e.spinnerOutline=t.createElement("div",{class:"fg-spinner-outline"}),e.spinnerOutline.innerHTML="<div></div>",t.rootElement.appendChild(e.spinnerOutline);var n=Math.round(e.fadeoutTime/10)/100+"s";return faZepto(e.spinnerOutline).css({position:"absolute",display:"none",visibility:"hidden",top:"0",left:"0",right:"0",bottom:"0",background:"rgba(0,0,0,0.8)","transition-property":"opacity","transition-duration":n,"transition-delay":"0s"}),this},o.show=function(n){return e.spinnerState="new",e.spinner.style.display="block",e.spinnerOutline.style.display="block",t.wait(33).then(function(){e.spinner.style.visibility="visible",e.spinnerOutline.style.visibility="visible",e.spinner.style.left="50%",e.spinner.style.opacity="1.0",e.spinnerOutline.style.opacity="1.0",e.timeout=n||15e3,e.stateTimeout=setTimeout(function(){"tryhide"==e.spinnerState?(e.spinnerState="closeable",e.hide()):e.spinnerState="closeable"},250),e.maxTimeout=setTimeout(function(){e.hide()},e.timeout)}),this},o.hide=function(){return e.spinnerState&&"closeable"==e.spinnerState?(t.log("set spinner opacity to 0 @",Date.now()),e.spinner.style.opacity="0",e.spinnerOutline.style.opacity="0",setTimeout(function(){t.log("set spinner display none @",Date.now()),e.spinner.style.display="none",e.spinnerOutline.style.display="none",e.spinner.style.visibility="hidden",e.spinnerOutline.style.visibility="hidden"},e.fadeoutTime),clearTimeout(e.maxTimeout),clearTimeout(e.stateTimeout)):e.spinnerState="tryhide",this},(e=new n).init(),e},fg_api.prototype.showSpinner=function(e){this.spinner.show(e)},fg_api.prototype.hideSpinner=function(){this.spinner.hide()},fg_api.prototype.modalModule=function(){var e,t=this;function n(){this.element="",this.closing=!1,this.closeCallbacks=[]}return n.prototype.init=function(){t.iframe.subscribePostMessageListener("modal","showModalCloseBtn",function(){e.showCloseBtn()}).subscribePostMessageListener("modal","setModalHeader",function(t){e.setHeader(t.title)}).subscribePostMessageListener("modal","close",function(){e.close()}).subscribePostMessageListener("modal","setModalCloseBtnTimer",function(n){t.spinner.hide(),e.setCloseBtnTimer(n.sec,n.options)})},n.prototype.create=function(n){var o=faZepto.extend({overlayColor:null,overlayStyle:{},showCloseBtn:!0,title:""},n);e.closing||e.close(),t.navigation.invisible(),t.game.pause();var i="";o.mode&&(i=o.mode+"-mode"),e.element&&e.element.parentNode&&e.element.parentNode.removeChild(e.element),e.element=t.createElement("div",{class:"fg-modal fg-fade fg-show "+i}),e.overlay&&e.overlay.parentNode&&e.overlay.parentNode.removeChild(e.overlay),e.overlay=t.createElement("div",{class:"fg-modal-overlay"}),o.overlayColor&&(e.overlay.style.backgroundColor=o.overlayColor),o.overlayStyle&&faZepto(e.overlay).css(o.overlayStyle),t.rootElement.appendChild(e.overlay),e.header=t.createElement("header",{}),e.element.appendChild(e.header),e.body=t.createElement("div",{class:"fg-modal-body"}),e.element.appendChild(e.body),t.rootElement.appendChild(e.element),!1!==o.showCloseBtn&&e.showCloseBtn(),o.transparent&&e.body.classList.add("fg-modal-transparent"),o.title&&e.setHeader(o.title),e.closeCallbacks.push(function(){t.game.resume(),t.navigation.visible()})},n.prototype.showCloseBtn=function(){if(e.closeBtn=t.createElement("div",{class:"fg-modal-close icon-cancel"}),!e.element)return!1;e.element.appendChild(e.closeBtn),t.handleClick(e.closeBtn,function(){this.getAttribute("data-disable")||e.close()}),t.handleClick(e.overlay,function(){e.closeBtn.getAttribute("data-disable")||e.overlay.getAttribute("data-disable")||e.close()})},n.prototype.setCloseCallback=function(t){return e.element&&"none"!==e.element.style.display?(e.closeCallbacks.push(t),!0):(t(),!1)},n.prototype.updateCloseBtn=function(t){var n=e.closeBtnTimer?e.closeBtnTimer.current:0;t?e.fallbackTimeout=setTimeout(e.updateCloseBtn,5e3):e.fallbackTimeout&&clearTimeout(e.fallbackTimeout),e.closeBtn&&(n>0||t?(e.closeBtn.innerHTML='<span class="counter">'+n+"</span>"||"",e.closeBtn.setAttribute("data-disable","true")):(e.closeBtn.innerHTML="",e.closeBtn.removeAttribute("data-disable")))},n.prototype.setCloseBtnTimer=function(t,n){n||(n={}),e.clearCloseBtnTimer(),e.closeBtnTimer={autoclose:void 0===n.autoclose||n.autoclose,sec:t,current:(n.faketime||t)+1,timeout:0,options:n},e.closeBtnTicker()},n.prototype.clearCloseBtnTimer=function(){e.closeBtnTimer&&e.closeBtnTimer.timeout&&clearTimeout(e.closeBtnTimer.timeout)},n.prototype.closeBtnTicker=function(){var t=e.closeBtnTimer.options;e.closeBtnTimer.current=Math.max(--e.closeBtnTimer.current,0),0===e.closeBtnTimer.current&&e.closeBtnTimer.autoclose?e.close():e.updateCloseBtn();var n=parseInt(t.faketime||e.closeBtnTimer.sec,10);e.closeBtnTimer.timeout=setTimeout(e.closeBtnTicker,parseInt(e.closeBtnTimer.sec/n*1e3,10))},n.prototype.activateCloseBtn=function(t){if(!e.closeBtn)return!1;e.closeBtn.style.display=t?"block":"none",t?e.closeBtn.removeAttribute("data-disable"):e.closeBtn.setAttribute("data-disable","true")},n.prototype.activateCloseOverlay=function(t){if(!e.overlay)return!1;t?e.overlay.removeAttribute("data-disable"):e.overlay.setAttribute("data-disable","true")},n.prototype.setContent=function(t){t&&e.body.appendChild(t)},n.prototype.setHeader=function(t){t=t||"",e.header&&(e.header.innerHTML=t.length?t+"":"",e.header.style.display=t.length?"block":"none")},n.prototype.setDimensions=function(t,n){t&&""!==t||(t=480),n&&""!==n||(n=500),e.element.style.maxHeight=parseInt(n,10)+60+"px",e.element.style.maxWidth=parseInt(t,10)+20+"px",e.element.style.display=""},n.prototype.close=function(){return e.closing=!0,e.clearCloseBtnTimer(),!!e.element&&(e.element.style.display="none",!!e.overlay&&(e.overlay.style.display="none",faZepto.each(e.closeCallbacks,function(e,t){"function"==typeof t&&t()}),e.closeCallbacks=[],void(e.closing=!1)))},n.prototype.closeAd=function(){e.closing=!0,e.clearCloseBtnTimer(),faZepto.each(e.closeCallbacks,function(e,t){"function"==typeof t&&t()}),e.closeCallbacks=[],e.closing=!1},n.prototype.shake=function(t){e.element.classList.add("fg-modal-shake"),setTimeout(function(){e.element.classList.remove("fg-modal-shake"),"function"==typeof t&&t()},2e3)},n.prototype.shakeAndClose=function(){e.shake(e.close)},(e=new n).init(),e},fg_api.prototype.iframeModule=function(){var e,t=this,n={};function o(){}var i=o.prototype;function r(e){return!!function(e){return e.module&&n[e.module]&&e.action&&n[e.module][e.action]}(e)&&n[e.module][e.action](e.data||{})}function a(e){r(e.data)}return i.init=function(){window.addEventListener("message",a,!1)},i.subscribePostMessageListener=function(e,t,o){return n[e]||(n[e]={}),n[e][t]=o,i},i.create=function(){return t.iframeContainer=t.createElement("div",{id:"fg-iframe-container"}),t.iframeElement=t.createElement("iframe",{id:"fg-iframe",class:"fg-iframe",name:"fg-iframe",src:"",style:"background: transparent none;"}),t.iframeContainer.appendChild(t.iframeElement),t},i.updateSize=function(){return t.iframeElement&&(t.iframeElement.style.height="0px",t.iframeElement.style.height="100%"),t},i.load=function(e){t.comIframe=t.createElement("iframe",{id:"fg-com-iframe",name:"fg-com-iframe",src:e}),t.fgOverlay.appendChild(t.comIframe)},i.show=function(n,o){var i=faZepto.extend({width:"",height:""},o);return t.iframeContainer||e.create(),t.navigation.hideAll(),t.modal.create(o),n.length?(0===n.indexOf("/")&&(n=t.config.urlRoot+n),t.iframeElement.setAttribute("src",n),t.spinner.show(2e3),t.iframeElement.onload=function(){t.spinner.hide()}):t.log("url not set"),i.mode&&"seamless"==i.mode&&(t.iframeElement.setAttribute("seamless","seamless"),i.height="none"),i.mode&&"ad"==i.mode?t.iframeElement.setAttribute("scrolling","no"):t.iframeElement.setAttribute("scrolling","yes"),t.modal.setCloseCallback(function(){t.iframeElement&&t.iframeElement.setAttribute("src","")}),t.modal.setContent(t.iframeContainer),t.modal.setDimensions(i.width,i.height),t},i.hide=function(){return faZepto(t.fgOverlay).css({"max-width":"","max-height":""}),t},(e=new o).init(),e},fg_api.prototype.orientationModule=function(){var e,t=this;function n(){}var o=n.prototype;return o.init=function(){return"vp"===window.famobi_env||e.update(t.config.gameParams.orientation),t},o.update=function(n){return void 0!==n&&t.hasFeature("rotation")&&!detection.is.pc&&!detection.is.tablet&&window.screen&&window.screen.height!==window.screen.width&&(t.rootElement.className=t.rootElement.className+" fg-orientation-"+n,void 0===e.fgLandscapeOverlay&&(e.fgLandscapeOverlay=document.createElement("div"),e.fgLandscapeOverlay.setAttribute("id","fg-landscape-overlay"),e.fgLandscapeImage=document.createElement("img"),e.fgLandscapeImage.setAttribute("src","/html5games/gameapi/v1/images/RotateToLandscape.png"),e.fgLandscapeImage.setAttribute("class","fg-orientation-icon"),e.fgLandscapeImage.setAttribute("alt","switch to landscape"),e.fgLandscapeOverlay.appendChild(e.fgLandscapeImage),t.rootElement.appendChild(e.fgLandscapeOverlay)),void 0===e.fgPortraitOverlay&&(e.fgPortraitOverlay=document.createElement("div"),e.fgPortraitOverlay.setAttribute("id","fg-portrait-overlay"),e.fgPortraitImage=document.createElement("img"),e.fgPortraitImage.setAttribute("src","/html5games/gameapi/v1/images/RotateToPortrait.png"),e.fgPortraitImage.setAttribute("class","fg-orientation-icon"),e.fgPortraitImage.setAttribute("alt","switch to portrait"),e.fgPortraitOverlay.appendChild(e.fgPortraitImage),t.rootElement.appendChild(e.fgPortraitOverlay))),t},o.lock=function(){var e="orientation-lock"in t.config.gameParams?t.config.gameParams["orientation-lock"]:t.config.gameParams.orientation;if("orientation"in screen){if(!detection.is.smartphone)return!0;try{switch(e){case"portrait":case"landscape":screen.orientation.lock(e+"-primary")}}catch(e){t.log(e)}}},o.unlock=function(){"orientation"in screen&&screen.orientation.unlock()},(e=new n).init().onorientationchange(function(){}),e},fg_api.prototype.getOrientation=function(){var e="";return window.innerHeight!=window.innerWidth&&(e=window.matchMedia("(orientation: portrait)").matches?"portrait":"landscape"),e},fg_api.prototype.onOrientationChange=fg_api.prototype.onorientationchange=function(e){return"function"!=typeof e&&this.error("famobi.onorientationchange: no valid callback provided."),faZepto(window).resize(e)},fg_api.prototype.getWindowSize=function(){return{w:window.innerWidth,h:window.innerHeight}},"undefined"==typeof window||window.famobi_tracking||function(e,t){var n={endpointUrl:"js/null.js?https://data.html5games.com/",game:"",uidStorageId:"trackingUid",uid:null,initializedUser:!1,debug:!1,version:0,queue:[],currentPromise:Promise.resolve(),runDry:!1},o={LEVEL_START:"event/level/start",LEVEL_END:"event/level/end",LEVEL_UPDATE:"event/level/update",PING:"event/ping",AD:"event/ad"};function i(){n.debug&&console.log.apply(this,arguments)}function r(e){var t=window.hasOwnProperty("famobi")?window.famobi.localStorage:window.localStorage,o=t.getItem(n.uidStorageId);if(null!=o&&"null"!==o&&"undefined"!==o){i("tracking init - user id retrieved from storage",o);return s("event/user/start",{locale:navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.userLanguage||navigator.language||navigator.browserLanguage||"en"}),Promise.resolve(o)}return n.runDry?Promise.resolve():(i("tracking init - no uid found in storage, requesting new user"),new Promise(function(o,r){var a,s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==this.readyState&&200==this.status){i("tracking init - response",this.response);var e=JSON.parse(this.response).data;e.splitTests;t.setItem(n.uidStorageId,e.uid),i("tracking initialized - new user id received",e.uid),o(e.uid)}},s.onerror=function(){i("xhttp error")},s.addEventListener("error",function(e){i("tracking init - failed",e),r()}),s.open("POST",n.endpointUrl+"event/user",!0),s.setRequestHeader("Content-type","application/json"),s.setRequestHeader("X-Version",n.version),s.setRequestHeader("X-Game",n.game),window.famobi.getUrlParams().original_ref&&s.setRequestHeader("X-Referrer",window.famobi.getUrlParams().original_ref),e&&("string"==typeof e&&e.length>0||"number"==typeof e&&e>0)?s.setRequestHeader("X-User",e):s.setRequestHeader("X-User",(a=(new Date).getTime(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==e?t:3&t|8).toString(16)})));var l={locale:navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.userLanguage||navigator.language||navigator.browserLanguage||"en"};(window.famobi.config.aid||"").length&&(l.aid=window.famobi.config.aid);const c=window.famobi.getUrlParams().campaign;void 0!==c&&(l.tag=c);try{s.send(JSON.stringify(l))}catch(e){i(e)}}))}function a(e){(i("adCallback event ",e),"rewarded"!=e.adType||1==e.rewardGranted)&&s("AD",{adType:e.adType,fill:e.adDidLoad,blocked:null==window.google})}function s(e,t){var r=e in o?o[e]:e;"string"==typeof r&&"object"==typeof t&&null!==t?(famobi.hasOwnProperty("adapters")&&famobi.adapters.run("tracking","trackEvent",r,t),i("queuing event",r,"with data",t),n.queue.push({eventPath:r,data:t}),n.initializedUser&&c()):i("tracking event cancelled - wrong/missing parameters","eventPath",r,"data",t)}function l(e,t){return i("tracking event",e,"with data",t),n.runDry?Promise.resolve():new Promise(function(o,r){var a=new XMLHttpRequest;a.onreadystatechange=function(){4==this.readyState&&o()},a.onerror=function(){i("xhttp error")},a.addEventListener("error",function(e){i("tracking send request failed -",e),r()}),setTimeout(r,1e4),a.open("POST",n.endpointUrl+e,!0),a.setRequestHeader("Content-type","application/json"),a.setRequestHeader("X-Game",n.game),a.setRequestHeader("X-Version",n.version),a.setRequestHeader("X-User",n.uid);try{a.send(JSON.stringify(t))}catch(e){i(e)}})}function c(){n.queue.forEach(function(e){n.currentPromise=n.currentPromise.then(function(){return l(e.eventPath,e.data)},function(){return l(e.eventPath,e.data)})}),n.queue=[]}t.famobi_tracking={EVENTS:o,trackEvent:s,init:function(e,t,o,s,l,d){s&&(n.debug=!0,i("tracking init called")),window.famobi.hasFeature("tracking")&&!0!==d||(n.runDry=!0),n.initializedUser?i("tracking init cancelled - already initialized"):"string"==typeof e&&e.length>0?(n.game=e,Number.isInteger(o)?n.version=o:i("tracking init - clientVersion rejected, has to be integer"),!1!==l&&window.hasOwnProperty("famobi")&&window.famobi.hasOwnProperty("adapters")&&window.famobi.adapters.add("ads","callback",a),r(t).then(function(e){n.uid=e,n.initializedUser=!0,c()})):i("tracking init - game rejected, has to be valid string")}}}(0,window),fg_api.prototype.trackingModule=function(){var e,t=this;function n(){this.promise=null,this.isHidden=!1,this.famobi_gameIDs={supported:["3d-basketball","3d-bowling","3d-chess","3d-darts","3d-free-kick","3d-free-kick-world-cup-18","7-words","8-ball-billiards-classic","8-ball-online","adventure-drivers","archery-world-tour","billiard-blitz-challenge","blaze-kick","blocks-puzzle-zoo","boat-battles","brain-trainer","bubble-tower-3d","bubble-woods","bus-parking-3d","candy-bubble","cannon-balls-3d","chess-classic","city-dunk","color-pixel-art-classic","color-shape","colorpop","crazy-caves","curve-ball-3d","diamond-rush","dices-2048-3d","dominoes-classic","drift-cup-racing","drift-dudes","duo-cards","element-blocks","endless-truck","euro-penalty-2016","euro-penalty-cup","euro-penalty-cup-2021","find-500-differences","foot-chinko","frankenstein-go","freecell-solitaire-classic","fuzzies","garden-bloom","garden-match-3d","giant-2048","gold-mine","gold-miner-tom","hoop-royale","jigsaw-puzzle-deluxe","jungle-run","knife-rain","lovetester3","mahjong-3d","mahjong-classic","mahjong-world","mandala-coloring-book","maze","merge-jewels","monkey-bounce","om-nom-bubbles","om-nom-connect-classic","om-nom-run","onet-connect-classic","onet-gallery-3d","onet-world","perfect-piano","pets-rush","pirates-the-match-3","pop-it-3d","pull-pins","slice-rush","smarty-bubbles","smarty-bubbles-2","soccer-bubbles","soccertastic","soccertastic-world-cup-18","solitaire-classic","solitaire-klondike","square-stacker","stack-smash","sudoku-classic","sushi-roll","table-tennis-world-tour","tnt-bomb","totemia-cursed-marbles","tower-crash-3d","traffic-tom","train-2048","truck-trials","word-bird","word-detector","word-search-classic","world-cup-penalty-2018","zoo-boom"],blocked:[],mapping:{"bubble-tower-3d":"bubbles-tower-3d",lovetester3:"lovetester","tower-crash-3d":"tower-crash","cannon-balls-3d":"cannon-balls","blocks-puzzle-zoo":"blocks-puzzle"}}}return n.prototype.init=function(){window.famobi_dataLayer=window.famobi_dataLayer||window.dataLayer||[],window.famobi_dataLayer.push({event:"trackingInit",packageId:window.famobi_gameID,affiliateId:t.config.aid,section:"ingame",originalReferrer:t.config.referrer_origin||"unknown",iframe:detection.is.iframe?"detected":"none",dfpAvailable:t.config.ads.dfp_available?"true":"false",referrerMatched:t.config.referrer_matched?"true":"false"}),e.initializeFamobiTracking()},n.prototype.initializeFamobiTracking=function(){return e.promise||(e.promise=new Promise(function(n,o){if(t.hasFeature("standalone")||e.famobi_gameIDs.blocked.includes(window.famobi_gameID))o("Famobi Tracking is not supported");else if(document.addEventListener("visibilitychange",s,!1),document.addEventListener("mozvisibilitychange",s,!1),document.addEventListener("webkitvisibilitychange",s,!1),document.addEventListener("msvisibilitychange",s,!1),void 0!==window.famobi_tracking){var i=!1,r=!1,a=t.getUrlParams();t.hasFeature("tracking")&&e.famobi_gameIDs.supported.includes(window.famobi_gameID)||(r=!0),!a.fg_env||"dev"!=a.fg_env&&"staging"!=a.fg_env||(i=!0);try{window.famobi_tracking.init(e.famobi_gameIDs.mapping[window.famobi_gameID]||window.famobi_gameID,null,0,i,!0,r)}catch(e){famobi.log(e)}setInterval(function(){try{setTimeout(function(){e.isHidden?i&&famobi.log("hidden: famobi_tracking.EVENTS.PING skipped!"):window.famobi_tracking.trackEvent(window.famobi_tracking.EVENTS.PING,{})},1e3*Math.floor(60*Math.random()))}catch(e){famobi.log(e)}},6e4);n()}else o("Famobi Tracking not ready");function s(){document.hidden||document.mozHidden||document.webkitHidden||document.msHidden?e.isHidden=!0:e.isHidden=!1}})),e.promise},n.prototype.data=function(e){window.famobi_dataLayer.push(e)},n.prototype.trackEvent=function(){},n.prototype.trackPassiveEvent=function(){return e.trackEvent()},(e=new n).init(),e},function(e,t){var n={stats:{},events:[],currentScreen:"",pageTitle:"",trackStats:function(e,t,o){return new Promise(function(i,r){var a={},s={};"string"==typeof e&&(s[e]=t);if(!function(){for(var t in s){if(!("string"==typeof e&&e.length&&e.length<=42&&e.match(/^[a-z_0-9]+$/)))return console.warn("trackStats(): key '"+e+"' contains not only lowercase letters, numbers and underscore ([a-z_0-9]), maximum length: 42 characters"),!1}return!0}())return r("trackStats(): invalid params "+JSON.stringify(e,t)),!1;var l=function(e,t){if("string"==typeof e&&e.length)return e in n.stats&&null==t?delete n.stats[e]:void 0!==t&&t&&(n.stats[e]=t),!0;throw"trackStats(): key is not a string or an Object"};if(e&&"object"==typeof e){for(var c in e)l(c,t=e[c]);a=e}else l(e,t),a[e]=t;famobi.hasOwnProperty("adapters")&&famobi.adapters.run("analytics","trackStats",e,t,o),i(a)})},getStats:function(){return new Promise(function(e){e(n.stats)})},trackEvent:function(e,t){return new Promise(function(o,i){if(void 0===n[e])return i("trackEvent(): unknown event '"+e+"'"),!1;if("object"!=typeof(t=t||{})&&null!==t)return i("trackEvent(): second parameter needs to be an object"),!1;return function(){var n={levelName:"",reason:["timeout","dead","wrong_answer","quit","draw"],levelScore:-0,liveScore:-0,totalScore:-0,bgmVolume:0,sfxVolume:0},o={EVENT_LEVELFAIL:["levelName","reason"],EVENT_LEVELRESTART:["levelName"],EVENT_LEVELSTART:["levelName"],EVENT_LEVELSUCCESS:["levelName"],EVENT_LEVELSCORE:["levelName","levelScore"],EVENT_LIVESCORE:["liveScore"],EVENT_TOTALSCORE:["totalScore"],EVENT_VOLUMECHANGE:["bgmVolume","sfxVolume"],EVENT_CUSTOM:[]};if(void 0!==o[e]&&0===Object.keys(t).length)return console.warn("trackEvent(): '"+e+"' requires at least one parameter"),!1;if(void 0===o[e])return!0;for(var i=0,r="",a=null;i<o[e].length;i++){if("string"==typeof(a=n[r=o[e][i]])&&"string"!=typeof t[r])return console.warn("trackEvent(): required param '"+r+"' has to be of type string"),!1;if("number"==typeof a&&"number"!=typeof t[r])return console.warn("trackEvent(): required param '"+r+"' has to be of type number"),!1;if("object"==typeof a&&-1===a.indexOf(t[r]))return console.warn("trackEvent(): required param '"+r+"' has to be one of \""+a.join('", "')+'"'),!1}return!0}()?(famobi.hasOwnProperty("adapters")&&famobi.adapters.run("analytics","trackEvent",e,t),n.TRIGGER_AD.indexOf(e)>-1?!("reason"in t)||"quit"!==t.reason&&"draw"!==t.reason?famobi.showAd(function(){o(e,t)}):o(e,t):n.TRIGGER_CUSTOM.indexOf(e)>-1?window.famobi.hasFeature("forced_mode")&&["A-MONKEYGAMES-DEV"].includes(window.famobi.config.aid)&&["archery-world-tour","candy-bubble"].includes(window.famobi_gameID)&&"eventName"in t&&"LEVELEND"==t.eventName?i(e,t):o(e,t):n.TRIGGER_LEVELSCORE.indexOf(e)>-1?famobi.submitHighscore(t.levelName,t.levelScore).then(function(){o(e,t)}):n.TRIGGER_TOTALSCORE.indexOf(e)>-1?famobi.submitHighscore("TOTAL",t.totalScore).then(function(){o(e,t)}):n.TRIGGER_LIVESCORE.indexOf(e)>-1?(famobi.setLiveScore(t.liveScore),o(e,t)):o(e,t)):i("trackEvent(): invalid params "+JSON.stringify(t))})},getEvents:function(){return new Promise(function(e){e(n.events)})},EVENT_CUSTOM:"EVENT_CUSTOM",EVENT_LEVELFAIL:"EVENT_LEVELFAIL",EVENT_LEVELRESTART:"EVENT_LEVELRESTART",EVENT_LEVELSTART:"EVENT_LEVELSTART",EVENT_LEVELSUCCESS:"EVENT_LEVELSUCCESS",EVENT_LIVESCORE:"EVENT_LIVESCORE",EVENT_LEVELSCORE:"EVENT_LEVELSCORE",EVENT_TOTALSCORE:"EVENT_TOTALSCORE",EVENT_TUTORIALCOMPLETED:"EVENT_TUTORIALCOMPLETED",EVENT_TUTORIALSKIPPED:"EVENT_TUTORIALSKIPPED",EVENT_VOLUMECHANGE:"EVENT_VOLUMECHANGE",EVENT_PAUSE:"EVENT_PAUSE",EVENT_RESUME:"EVENT_RESUME",trackScreen:function(e,t){return new Promise(function(o,i){return void 0===n[e]?(i("trackScreen(): unknown screen '"+e+"'"),!1):!t&&e.indexOf(["SCREEN_OTHER"])>-1?(i("trackScreen(): screen '"+e+"' requires param 'pageTitle'"),!1):t&&"string"!=typeof t?(i("trackScreen(): required param 'pageTitle' has to be a non-empty string"),!1):(n.currentScreen=e,n.pageTitle=t,famobi.hasOwnProperty("adapters")&&famobi.adapters.run("analytics","trackScreen",e,t),void o(e,t))})},getScreen:function(){return n.currentScreen},getPageTitle:function(){return n.pageTitle},SCREEN_OTHER:"SCREEN_OTHER",SCREEN_BONUS:"SCREEN_BONUS",SCREEN_CHARACTER:"SCREEN_CHARACTER",SCREEN_CREDITS:"SCREEN_CREDITS",SCREEN_GAMERESULT:"SCREEN_GAMERESULT",SCREEN_HELP:"SCREEN_HELP",SCREEN_HOME:"SCREEN_HOME",SCREEN_LEVEL:"SCREEN_LEVEL",SCREEN_LEVELINTRO:"SCREEN_LEVELINTRO",SCREEN_LEVELLOADING:"SCREEN_LEVELLOADING",SCREEN_LEVELRESULT:"SCREEN_LEVELRESULT",SCREEN_LEVELSELECT:"SCREEN_LEVELSELECT",SCREEN_PAUSE:"SCREEN_PAUSE",SCREEN_SETTINGS:"SCREEN_SETTINGS",SCREEN_SHOP:"SCREEN_SHOP",SCREEN_SPLASH:"SCREEN_SPLASH",SCREEN_TUTORIAL:"SCREEN_TUTORIAL",TRIGGER_AD:["EVENT_LEVELSUCCESS","EVENT_LEVELFAIL"],TRIGGER_LEVELSCORE:["EVENT_LEVELSCORE"],TRIGGER_LIVESCORE:["EVENT_LIVESCORE"],TRIGGER_TOTALSCORE:["EVENT_TOTALSCORE"],TRIGGER_CUSTOM:["EVENT_CUSTOM"]};t.famobi_analytics=n}(0,window),fg_api.prototype.gameStarted=function(){this.log("Received gameStarted signal")},fg_api.prototype.gamePaused=function(){this.log("Received gamePaused signal")},fg_api.prototype.gameResumed=function(){this.log("Received gameResumed signal")},fg_api.prototype.gameOver=function(){var e=this;e.ads.showAd(function(){e.adapters.run("game","gameOver")}),e.log("Received gameOver signal")},fg_api.prototype.levelUp=function(){var e=this;e.ads.showAd(function(){e.adapters.run("game","levelUp")}),e.log("Received levelUp signal")},fg_api.prototype.gameReady=function(){this.adapters.run("game","ready"),this.log("Received gameReady signal")},fg_api.prototype.playerReady=function(){this.adapters.run("player","ready"),this.log("Received playerReady signal")},fg_api.prototype.geoModule=function(){var e,t=this;function n(){this.promise=null,this.geolocationUrl="js/null.js?https://pro.ip-api.com/json/?key=0meDkSsHhF3MQK0&fields=2",this.geodata={countryCode:""},this.ISOCountryGroups={eea:["at","be","bg","cy","cz","de","dk","ee","es","fi","fr","gb","gr","hr","hu","ie","is","it","li","lt","lu","lv","mt","nl","no","pl","pt","ro","se","si","sk"]}}return n.prototype.init=function(){e.promise=new Promise(function(n,o){t.hasFeature("standalone")?o():(setTimeout(o,1e4),t.rest.get(e.geolocationUrl).then(function(t){t&&t.countryCode?(faZepto.extend(e.geodata,t),n(e.geodata)):o()},o))})},n.prototype.getCountryCode=function(){return new Promise(function(t,n){e.promise.then(function(e){t(e.countryCode)},n)})},n.prototype.isEEA=function(){return new Promise(function(t,n){e.promise.then(function(n){t(e.ISOCountryGroups.eea.indexOf(n.countryCode.toLowerCase())>-1)},n)})},(e=new n).init(),e},fg_api.prototype.lsgModule=function(){var e,t=this;function n(){}return n.prototype.init=function(){this.lsg_version="lsg_v17",this.is_active="vp"!==window.famobi_env,this.is_sampling_all_rules=!0,this.rules=[],this.rule=null,this.locale=null,this.promise=null,this.all_rules={a0000:0,a0010:.1,a0020:.2,a0040:.4,a0080:.8,a0100:1,a0120:1.2,a0140:1.4,a0160:1.6,a0180:1.8,b0200:2,b0250:2.5,b0300:3,b0350:3.5,b0400:4,b0450:4.5,b0500:5,b0550:5.5,b0600:6,b0700:7,b0800:8,b0900:9,b1000:10,b1200:12},this.cpr_locales=["at","jp","nl","br","gb","tr"]},n.prototype.ready=function(){return e.promise||(e.promise=new Promise(function(n,o){Promise.resolve(e.getLocale()).then(function(t){return e.cpr_locales.indexOf(t.toLowerCase())>-1?(e.isActive(!1),Promise.reject("Locale "+t+" has custom price rules.")):Promise.resolve()}).then(function(){return e.pickRandomRule().then(n,o)}).catch(function(e){t.log("LSG deactivated",e?"reason:"+e:""),o(e)})})),e.promise},n.prototype.isActive=function(t){return void 0!==t?(e.is_active=t,t):new Promise(function(t,n){e.is_active?t():n()})},n.prototype.isSamplingAllRules=function(t){return void 0!==t&&(e.is_sampling_all_rules=!!t),!!e.is_sampling_all_rules},n.prototype.getRules=function(){return new Promise(function(n,o){return t.sizeOf(e.rules)?n(e.rules):e.isActive()?(e.rules=[],faZepto.each(e.all_rules,function(t,n){e.rules.push([t,n])}),void n(e.rules)):o()})},n.prototype.pickRandomRule=function(){return new Promise(function(n,o){e.getRules().then(function(){if(!t.sizeOf(e.rules))return e.rule="",void n(e.rule);var i=e.rules[t.rand(0,t.sizeOf(e.rules)-1)];i?(e.rule={name:i[0],value:i[1],ctr:i[2]},n(e.rule)):o()},o)})},n.prototype.remix=function(){return e.pickRandomRule()},n.prototype.getRule=function(){return e.rule?e.rule:""},n.prototype.exportRules=function(){return e.rules?Array.from(e.rules):[]},n.prototype.getLocale=function(){return null!==e.locale?e.locale:new Promise(function(n){t.geo.getCountryCode().then(function(t){e.locale=t.toUpperCase(),n(e.locale)},function(){e.locale=t.gametranslation.getNavigatorLanguage(),e.locale=e.locale.toUpperCase(),n(e.locale)})})},(e=new n).init(),e},fg_api.prototype.gametranslationModule=function(){var e,t=this;function n(){}return n.prototype.init=function(){e.curLangString=e.getUserLang(),-1===e.getSupportedLanguages().indexOf(e.curLangString)&&(e.curLangString="en"),e.translationData=e.getGameTranslations(),e.translateHtml(faZepto("body"))},n.prototype.getSupportedLanguages=function(){return t.config.languages||[]},n.prototype.getGameTranslations=function(){var n=t.config.game_i18n,o=e.curLangString;return n.current?n.current:(faZepto.each(n,function(e,t){faZepto.each(t,function(t,o){null==o?n[e][t]="":"string"==typeof n[e][t]&&(n[e][t]=o.replace(/\{lang\}/g,e))})}),n.current=faZepto.extend({},n.default,n[t.config.aid+".default"],n[o],n[t.config.aid+"."+o]),t.config.game_i18n.current=n.current)},n.prototype.translateString=function(t){return e.translationData.hasOwnProperty(t)?e.translationData[t]:null},n.prototype.getNavigatorLocale=function(){var e="";return navigator.languages&&t.sizeOf(navigator.languages)?e=navigator.languages[0]:navigator.language?e=navigator.language:navigator.userLanguage?e=navigator.userLanguage:navigator.browserLanguage&&(e=navigator.browserLanguage),e},n.prototype.getNavigatorLanguage=function(){return e.getNavigatorLocale().substr(0,2)},n.prototype.getUserLang=function(){var n=t.getUrlParams(),o=e.getNavigatorLanguage();if(n.locale&&2==n.locale.length)return n.locale;switch(o){case"ch":case"at":return"de";default:return o}},n.prototype.translateHtml=function(t){return t.find("[data-i18n]").each(function(){var t=this.getAttribute("data-i18n");this.innerHTML=e.translateString(t)}),t},(e=new n).init(),e},fg_api.prototype.__=function(e){return this.gametranslation.translateString(e)},fg_api.prototype.translate=function(e){return this.__(e)},fg_api.prototype.translateHtml=function(){return this.gametranslation.translateHtml.apply(this,arguments)},fg_api.prototype.getCurrentLanguage=function(){return this.gametranslation.curLangString},fg_api.prototype.gameModule=function(){var e,t=this;function n(){this.waitingCounter=0,this.preloadProgress=0}var o=n.prototype;return o.prepare=function(){return e.linkCanonical().changeOpacity().changeMetaViewport(),faZepto(t.rootElement).on("faGame:loaded",e.changeMetaViewport),faZepto(t.rootElement).on("faGame:loaded",e.hideCanvasBodyOverflow),new Promise(function(n){!function o(){if(window.famobi_pregameJS&&window.famobi_pregameJS.length){var i=window.famobi_pregameJS.shift();if(i instanceof Promise)i.then(o,o);else if("function"==typeof i)Promise.resolve(i.call(t)).then(o,o);else{var r=document.createElement("script");r.onload=o,r.onerror=o,r.src=i,t.bodyElement.appendChild(r)}}else n(e)}()})},o.setWaiting=function(t){return t?e.waitingCounter++:e.waitingCounter>0?e.waitingCounter--:e.waitingCounter=0,e},o.isWaiting=function(){return e.waitingCounter>0},o.canResume=function(){return 1===e.waitingCounter},o.init=function(){t.spinner.show(),function n(){if(!e.isWaiting()){if(!window.famobi_gameJS.length)return faZepto(t.rootElement).trigger("faGame:loaded"),t.spinner.hide(),void t.adapters.run("game","loaded");var o=window.famobi_gameJS.shift();if("function"==typeof o)o.call(t),n();else{var i=document.createElement("script");i.onload=n,i.onerror=n,i.src=o,t.bodyElement.appendChild(i)}}}()},o.pause=function(){if(e.isWaiting())return e.setWaiting(!0),!1;e.setWaiting(!0);try{if("function"==typeof window.famobi_onPauseRequested)return window.famobi_onPauseRequested(),!0;if(window.game&&void 0!==window.game.paused)return window.game.paused=!0,!0;if(void 0!==window.cr_setSuspended)return cr_setSuspended(!0),!0;window.createjs}catch(e){t.log("Pausing game failed: "+e)}return!1},o.resume=function(){if(!e.isWaiting())return!1;if(!e.canResume())return e.setWaiting(!1),!1;e.setWaiting(!1);try{if("function"==typeof window.famobi_onResumeRequested)return window.famobi_onResumeRequested(),!0;if(window.game&&void 0!==window.game.paused)return window.game.paused=!1,!0;if(void 0!==window.cr_setSuspended)return cr_setSuspended(!1),!0;window.createjs}catch(e){t.log("Resuming game failed: "+e)}return!1},o.linkCanonical=function(){var n=t.getShortLink();return faZepto('<link rel="canonical" href="'+n+'">').appendTo(t.headElement),e},o.changeOpacity=function(){var n=t.bodyElement.style.opacity+"";return""!==n&&parseInt(n)<1&&(t.bodyElement.style.opacity="1.0"),e},o.changeMetaViewport=function(){var e=document.querySelector("meta[name=viewport]"),t=navigator.userAgent,n=e?e.getAttribute("data-original"):void 0;e&&n&&(t.match(/iPhone|iPod|Tizen/i)?n="width=device-width, user-scalable=0, minimum-scale=1.0, initial-scale=0.5, maximum-scale=0.5, minimal-ui":t.match(/iPad/i)?n="width=device-width, user-scalable=0, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0, minimal-ui":t.match(/Android/i)&&(n="width=device-width, initial-scale=1, maximum-scale=1.01"),e.setAttribute("content",n))},o.showCanvas=function(){var e=document.querySelectorAll("canvas"),t=0;if(e)for(;t<e.length;++t)e[t].style.display=e[t].getAttribute("fa-orig-display")||""},o.hideCanvas=function(){var e=document.querySelectorAll("canvas"),t=0;if(e)for(;t<e.length;++t)e[t].setAttribute("fa-orig-display",e[t].style.display),e[t].style.display="none"},o.hideCanvasBodyOverflow=function(){document.querySelector("canvas")&&(t.bodyElement.style.overflow="hidden")},o.setPreloadProgress=function(n){if("number"==typeof n){var o=Math.min(100,Math.max(e.preloadProgress,n));o>e.preloadProgress&&(e.preloadProgress=o,t.adapters.run("game","preloadProgress",o),100==o&&t.adapters.run("game","preloadComplete"))}else console.warn("setPreloadProgress(): required param 'percent' has to be of type number")},e=new n},fg_api.prototype.setPreloadProgress=function(){this.game.setPreloadProgress.apply(this,arguments)},fg_api.prototype.audioModule=function(e){var t,n=this;function o(){this.volume=1}return o.prototype.init=function(){},o.prototype.setVolume=function(e){if("number"!=typeof e)return n.log("setVolume(): required param 'volume' has to be of type number"),!1;(e<0||e>1)&&n.log("setVolume(): param 'volume' out of bounds (0.0, 1.0)");var o=Math.min(1,Math.max(0,e));o!==t.volume&&(t.volume=o,n.requestAction("changeVolume",o))},o.prototype.getVolume=function(){return t.volume},(t=new o).init(),t},fg_api.prototype.setVolume=function(e){this.audio?this.audio.setVolume(e):self.log("setVolume(): audio module required")},fg_api.prototype.getVolume=function(){return this.audio?this.audio.getVolume():(self.log("getVolume(): audio module required"),1)},fg_api.prototype.fullscreenModule=function(){var e,t=this;function n(){this.isSupported=!1}return n.prototype.init=function(){var e=document.documentElement;try{if(!e)throw"documentElement not supported";if(!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled))throw"Fullscreen mode not supported";if(e.requestFullscreen)this.requestFullscreen="requestFullscreen";else if(e.requestFullScreen)this.requestFullscreen="requestFullScreen";else if(e.webkitRequestFullScreen)this.requestFullscreen="webkitRequestFullscreen";else if(e.webkitRequestFullScreen)this.requestFullscreen="webkitRequestFullScreen";else if(e.mozRequestFullScreen)this.requestFullscreen="mozRequestFullScreen";else{if(!e.msRequestFullscreen)throw"Fullscreen API not supported";this.requestFullscreen="msRequestFullscreen"}this.isSupported=!!this.requestFullscreen}catch(e){this.isSupported=!1}t.config.aid.startsWith("A-MONKEY")||((detection.is.ios||detection.is.pc||!t.hasFeature("fullscreen")||/^MacIntel|Win32|Win64$/.test(navigator.platform))&&(this.isSupported=!1),this.isSupported||faZepto("[data-famobi-fullscreen]").remove())},n.prototype.isSupported=function(){return this.isSupported},n.prototype.start=function(){var e=document.documentElement;return!!t.fullscreen.isSupported&&(e[this.requestFullscreen](),!0)},n.prototype.stop=function(){return t.orientation.unlock(),document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),!0},n.prototype.toggle=function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement?e.stop():(e.start(),setTimeout(function(){t.orientation.lock()},1e3),!0)},(e=new n).init(),e},fg_api.prototype.flashModule=function(){var e,t=this;function n(){this.offsetWidth=0,this.offsetHeight=0,this.swfUrl=window.famobi_gameID+".swf",this.replaceElemId="myContent",this.width=parseInt(window.innerWidth)-this.offsetWidth,this.height=parseInt(window.innerHeight)-this.offsetHeight,this.swfVersion="9.0.0",this.xiSwfUrl="expressInstall.swf",this.flashvars={fg_aid:window.famobi.config.aid,fg_uid:window.famobi.config.uuid,fg_game:window.famobi_gameID},this.params={allowscriptaccess:"always"},this.attributes={},this.callbackFn=function(){}}return n.prototype.init=function(){var n=null,o=null,i=["flashvars","params","attributes"],r=null;if(!t.config.gameParams.flash)return!1;for(var a in e.replaceElemId=t.config.gameParams.flash.replaceElemId||e.replaceElemId,e.swfUrl=t.config.gameParams.flash.swfUrl||e.swfUrl,e.width=t.config.gameParams.flash.width||e.width,e.height=t.config.gameParams.flash.height||e.height,e.swfVersion=t.config.gameParams.flash.swfVersion||e.swfVersion,e.xiSwfUrl=t.config.gameParams.flash.xiSwfUrl||e.xiSwfUrl,(n=document.createElement("div")).setAttribute("id",e.replaceElemId),n.setAttribute("style","display: none"),t.bodyElement.appendChild(n),t.config.ads.off=!0,t.config.gameParams.flash.callbackFn?e.callbackFn=t.config.gameParams.flash.callbackFn:e.callbackFn=function(){0===swfobject.getFlashPlayerVersion().major&&(n.style.display="block",o=t.createElement("a",{href:"http://www.adobe.com/go/getflashplayer",target:"_blank"}),r=t.createElement("img",{src:"/flashgames/swfobject/getFlash.png",alt:"Get Adobe Flash player",title:"Get Adobe Flash player"}),o.appendChild(r),n.appendChild(o),t.modal.create({title:"Get Adobe Flash player"}),t.modal.setContent(n))},i){if(!t.config.gameParams.flash[i[a]])break;for(var s in t.config.gameParams.flash[i[a]])e[i[a]][s]=t.config.gameParams.flash[i[a]][s]}return window.famobi_gameJS=window.famobi_gameJS||[],window.famobi_gameJS.unshift("/flashgames/swfobject/swfobject.js",function(){swfobject.embedSWF(e.swfUrl,e.replaceElemId,e.width,e.height,e.swfVersion,e.xiSwfUrl,e.flashvars,e.params,e.attributes,e.callbackFn)}),t},(e=new n).init(),e},fg_api.prototype.restModule=function(){var e;function t(){}return t.prototype.init=function(){},t.prototype.get=function(e,t){return new Promise(function(n,o){faZepto.ajax({url:e,headers:t,success:function(e){n(e)},error:function(e){o(e)}})})},t.prototype.getJSON=function(e,t){return new Promise(function(n,o){faZepto.ajax({url:e,headers:t,contentType:"application/json; charset=UTF-8",success:function(e){n(e)},error:function(e){o(e)}})})},t.prototype.post=function(e,t,n){return n=n||{},new Promise(function(o,i){faZepto.ajax({url:e,type:"POST",contentType:"application/json; charset=UTF-8",headers:n,data:JSON.stringify(t),success:function(e){o(e)},error:function(e){i(e)}})})},(e=new t).init(),e},fg_api.prototype.debugModule=function(){var e,t=this;function n(){}return n.prototype.init=function(){t.adapters.add("analytics","trackStats",function(e,n){t.log("%c trackStats ","background: #333333; color: white; display: block;"),"string"==typeof e?"object"==typeof n?(t.log(e+":"),t.log(n)):t.log(e+": "+n):t.log(e)}),t.adapters.add("analytics","trackEvent",function(e,n){t.log("%c "+e+" %c (trackEvent)","background: #0092c3; color: white; display: block;",""),t.log(n)}),t.adapters.add("analytics","trackScreen",function(e,n){t.log("%c "+e+" %c (trackScreen)"+(n?" - pageTitle: "+n:""),"background: #f08119; color: white; display: block;","")})},(e=new n).init(),e},fg_api.prototype.videoModule=function(){var e,t=this;function n(){this.element=null,this.elementId="fa-video",this.videoUrl=t.config.urlRoot+"/services/video"}return n.prototype.init=function(){e.element=document.getElementById(e.elementId),e.player=videojs(e.elementId),t.onorientationchange(e.resizeHandler),e.resizeHandler(),e.player.src([{type:"video/mp4",src:"https://video.cdn.famobi.com/marketing/videos/"+t.config.video.sources.mp4}]),e.player.dock({title:""}),e.player.brand({image:"FamobiFLogo.svg",title:"Proudly brought to you by Famobi.com",destination:"https://famobi.com",destinationTarget:"_blank"}),e.player.watermark({image:"FamobiFWhiteLogo.svg",position:"top-right",fadeTime:1e3,url:"https://famobi.com"});var n=document.getElementById("fa-video");(navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i))&&n.hasAttribute("controls")&&n.removeAttribute("controls");var o="click";return(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i))&&(o="touchend"),e.player.one(o,function(){e.player.ima.initializeAdDisplayContainer(),e.player.ima.requestAds(),e.player.play(),e.trackEvent("play")}),e.trackEvent("show"),t},n.prototype.resizeHandler=function(){var n=t.getWindowSize();e.player.width(n.h/(16/9))},n.prototype.trackEvent=function(n){var o=["play","show"];if(-1===o.indexOf(n))return t.log("trackEvent(): eventName must be one of ",o.join(", ")),!1;n="video."+(n||"show");var i={aid:t.config.aid,event:n};return faZepto.post(e.videoUrl+"/videos/"+t.config.video.id+"/track",i)},(e=new n).init(),e},fg_api.prototype.videoadsModule=function(){var e,t=this;function n(){this.closeCallback=function(){},this.adDidLoad=!1,this.lastAdCall=+t.now()}return n.prototype.init=function(){function n(){if("undefined"!=typeof google&&google.ima){google.ima.settings.setLocale(t.gametranslation.getNavigatorLanguage()),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED);var n={id:"fa-video",showCountdown:!1,adTagUrl:e.getAdTagUrl()};t.video.player.ima(n)}}t.config.ads=faZepto.extend({},t.config.ads),e.isEnabled()?e.provider=t.config.ads.provider:e.provider="none",e.adcount=0,e.floodProtectionMap={},e.provider,faZepto.getScript("js/null.js?https://imasdk.googleapis.com/js/sdkloader/ima3.js",n,function(){n()}),e.dfp_ad_unit_code="/37336410/InVideo//"+t.config.aid},n.prototype.getAdTagUrl=function(){var n="",o=encodeURIComponent(t.config.ads.description_url),i=t.gametranslation.getNavigatorLanguage();return e.dfp_custom_params={a:""+t.config.aid,gametype:"video",video:"1",invideo:"1",videoid:t.config.video.id},n="https://securepubads.g.doubleclick.net/gampad/ads?npa=1&impl=s&gdfp_req=1&env=vp&output=vast&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]&ciu_szs=",""!=e.dfp_ad_unit_code&&(n=n+"&iu="+e.dfp_ad_unit_code),e.adWidth>=728?n+="&sz=728x480":e.adWidth>=640||e.dfp_custom_params.video&&"1"===e.dfp_custom_params.video?n+="&sz=640x480":e.adWidth>=336?n+="&sz=336x280":n+="&sz=300x250",""!=o&&(n=n+"&description_url="+o),e.dfp_custom_params&&(n=n+"&cust_params="+encodeURIComponent(faZepto.param(e.dfp_custom_params))),""!=i&&(n=n+"&hl="+i),n},n.prototype.hasCooledDown=function(){var n=0===e.adcount&&+t.config.ads.min_s_before>0?+t.config.ads.min_s_before:+t.config.ads.min_s_between;return t.now()-1e3*n>e.lastAdCall},n.prototype.isAdvertisingActive=function(e){return!(!e.iframeAllowed&&window.top!==window.self)||(t.log("ads disabled in <iframe>"),!1)},n.prototype.isNthAdvertising=function(t){return+e.adcount%t===0},n.prototype.lastAdCallWasNsecondsAgo=function(n){return t.now()-1e3*n>=e.lastAdCall},n.prototype.fireAdCallback=function(){"function"==typeof e.closeCallback&&e.closeCallback(),e.closeCallback=function(){}},n.prototype.isEnabled=function(){return t.hasFeature("videoads")&&!t.config.ads.off},n.prototype.floodProtect=function(t,n){return!!e.floodProtectionMap[t]||(e.floodProtectionMap[t]=setTimeout(function(){e.floodProtectionMap[t]=void 0},n),!1)},(e=new n).init(),e},fg_api.prototype.init=function(){var e=this;e.rootElement=document.getElementById("fg-root"),e.bodyElement=document.getElementsByTagName("body")[0],e.headElement=document.getElementsByTagName("head")[0],e.rootElement||(e.rootElement=e.createElement("div",{id:"fg-root",class:"fg-root",hidden:"hidden",style:"color: #999;font-weight:normal;"}),document.body.insertBefore(e.rootElement,document.body.firstChild)),e.fgOverlay=e.createElement("div",{id:"fg-overlay"}),e.config.gameParams.overlay_position&&(e.fgOverlay.className="overlay-"+e.config.gameParams.overlay_position+" clip-"+e.config.gameParams.overlay_position),e.config.gameParams.overlay_distance&&""!==e.config.gameParams.overlay_distance&&(e.config.gameParams.overlay_position&&"bottom"==e.config.gameParams.overlay_position?e.fgOverlay.style.bottom=isNaN(e.config.gameParams.overlay_distance)?e.config.gameParams.overlay_distance:e.config.gameParams.overlay_distance+"px":e.fgOverlay.style.top=isNaN(e.config.gameParams.overlay_distance)?e.config.gameParams.overlay_distance:e.config.gameParams.overlay_distance+"px"),e.rootElement.appendChild(e.fgOverlay),e.config.name=faZepto.parseJSON(e.config.name),e.config.package_id=faZepto.parseJSON(e.config.package_id),e.config.referrer_origin="",e.config.referrer_matched=!1;var t,n,o=e.getUrlParams(),i=o.original_ref?o.original_ref:"",r=e.config.ads.domains;try{t=new URL(i),e.config.referrer_origin=t.origin}catch(t){e.log("cannot parse referrer URL",i)}if(t&&t.hostname&&Array.isArray(r)&&r.length>0)for(var a of r)if(!(a.length<1)){var s=a.toLowerCase();s.startsWith("http://")||s.startsWith("https://")||(s="https://"+s);try{n=new URL(s)}catch(e){console.log("cannot parse portal URL",s);continue}if(t.hostname&&t.hostname.indexOf(n.hostname)>=0||n.hostname&&n.hostname.indexOf(t.hostname)>=0){e.log(n.hostname,"matches",t.hostname),e.config.referrer_matched=!0;break}}function l(t){return e[t+"Module"]&&e[t+"Module"].call(e,Array.prototype.slice.call(arguments,1))}switch(e.log("affiliate domain matching:",e.config.referrer_matched?"found at least one domain":"no domain found"),e.config.blurred_thumb=e.config.blurred_thumb||"https://img.cdn.famobi.com/portal/html5games/images/tmp/blurred/RacingMonsterTrucksTeaser.jpg",e.adapters=l("adapters"),e.requests=l("requests"),e.consent=l("consent"),e.game=l("game"),e.localStorage=l("storage","localStorage"),e.sessionStorage=l("storage","sessionStorage"),e.gametranslation=l("gametranslation"),e.rest=l("rest"),e.geo=l("geo"),e.lsg=l("lsg"),e.config.aid){case"A-MONKEYGAMES":case"A-MONKEYGAMES-DEV":e.socket=l("socket");break;default:("staging"==e.getUrlParams().fg_env||e.config.gameParams.socket_enabled)&&(e.socket=l("socket"))}function c(){switch(e.rootElement.removeAttribute("hidden"),e.navigation=l("navigation"),e.spinner=l("spinner").show(),e.tracking=l("tracking"),e.iframe=l("iframe"),e.modal=l("modal"),e.notify=l("notify"),e.highscores=l("highscores"),e.screenshot=l("screenshot"),e.config.aid){case"A-HUAWEI-QUICKAPPS":case"A-HUAWEI-BROWSER":case"A-HUAWEI-QUICKAPP-OMNOM":case"A-HUAWEI-BROWSER-OMNOM":case"A-CK67R":case"A-GAME8-AFG":e.ads=l("huaweiAds");break;default:e.ads=l("ads")}e.rewardedads=l("rewardedads"),e.audio=l("audio"),e.fullscreen=l("fullscreen"),e.orientation=l("orientation"),e.flash=l("flash"),e.debugger=l("debug"),"vp"===window.famobi_env&&(e.video=l("video"),e.videoads=l("videoads")),e.game.init(),detection.is.pc&&window.console&&(console.log("%c ||| Brought to you |||","background-color: #0092c3; background-image: -webkit-linear-gradient(top, #0092c3, #eee); background-image: linear-gradient(to bottom, #0092c3, #eee); padding: 5px 10px; color: #333"),console.log("%c |||   by Famobi    |||","background-color: #f08119; background-image: -webkit-linear-gradient(top, #f08119, #eee); background-image: linear-gradient(to bottom, #f08119, #eee); padding: 5px 10px; color: #111"),console.log("%c ||| HTML5Games.com |||","background-color: #333; background-image: -webkit-linear-gradient(top, #333, #eee); background-image: linear-gradient(to bottom, #333, #eee); padding: 5px 10px; color: #fff"))}return faZepto('link[rel="icon"]').length||(e.headElement.appendChild(faZepto('<link rel="icon" type="image/png" sizes="32x32" href="'+e.config.thumb+'">').get(0)),e.headElement.appendChild(faZepto('<link rel="icon" type="image/png" sizes="64x64" href="'+e.config.thumb+'">').get(0)),e.headElement.appendChild(faZepto('<link rel="icon" type="image/png" sizes="96x96" href="'+e.config.thumb+'">').get(0)),e.headElement.appendChild(faZepto('<link rel="icon" type="image/png" sizes="192x192" href="'+e.config.thumb+'">').get(0))),Promise.all([e.game.prepare(),new Promise(function(t){e.wait(1e3).then(t);var n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",e.config.assetsPath+"/css/play.css"),n.onload=t,n.onerror=t,e.headElement.appendChild(n)}),new Promise(function(t){var n=e.getMoreGamesButtonImage(),o=new Image;o.onload=t,o.onerror=function(){e.config.game_i18n.current&&(e.config.game_i18n.current.more_games_image="More_Games600x253_transparent.png"),t()},o.src=n})]).then(c).catch(c),e};